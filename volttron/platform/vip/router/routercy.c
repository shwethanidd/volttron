/* Generated by Cython 0.24 */

#define PY_SSIZE_T_CLEAN
#include "Python.h"
#ifndef Py_PYTHON_H
    #error Python headers needed to compile C extensions, please install development version of Python.
#elif PY_VERSION_HEX < 0x02060000 || (0x03000000 <= PY_VERSION_HEX && PY_VERSION_HEX < 0x03020000)
    #error Cython requires Python 2.6+ or Python 3.2+.
#else
#define CYTHON_ABI "0_24"
#include <stddef.h>
#ifndef offsetof
  #define offsetof(type, member) ( (size_t) & ((type*)0) -> member )
#endif
#if !defined(WIN32) && !defined(MS_WINDOWS)
  #ifndef __stdcall
    #define __stdcall
  #endif
  #ifndef __cdecl
    #define __cdecl
  #endif
  #ifndef __fastcall
    #define __fastcall
  #endif
#endif
#ifndef DL_IMPORT
  #define DL_IMPORT(t) t
#endif
#ifndef DL_EXPORT
  #define DL_EXPORT(t) t
#endif
#ifndef PY_LONG_LONG
  #define PY_LONG_LONG LONG_LONG
#endif
#ifndef Py_HUGE_VAL
  #define Py_HUGE_VAL HUGE_VAL
#endif
#ifdef PYPY_VERSION
  #define CYTHON_COMPILING_IN_PYPY 1
  #define CYTHON_COMPILING_IN_CPYTHON 0
#else
  #define CYTHON_COMPILING_IN_PYPY 0
  #define CYTHON_COMPILING_IN_CPYTHON 1
#endif
#if !defined(CYTHON_USE_PYLONG_INTERNALS) && CYTHON_COMPILING_IN_CPYTHON && PY_VERSION_HEX >= 0x02070000
  #define CYTHON_USE_PYLONG_INTERNALS 1
#endif
#if CYTHON_USE_PYLONG_INTERNALS
  #include "longintrepr.h"
  #undef SHIFT
  #undef BASE
  #undef MASK
#endif
#if CYTHON_COMPILING_IN_PYPY && PY_VERSION_HEX < 0x02070600 && !defined(Py_OptimizeFlag)
  #define Py_OptimizeFlag 0
#endif
#define __PYX_BUILD_PY_SSIZE_T "n"
#define CYTHON_FORMAT_SSIZE_T "z"
#if PY_MAJOR_VERSION < 3
  #define __Pyx_BUILTIN_MODULE_NAME "__builtin__"
  #define __Pyx_PyCode_New(a, k, l, s, f, code, c, n, v, fv, cell, fn, name, fline, lnos)\
          PyCode_New(a+k, l, s, f, code, c, n, v, fv, cell, fn, name, fline, lnos)
  #define __Pyx_DefaultClassType PyClass_Type
#else
  #define __Pyx_BUILTIN_MODULE_NAME "builtins"
  #define __Pyx_PyCode_New(a, k, l, s, f, code, c, n, v, fv, cell, fn, name, fline, lnos)\
          PyCode_New(a, k, l, s, f, code, c, n, v, fv, cell, fn, name, fline, lnos)
  #define __Pyx_DefaultClassType PyType_Type
#endif
#ifndef Py_TPFLAGS_CHECKTYPES
  #define Py_TPFLAGS_CHECKTYPES 0
#endif
#ifndef Py_TPFLAGS_HAVE_INDEX
  #define Py_TPFLAGS_HAVE_INDEX 0
#endif
#ifndef Py_TPFLAGS_HAVE_NEWBUFFER
  #define Py_TPFLAGS_HAVE_NEWBUFFER 0
#endif
#ifndef Py_TPFLAGS_HAVE_FINALIZE
  #define Py_TPFLAGS_HAVE_FINALIZE 0
#endif
#if PY_VERSION_HEX > 0x03030000 && defined(PyUnicode_KIND)
  #define CYTHON_PEP393_ENABLED 1
  #define __Pyx_PyUnicode_READY(op)       (likely(PyUnicode_IS_READY(op)) ?\
                                              0 : _PyUnicode_Ready((PyObject *)(op)))
  #define __Pyx_PyUnicode_GET_LENGTH(u)   PyUnicode_GET_LENGTH(u)
  #define __Pyx_PyUnicode_READ_CHAR(u, i) PyUnicode_READ_CHAR(u, i)
  #define __Pyx_PyUnicode_KIND(u)         PyUnicode_KIND(u)
  #define __Pyx_PyUnicode_DATA(u)         PyUnicode_DATA(u)
  #define __Pyx_PyUnicode_READ(k, d, i)   PyUnicode_READ(k, d, i)
  #define __Pyx_PyUnicode_IS_TRUE(u)      (0 != (likely(PyUnicode_IS_READY(u)) ? PyUnicode_GET_LENGTH(u) : PyUnicode_GET_SIZE(u)))
#else
  #define CYTHON_PEP393_ENABLED 0
  #define __Pyx_PyUnicode_READY(op)       (0)
  #define __Pyx_PyUnicode_GET_LENGTH(u)   PyUnicode_GET_SIZE(u)
  #define __Pyx_PyUnicode_READ_CHAR(u, i) ((Py_UCS4)(PyUnicode_AS_UNICODE(u)[i]))
  #define __Pyx_PyUnicode_KIND(u)         (sizeof(Py_UNICODE))
  #define __Pyx_PyUnicode_DATA(u)         ((void*)PyUnicode_AS_UNICODE(u))
  #define __Pyx_PyUnicode_READ(k, d, i)   ((void)(k), (Py_UCS4)(((Py_UNICODE*)d)[i]))
  #define __Pyx_PyUnicode_IS_TRUE(u)      (0 != PyUnicode_GET_SIZE(u))
#endif
#if CYTHON_COMPILING_IN_PYPY
  #define __Pyx_PyUnicode_Concat(a, b)      PyNumber_Add(a, b)
  #define __Pyx_PyUnicode_ConcatSafe(a, b)  PyNumber_Add(a, b)
#else
  #define __Pyx_PyUnicode_Concat(a, b)      PyUnicode_Concat(a, b)
  #define __Pyx_PyUnicode_ConcatSafe(a, b)  ((unlikely((a) == Py_None) || unlikely((b) == Py_None)) ?\
      PyNumber_Add(a, b) : __Pyx_PyUnicode_Concat(a, b))
#endif
#if CYTHON_COMPILING_IN_PYPY && !defined(PyUnicode_Contains)
  #define PyUnicode_Contains(u, s)  PySequence_Contains(u, s)
#endif
#if CYTHON_COMPILING_IN_PYPY && !defined(PyObject_Format)
  #define PyObject_Format(obj, fmt)  PyObject_CallMethod(obj, "__format__", "O", fmt)
#endif
#if CYTHON_COMPILING_IN_PYPY && !defined(PyObject_Malloc)
  #define PyObject_Malloc(s)   PyMem_Malloc(s)
  #define PyObject_Free(p)     PyMem_Free(p)
  #define PyObject_Realloc(p)  PyMem_Realloc(p)
#endif
#define __Pyx_PyString_FormatSafe(a, b)   ((unlikely((a) == Py_None)) ? PyNumber_Remainder(a, b) : __Pyx_PyString_Format(a, b))
#define __Pyx_PyUnicode_FormatSafe(a, b)  ((unlikely((a) == Py_None)) ? PyNumber_Remainder(a, b) : PyUnicode_Format(a, b))
#if PY_MAJOR_VERSION >= 3
  #define __Pyx_PyString_Format(a, b)  PyUnicode_Format(a, b)
#else
  #define __Pyx_PyString_Format(a, b)  PyString_Format(a, b)
#endif
#if PY_MAJOR_VERSION < 3 && !defined(PyObject_ASCII)
  #define PyObject_ASCII(o)            PyObject_Repr(o)
#endif
#if PY_MAJOR_VERSION >= 3
  #define PyBaseString_Type            PyUnicode_Type
  #define PyStringObject               PyUnicodeObject
  #define PyString_Type                PyUnicode_Type
  #define PyString_Check               PyUnicode_Check
  #define PyString_CheckExact          PyUnicode_CheckExact
#endif
#if PY_MAJOR_VERSION >= 3
  #define __Pyx_PyBaseString_Check(obj) PyUnicode_Check(obj)
  #define __Pyx_PyBaseString_CheckExact(obj) PyUnicode_CheckExact(obj)
#else
  #define __Pyx_PyBaseString_Check(obj) (PyString_Check(obj) || PyUnicode_Check(obj))
  #define __Pyx_PyBaseString_CheckExact(obj) (PyString_CheckExact(obj) || PyUnicode_CheckExact(obj))
#endif
#ifndef PySet_CheckExact
  #define PySet_CheckExact(obj)        (Py_TYPE(obj) == &PySet_Type)
#endif
#define __Pyx_TypeCheck(obj, type) PyObject_TypeCheck(obj, (PyTypeObject *)type)
#if PY_MAJOR_VERSION >= 3
  #define PyIntObject                  PyLongObject
  #define PyInt_Type                   PyLong_Type
  #define PyInt_Check(op)              PyLong_Check(op)
  #define PyInt_CheckExact(op)         PyLong_CheckExact(op)
  #define PyInt_FromString             PyLong_FromString
  #define PyInt_FromUnicode            PyLong_FromUnicode
  #define PyInt_FromLong               PyLong_FromLong
  #define PyInt_FromSize_t             PyLong_FromSize_t
  #define PyInt_FromSsize_t            PyLong_FromSsize_t
  #define PyInt_AsLong                 PyLong_AsLong
  #define PyInt_AS_LONG                PyLong_AS_LONG
  #define PyInt_AsSsize_t              PyLong_AsSsize_t
  #define PyInt_AsUnsignedLongMask     PyLong_AsUnsignedLongMask
  #define PyInt_AsUnsignedLongLongMask PyLong_AsUnsignedLongLongMask
  #define PyNumber_Int                 PyNumber_Long
#endif
#if PY_MAJOR_VERSION >= 3
  #define PyBoolObject                 PyLongObject
#endif
#if PY_MAJOR_VERSION >= 3 && CYTHON_COMPILING_IN_PYPY
  #ifndef PyUnicode_InternFromString
    #define PyUnicode_InternFromString(s) PyUnicode_FromString(s)
  #endif
#endif
#if PY_VERSION_HEX < 0x030200A4
  typedef long Py_hash_t;
  #define __Pyx_PyInt_FromHash_t PyInt_FromLong
  #define __Pyx_PyInt_AsHash_t   PyInt_AsLong
#else
  #define __Pyx_PyInt_FromHash_t PyInt_FromSsize_t
  #define __Pyx_PyInt_AsHash_t   PyInt_AsSsize_t
#endif
#if PY_MAJOR_VERSION >= 3
  #define __Pyx_PyMethod_New(func, self, klass) ((self) ? PyMethod_New(func, self) : PyInstanceMethod_New(func))
#else
  #define __Pyx_PyMethod_New(func, self, klass) PyMethod_New(func, self, klass)
#endif
#if PY_VERSION_HEX >= 0x030500B1
#define __Pyx_PyAsyncMethodsStruct PyAsyncMethods
#define __Pyx_PyType_AsAsync(obj) (Py_TYPE(obj)->tp_as_async)
#elif CYTHON_COMPILING_IN_CPYTHON && PY_MAJOR_VERSION >= 3
typedef struct {
    unaryfunc am_await;
    unaryfunc am_aiter;
    unaryfunc am_anext;
} __Pyx_PyAsyncMethodsStruct;
#define __Pyx_PyType_AsAsync(obj) ((__Pyx_PyAsyncMethodsStruct*) (Py_TYPE(obj)->tp_reserved))
#else
#define __Pyx_PyType_AsAsync(obj) NULL
#endif
#ifndef CYTHON_RESTRICT
  #if defined(__GNUC__)
    #define CYTHON_RESTRICT __restrict__
  #elif defined(_MSC_VER) && _MSC_VER >= 1400
    #define CYTHON_RESTRICT __restrict
  #elif defined (__STDC_VERSION__) && __STDC_VERSION__ >= 199901L
    #define CYTHON_RESTRICT restrict
  #else
    #define CYTHON_RESTRICT
  #endif
#endif
#define __Pyx_void_to_None(void_result) ((void)(void_result), Py_INCREF(Py_None), Py_None)

#ifndef CYTHON_INLINE
  #if defined(__GNUC__)
    #define CYTHON_INLINE __inline__
  #elif defined(_MSC_VER)
    #define CYTHON_INLINE __inline
  #elif defined (__STDC_VERSION__) && __STDC_VERSION__ >= 199901L
    #define CYTHON_INLINE inline
  #else
    #define CYTHON_INLINE
  #endif
#endif

#if defined(WIN32) || defined(MS_WINDOWS)
  #define _USE_MATH_DEFINES
#endif
#include <math.h>
#ifdef NAN
#define __PYX_NAN() ((float) NAN)
#else
static CYTHON_INLINE float __PYX_NAN() {
  float value;
  memset(&value, 0xFF, sizeof(value));
  return value;
}
#endif


#define __PYX_ERR(f_index, lineno, Ln_error) \
{ \
  __pyx_filename = __pyx_f[f_index]; __pyx_lineno = lineno; __pyx_clineno = __LINE__; goto Ln_error; \
}

#if PY_MAJOR_VERSION >= 3
  #define __Pyx_PyNumber_Divide(x,y)         PyNumber_TrueDivide(x,y)
  #define __Pyx_PyNumber_InPlaceDivide(x,y)  PyNumber_InPlaceTrueDivide(x,y)
#else
  #define __Pyx_PyNumber_Divide(x,y)         PyNumber_Divide(x,y)
  #define __Pyx_PyNumber_InPlaceDivide(x,y)  PyNumber_InPlaceDivide(x,y)
#endif

#ifndef __PYX_EXTERN_C
  #ifdef __cplusplus
    #define __PYX_EXTERN_C extern "C"
  #else
    #define __PYX_EXTERN_C extern
  #endif
#endif

#define __PYX_HAVE__volttron__platform__vip__router__routercy
#define __PYX_HAVE_API__volttron__platform__vip__router__routercy
#include "string.h"
#include <string>
#include "ios"
#include "new"
#include "stdexcept"
#include "typeinfo"
#include <utility>
#include <set>
#include <vector>
#include "libcalg-1.0/libcalg/queue.h"
#include "pyversion_compat.h"
#include "stdio.h"
#include "pythread.h"
#include "zmq_compat.h"
#include "zmq.h"
#include "zmq_utils.h"
#ifdef _OPENMP
#include <omp.h>
#endif /* _OPENMP */

#ifdef PYREX_WITHOUT_ASSERTIONS
#define CYTHON_WITHOUT_ASSERTIONS
#endif

#ifndef CYTHON_UNUSED
# if defined(__GNUC__)
#   if !(defined(__cplusplus)) || (__GNUC__ > 3 || (__GNUC__ == 3 && __GNUC_MINOR__ >= 4))
#     define CYTHON_UNUSED __attribute__ ((__unused__))
#   else
#     define CYTHON_UNUSED
#   endif
# elif defined(__ICC) || (defined(__INTEL_COMPILER) && !defined(_MSC_VER))
#   define CYTHON_UNUSED __attribute__ ((__unused__))
# else
#   define CYTHON_UNUSED
# endif
#endif
#ifndef CYTHON_NCP_UNUSED
# if CYTHON_COMPILING_IN_CPYTHON
#  define CYTHON_NCP_UNUSED
# else
#  define CYTHON_NCP_UNUSED CYTHON_UNUSED
# endif
#endif
typedef struct {PyObject **p; const char *s; const Py_ssize_t n; const char* encoding;
                const char is_unicode; const char is_str; const char intern; } __Pyx_StringTabEntry;

#define __PYX_DEFAULT_STRING_ENCODING_IS_ASCII 0
#define __PYX_DEFAULT_STRING_ENCODING_IS_DEFAULT 0
#define __PYX_DEFAULT_STRING_ENCODING ""
#define __Pyx_PyObject_FromString __Pyx_PyBytes_FromString
#define __Pyx_PyObject_FromStringAndSize __Pyx_PyBytes_FromStringAndSize
#define __Pyx_uchar_cast(c) ((unsigned char)c)
#define __Pyx_long_cast(x) ((long)x)
#define __Pyx_fits_Py_ssize_t(v, type, is_signed)  (\
    (sizeof(type) < sizeof(Py_ssize_t))  ||\
    (sizeof(type) > sizeof(Py_ssize_t) &&\
          likely(v < (type)PY_SSIZE_T_MAX ||\
                 v == (type)PY_SSIZE_T_MAX)  &&\
          (!is_signed || likely(v > (type)PY_SSIZE_T_MIN ||\
                                v == (type)PY_SSIZE_T_MIN)))  ||\
    (sizeof(type) == sizeof(Py_ssize_t) &&\
          (is_signed || likely(v < (type)PY_SSIZE_T_MAX ||\
                               v == (type)PY_SSIZE_T_MAX)))  )
#if defined (__cplusplus) && __cplusplus >= 201103L
    #include <cstdlib>
    #define __Pyx_sst_abs(value) std::abs(value)
#elif SIZEOF_INT >= SIZEOF_SIZE_T
    #define __Pyx_sst_abs(value) abs(value)
#elif SIZEOF_LONG >= SIZEOF_SIZE_T
    #define __Pyx_sst_abs(value) labs(value)
#elif defined (_MSC_VER) && defined (_M_X64)
    #define __Pyx_sst_abs(value) _abs64(value)
#elif defined (__STDC_VERSION__) && __STDC_VERSION__ >= 199901L
    #define __Pyx_sst_abs(value) llabs(value)
#elif defined (__GNUC__)
    #define __Pyx_sst_abs(value) __builtin_llabs(value)
#else
    #define __Pyx_sst_abs(value) ((value<0) ? -value : value)
#endif
static CYTHON_INLINE char* __Pyx_PyObject_AsString(PyObject*);
static CYTHON_INLINE char* __Pyx_PyObject_AsStringAndSize(PyObject*, Py_ssize_t* length);
#define __Pyx_PyByteArray_FromString(s) PyByteArray_FromStringAndSize((const char*)s, strlen((const char*)s))
#define __Pyx_PyByteArray_FromStringAndSize(s, l) PyByteArray_FromStringAndSize((const char*)s, l)
#define __Pyx_PyBytes_FromString        PyBytes_FromString
#define __Pyx_PyBytes_FromStringAndSize PyBytes_FromStringAndSize
static CYTHON_INLINE PyObject* __Pyx_PyUnicode_FromString(const char*);
#if PY_MAJOR_VERSION < 3
    #define __Pyx_PyStr_FromString        __Pyx_PyBytes_FromString
    #define __Pyx_PyStr_FromStringAndSize __Pyx_PyBytes_FromStringAndSize
#else
    #define __Pyx_PyStr_FromString        __Pyx_PyUnicode_FromString
    #define __Pyx_PyStr_FromStringAndSize __Pyx_PyUnicode_FromStringAndSize
#endif
#define __Pyx_PyObject_AsSString(s)    ((signed char*) __Pyx_PyObject_AsString(s))
#define __Pyx_PyObject_AsUString(s)    ((unsigned char*) __Pyx_PyObject_AsString(s))
#define __Pyx_PyObject_FromCString(s)  __Pyx_PyObject_FromString((const char*)s)
#define __Pyx_PyBytes_FromCString(s)   __Pyx_PyBytes_FromString((const char*)s)
#define __Pyx_PyByteArray_FromCString(s)   __Pyx_PyByteArray_FromString((const char*)s)
#define __Pyx_PyStr_FromCString(s)     __Pyx_PyStr_FromString((const char*)s)
#define __Pyx_PyUnicode_FromCString(s) __Pyx_PyUnicode_FromString((const char*)s)
#if PY_MAJOR_VERSION < 3
static CYTHON_INLINE size_t __Pyx_Py_UNICODE_strlen(const Py_UNICODE *u)
{
    const Py_UNICODE *u_end = u;
    while (*u_end++) ;
    return (size_t)(u_end - u - 1);
}
#else
#define __Pyx_Py_UNICODE_strlen Py_UNICODE_strlen
#endif
#define __Pyx_PyUnicode_FromUnicode(u)       PyUnicode_FromUnicode(u, __Pyx_Py_UNICODE_strlen(u))
#define __Pyx_PyUnicode_FromUnicodeAndLength PyUnicode_FromUnicode
#define __Pyx_PyUnicode_AsUnicode            PyUnicode_AsUnicode
#define __Pyx_NewRef(obj) (Py_INCREF(obj), obj)
#define __Pyx_Owned_Py_None(b) __Pyx_NewRef(Py_None)
#define __Pyx_PyBool_FromLong(b) ((b) ? __Pyx_NewRef(Py_True) : __Pyx_NewRef(Py_False))
static CYTHON_INLINE int __Pyx_PyObject_IsTrue(PyObject*);
static CYTHON_INLINE PyObject* __Pyx_PyNumber_IntOrLong(PyObject* x);
static CYTHON_INLINE Py_ssize_t __Pyx_PyIndex_AsSsize_t(PyObject*);
static CYTHON_INLINE PyObject * __Pyx_PyInt_FromSize_t(size_t);
#if CYTHON_COMPILING_IN_CPYTHON
#define __pyx_PyFloat_AsDouble(x) (PyFloat_CheckExact(x) ? PyFloat_AS_DOUBLE(x) : PyFloat_AsDouble(x))
#else
#define __pyx_PyFloat_AsDouble(x) PyFloat_AsDouble(x)
#endif
#define __pyx_PyFloat_AsFloat(x) ((float) __pyx_PyFloat_AsDouble(x))
#if PY_MAJOR_VERSION >= 3
#define __Pyx_PyNumber_Int(x) (PyLong_CheckExact(x) ? __Pyx_NewRef(x) : PyNumber_Long(x))
#else
#define __Pyx_PyNumber_Int(x) (PyInt_CheckExact(x) ? __Pyx_NewRef(x) : PyNumber_Int(x))
#endif
#define __Pyx_PyNumber_Float(x) (PyFloat_CheckExact(x) ? __Pyx_NewRef(x) : PyNumber_Float(x))
#if PY_MAJOR_VERSION < 3 && __PYX_DEFAULT_STRING_ENCODING_IS_ASCII
static int __Pyx_sys_getdefaultencoding_not_ascii;
static int __Pyx_init_sys_getdefaultencoding_params(void) {
    PyObject* sys;
    PyObject* default_encoding = NULL;
    PyObject* ascii_chars_u = NULL;
    PyObject* ascii_chars_b = NULL;
    const char* default_encoding_c;
    sys = PyImport_ImportModule("sys");
    if (!sys) goto bad;
    default_encoding = PyObject_CallMethod(sys, (char*) "getdefaultencoding", NULL);
    Py_DECREF(sys);
    if (!default_encoding) goto bad;
    default_encoding_c = PyBytes_AsString(default_encoding);
    if (!default_encoding_c) goto bad;
    if (strcmp(default_encoding_c, "ascii") == 0) {
        __Pyx_sys_getdefaultencoding_not_ascii = 0;
    } else {
        char ascii_chars[128];
        int c;
        for (c = 0; c < 128; c++) {
            ascii_chars[c] = c;
        }
        __Pyx_sys_getdefaultencoding_not_ascii = 1;
        ascii_chars_u = PyUnicode_DecodeASCII(ascii_chars, 128, NULL);
        if (!ascii_chars_u) goto bad;
        ascii_chars_b = PyUnicode_AsEncodedString(ascii_chars_u, default_encoding_c, NULL);
        if (!ascii_chars_b || !PyBytes_Check(ascii_chars_b) || memcmp(ascii_chars, PyBytes_AS_STRING(ascii_chars_b), 128) != 0) {
            PyErr_Format(
                PyExc_ValueError,
                "This module compiled with c_string_encoding=ascii, but default encoding '%.200s' is not a superset of ascii.",
                default_encoding_c);
            goto bad;
        }
        Py_DECREF(ascii_chars_u);
        Py_DECREF(ascii_chars_b);
    }
    Py_DECREF(default_encoding);
    return 0;
bad:
    Py_XDECREF(default_encoding);
    Py_XDECREF(ascii_chars_u);
    Py_XDECREF(ascii_chars_b);
    return -1;
}
#endif
#if __PYX_DEFAULT_STRING_ENCODING_IS_DEFAULT && PY_MAJOR_VERSION >= 3
#define __Pyx_PyUnicode_FromStringAndSize(c_str, size) PyUnicode_DecodeUTF8(c_str, size, NULL)
#else
#define __Pyx_PyUnicode_FromStringAndSize(c_str, size) PyUnicode_Decode(c_str, size, __PYX_DEFAULT_STRING_ENCODING, NULL)
#if __PYX_DEFAULT_STRING_ENCODING_IS_DEFAULT
static char* __PYX_DEFAULT_STRING_ENCODING;
static int __Pyx_init_sys_getdefaultencoding_params(void) {
    PyObject* sys;
    PyObject* default_encoding = NULL;
    char* default_encoding_c;
    sys = PyImport_ImportModule("sys");
    if (!sys) goto bad;
    default_encoding = PyObject_CallMethod(sys, (char*) (const char*) "getdefaultencoding", NULL);
    Py_DECREF(sys);
    if (!default_encoding) goto bad;
    default_encoding_c = PyBytes_AsString(default_encoding);
    if (!default_encoding_c) goto bad;
    __PYX_DEFAULT_STRING_ENCODING = (char*) malloc(strlen(default_encoding_c));
    if (!__PYX_DEFAULT_STRING_ENCODING) goto bad;
    strcpy(__PYX_DEFAULT_STRING_ENCODING, default_encoding_c);
    Py_DECREF(default_encoding);
    return 0;
bad:
    Py_XDECREF(default_encoding);
    return -1;
}
#endif
#endif


/* Test for GCC > 2.95 */
#if defined(__GNUC__)     && (__GNUC__ > 2 || (__GNUC__ == 2 && (__GNUC_MINOR__ > 95)))
  #define likely(x)   __builtin_expect(!!(x), 1)
  #define unlikely(x) __builtin_expect(!!(x), 0)
#else /* !__GNUC__ or GCC < 2.95 */
  #define likely(x)   (x)
  #define unlikely(x) (x)
#endif /* __GNUC__ */

static PyObject *__pyx_m;
static PyObject *__pyx_d;
static PyObject *__pyx_b;
static PyObject *__pyx_empty_tuple;
static PyObject *__pyx_empty_bytes;
static PyObject *__pyx_empty_unicode;
static int __pyx_lineno;
static int __pyx_clineno = 0;
static const char * __pyx_cfilenm= __FILE__;
static const char *__pyx_filename;


static const char *__pyx_f[] = {
  "volttron/platform/vip/router/routercy.pyx",
  "buffers.pxd",
  "volttron/platform/vip/router/cymessage.pxd",
  "volttron/platform/vip/router/stringsource",
  "volttron/platform/vip/router/queue.pxd",
  "context.pxd",
  "socket.pxd",
  "volttron/platform/vip/router/cysocket.pxd",
  "type.pxd",
  "bool.pxd",
  "complex.pxd",
};

/*--- Type declarations ---*/
struct __pyx_obj_8volttron_8platform_3vip_6router_5queue_Queue;
struct __pyx_obj_3zmq_7backend_6cython_7context_Context;
struct __pyx_obj_3zmq_7backend_6cython_6socket_Socket;
struct __pyx_obj_8volttron_8platform_3vip_6router_8cysocket_Socket;
struct __pyx_obj_8volttron_8platform_3vip_6router_9cymessage_Frame;
struct __pyx_obj_8volttron_8platform_3vip_6router_8routercy_BaseRouter;
struct __pyx_opt_args_3zmq_7backend_6cython_6socket_6Socket_send;
struct __pyx_opt_args_3zmq_7backend_6cython_6socket_6Socket_recv;

/* "zmq/backend/cython/socket.pxd":45
 * 
 *     # cpdef methods for direct-cython access:
 *     cpdef object send(self, object data, int flags=*, copy=*, track=*)             # <<<<<<<<<<<<<<
 *     cpdef object recv(self, int flags=*, copy=*, track=*)
 * 
 */
struct __pyx_opt_args_3zmq_7backend_6cython_6socket_6Socket_send {
  int __pyx_n;
  int flags;
  PyObject *copy;
  PyObject *track;
};

/* "zmq/backend/cython/socket.pxd":46
 *     # cpdef methods for direct-cython access:
 *     cpdef object send(self, object data, int flags=*, copy=*, track=*)
 *     cpdef object recv(self, int flags=*, copy=*, track=*)             # <<<<<<<<<<<<<<
 * 
 */
struct __pyx_opt_args_3zmq_7backend_6cython_6socket_6Socket_recv {
  int __pyx_n;
  int flags;
  PyObject *copy;
  PyObject *track;
};
struct __pyx_opt_args_8volttron_8platform_3vip_6router_8cysocket_6Socket_send_multi;
struct __pyx_opt_args_8volttron_8platform_3vip_6router_8cysocket_6Socket_send_notracker;
struct __pyx_opt_args_8volttron_8platform_3vip_6router_8cysocket_6Socket_send_as_frames;
struct __pyx_opt_args_8volttron_8platform_3vip_6router_8cysocket_6Socket_recv;

/* "cysocket.pxd":34
 * cdef class Socket(SocketBase):
 *     # cpdef methods for direct-cython access:
 *     cpdef send_multi(self, object msg_parts, int flags = *, copy = *, track = *, bint isFrame = *)             # <<<<<<<<<<<<<<
 *     cdef send_notracker(self, object data, int flags = *, bint copy = *)
 *     cdef int send_as_frames(self, object data, int flags = *)
 */
struct __pyx_opt_args_8volttron_8platform_3vip_6router_8cysocket_6Socket_send_multi {
  int __pyx_n;
  int flags;
  PyObject *copy;
  PyObject *track;
  int isFrame;
};

/* "cysocket.pxd":35
 *     # cpdef methods for direct-cython access:
 *     cpdef send_multi(self, object msg_parts, int flags = *, copy = *, track = *, bint isFrame = *)
 *     cdef send_notracker(self, object data, int flags = *, bint copy = *)             # <<<<<<<<<<<<<<
 *     cdef int send_as_frames(self, object data, int flags = *)
 *     cpdef object recv(self, int flags=*, copy=*, track=*)
 */
struct __pyx_opt_args_8volttron_8platform_3vip_6router_8cysocket_6Socket_send_notracker {
  int __pyx_n;
  int flags;
  int copy;
};

/* "cysocket.pxd":36
 *     cpdef send_multi(self, object msg_parts, int flags = *, copy = *, track = *, bint isFrame = *)
 *     cdef send_notracker(self, object data, int flags = *, bint copy = *)
 *     cdef int send_as_frames(self, object data, int flags = *)             # <<<<<<<<<<<<<<
 *     cpdef object recv(self, int flags=*, copy=*, track=*)
 * 
 */
struct __pyx_opt_args_8volttron_8platform_3vip_6router_8cysocket_6Socket_send_as_frames {
  int __pyx_n;
  int flags;
};

/* "cysocket.pxd":37
 *     cdef send_notracker(self, object data, int flags = *, bint copy = *)
 *     cdef int send_as_frames(self, object data, int flags = *)
 *     cpdef object recv(self, int flags=*, copy=*, track=*)             # <<<<<<<<<<<<<<
 * 
 */
struct __pyx_opt_args_8volttron_8platform_3vip_6router_8cysocket_6Socket_recv {
  int __pyx_n;
  int flags;
  PyObject *copy;
  PyObject *track;
};
struct __pyx_opt_args_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_stop;
struct __pyx_opt_args_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_issue;

/* "volttron/platform/vip/router/routercy.pxd":28
 *     cpdef run(self)
 *     cpdef start(self)
 *     cpdef stop(self, int linger=*)             # <<<<<<<<<<<<<<
 *     cpdef setup(self)
 * 
 */
struct __pyx_opt_args_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_stop {
  int __pyx_n;
  int linger;
};

/* "volttron/platform/vip/router/routercy.pxd":35
 *     cpdef object handle_subsystem(self, object frames, object user_id)
 * 
 *     cpdef issue(self, int topic, object frames, object extra=*)             # <<<<<<<<<<<<<<
 * 
 *     cdef _distribute(self, bytes subsys, bytes cmd, string peer)
 */
struct __pyx_opt_args_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_issue {
  int __pyx_n;
  PyObject *extra;
};

/* "queue.pxd":5
 * # Code
 * #-----------------------------------------------------------------------------
 * cdef class Queue:             # <<<<<<<<<<<<<<
 *     # cpdef methods for direct-cython access
 *     cdef append(self, void* value)
 */
struct __pyx_obj_8volttron_8platform_3vip_6router_5queue_Queue {
  PyObject_HEAD
  struct __pyx_vtabstruct_8volttron_8platform_3vip_6router_5queue_Queue *__pyx_vtab;
};


/* "context.pxd":26
 * #-----------------------------------------------------------------------------
 * 
 * cdef class Context:             # <<<<<<<<<<<<<<
 * 
 *     cdef object __weakref__     # enable weakref
 */
struct __pyx_obj_3zmq_7backend_6cython_7context_Context {
  PyObject_HEAD
  struct __pyx_vtabstruct_3zmq_7backend_6cython_7context_Context *__pyx_vtab;
  PyObject *__weakref__;
  void *handle;
  int _shadow;
  void **_sockets;
  size_t _n_sockets;
  size_t _max_sockets;
  int _pid;
  int closed;
};


/* "zmq/backend/cython/socket.pxd":33
 * 
 * 
 * cdef class Socket:             # <<<<<<<<<<<<<<
 * 
 *     cdef object __weakref__     # enable weakref
 */
struct __pyx_obj_3zmq_7backend_6cython_6socket_Socket {
  PyObject_HEAD
  struct __pyx_vtabstruct_3zmq_7backend_6cython_6socket_Socket *__pyx_vtab;
  PyObject *__weakref__;
  void *handle;
  int _shadow;
  struct __pyx_obj_3zmq_7backend_6cython_7context_Context *context;
  int _closed;
  int _pid;
};


/* "cysocket.pxd":32
 * #-----------------------------------------------------------------------------
 * 
 * cdef class Socket(SocketBase):             # <<<<<<<<<<<<<<
 *     # cpdef methods for direct-cython access:
 *     cpdef send_multi(self, object msg_parts, int flags = *, copy = *, track = *, bint isFrame = *)
 */
struct __pyx_obj_8volttron_8platform_3vip_6router_8cysocket_Socket {
  struct __pyx_obj_3zmq_7backend_6cython_6socket_Socket __pyx_base;
};


/* "cymessage.pxd":34
 * #-----------------------------------------------------------------------------
 * 
 * cdef class Frame:             # <<<<<<<<<<<<<<
 *     cdef zmq_msg_t zmq_msg
 *     cdef bint _failed_init # Flag to handle failed zmq_msg_init
 */
struct __pyx_obj_8volttron_8platform_3vip_6router_9cymessage_Frame {
  PyObject_HEAD
  struct __pyx_vtabstruct_8volttron_8platform_3vip_6router_9cymessage_Frame *__pyx_vtab;
  zmq_msg_t zmq_msg;
  int _failed_init;
  int more;
  PyObject *_bytes;
};


/* "volttron/platform/vip/router/routercy.pxd":14
 * ERROR = 3
 * 
 * cdef class BaseRouter:             # <<<<<<<<<<<<<<
 *     cdef:
 *         set[string] _peers
 */
struct __pyx_obj_8volttron_8platform_3vip_6router_8routercy_BaseRouter {
  PyObject_HEAD
  struct __pyx_vtabstruct_8volttron_8platform_3vip_6router_8routercy_BaseRouter *__pyx_vtab;
  std::set<std::string>  _peers;
  struct __pyx_obj_8volttron_8platform_3vip_6router_8cysocket_Socket *socket;
  PyObject *context;
  PyObject *default_user_id;
  PyObject *logger;
  int OUTGOING;
  int INCOMING;
  int UNROUTABLE;
  int ERROR;
};



/* "queue.pxd":5
 * # Code
 * #-----------------------------------------------------------------------------
 * cdef class Queue:             # <<<<<<<<<<<<<<
 *     # cpdef methods for direct-cython access
 *     cdef append(self, void* value)
 */

struct __pyx_vtabstruct_8volttron_8platform_3vip_6router_5queue_Queue {
  PyObject *(*append)(struct __pyx_obj_8volttron_8platform_3vip_6router_5queue_Queue *, void *);
  PyObject *(*c_extend)(struct __pyx_obj_8volttron_8platform_3vip_6router_5queue_Queue *, void **, size_t);
  void *(*pop)(struct __pyx_obj_8volttron_8platform_3vip_6router_5queue_Queue *);
};
static struct __pyx_vtabstruct_8volttron_8platform_3vip_6router_5queue_Queue *__pyx_vtabptr_8volttron_8platform_3vip_6router_5queue_Queue;


/* "context.pxd":26
 * #-----------------------------------------------------------------------------
 * 
 * cdef class Context:             # <<<<<<<<<<<<<<
 * 
 *     cdef object __weakref__     # enable weakref
 */

struct __pyx_vtabstruct_3zmq_7backend_6cython_7context_Context {
  int (*_term)(struct __pyx_obj_3zmq_7backend_6cython_7context_Context *);
  void (*_add_socket)(struct __pyx_obj_3zmq_7backend_6cython_7context_Context *, void *);
  void (*_remove_socket)(struct __pyx_obj_3zmq_7backend_6cython_7context_Context *, void *);
};
static struct __pyx_vtabstruct_3zmq_7backend_6cython_7context_Context *__pyx_vtabptr_3zmq_7backend_6cython_7context_Context;


/* "zmq/backend/cython/socket.pxd":33
 * 
 * 
 * cdef class Socket:             # <<<<<<<<<<<<<<
 * 
 *     cdef object __weakref__     # enable weakref
 */

struct __pyx_vtabstruct_3zmq_7backend_6cython_6socket_Socket {
  PyObject *(*send)(struct __pyx_obj_3zmq_7backend_6cython_6socket_Socket *, PyObject *, int __pyx_skip_dispatch, struct __pyx_opt_args_3zmq_7backend_6cython_6socket_6Socket_send *__pyx_optional_args);
  PyObject *(*recv)(struct __pyx_obj_3zmq_7backend_6cython_6socket_Socket *, int __pyx_skip_dispatch, struct __pyx_opt_args_3zmq_7backend_6cython_6socket_6Socket_recv *__pyx_optional_args);
};
static struct __pyx_vtabstruct_3zmq_7backend_6cython_6socket_Socket *__pyx_vtabptr_3zmq_7backend_6cython_6socket_Socket;


/* "cysocket.pxd":32
 * #-----------------------------------------------------------------------------
 * 
 * cdef class Socket(SocketBase):             # <<<<<<<<<<<<<<
 *     # cpdef methods for direct-cython access:
 *     cpdef send_multi(self, object msg_parts, int flags = *, copy = *, track = *, bint isFrame = *)
 */

struct __pyx_vtabstruct_8volttron_8platform_3vip_6router_8cysocket_Socket {
  struct __pyx_vtabstruct_3zmq_7backend_6cython_6socket_Socket __pyx_base;
  PyObject *(*send_multi)(struct __pyx_obj_8volttron_8platform_3vip_6router_8cysocket_Socket *, PyObject *, int __pyx_skip_dispatch, struct __pyx_opt_args_8volttron_8platform_3vip_6router_8cysocket_6Socket_send_multi *__pyx_optional_args);
  PyObject *(*send_notracker)(struct __pyx_obj_8volttron_8platform_3vip_6router_8cysocket_Socket *, PyObject *, struct __pyx_opt_args_8volttron_8platform_3vip_6router_8cysocket_6Socket_send_notracker *__pyx_optional_args);
  int (*send_as_frames)(struct __pyx_obj_8volttron_8platform_3vip_6router_8cysocket_Socket *, PyObject *, struct __pyx_opt_args_8volttron_8platform_3vip_6router_8cysocket_6Socket_send_as_frames *__pyx_optional_args);
};
static struct __pyx_vtabstruct_8volttron_8platform_3vip_6router_8cysocket_Socket *__pyx_vtabptr_8volttron_8platform_3vip_6router_8cysocket_Socket;


/* "cymessage.pxd":34
 * #-----------------------------------------------------------------------------
 * 
 * cdef class Frame:             # <<<<<<<<<<<<<<
 *     cdef zmq_msg_t zmq_msg
 *     cdef bint _failed_init # Flag to handle failed zmq_msg_init
 */

struct __pyx_vtabstruct_8volttron_8platform_3vip_6router_9cymessage_Frame {
  PyObject *(*bytes)(struct __pyx_obj_8volttron_8platform_3vip_6router_9cymessage_Frame *);
  PyObject *(*set)(struct __pyx_obj_8volttron_8platform_3vip_6router_9cymessage_Frame *, int, int);
  PyObject *(*get)(struct __pyx_obj_8volttron_8platform_3vip_6router_9cymessage_Frame *, int);
  PyObject *(*gets)(struct __pyx_obj_8volttron_8platform_3vip_6router_9cymessage_Frame *, PyObject *);
};
static struct __pyx_vtabstruct_8volttron_8platform_3vip_6router_9cymessage_Frame *__pyx_vtabptr_8volttron_8platform_3vip_6router_9cymessage_Frame;


/* "volttron/platform/vip/router/routercy.pyx":28
 * ERROR = 3
 * 
 * cdef class BaseRouter:             # <<<<<<<<<<<<<<
 *     '''Abstract base class of VIP router implementation.
 * 
 */

struct __pyx_vtabstruct_8volttron_8platform_3vip_6router_8routercy_BaseRouter {
  PyObject *(*run)(struct __pyx_obj_8volttron_8platform_3vip_6router_8routercy_BaseRouter *, int __pyx_skip_dispatch);
  PyObject *(*start)(struct __pyx_obj_8volttron_8platform_3vip_6router_8routercy_BaseRouter *, int __pyx_skip_dispatch);
  PyObject *(*stop)(struct __pyx_obj_8volttron_8platform_3vip_6router_8routercy_BaseRouter *, int __pyx_skip_dispatch, struct __pyx_opt_args_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_stop *__pyx_optional_args);
  PyObject *(*setup)(struct __pyx_obj_8volttron_8platform_3vip_6router_8routercy_BaseRouter *, int __pyx_skip_dispatch);
  PyObject *(*poll)(struct __pyx_obj_8volttron_8platform_3vip_6router_8routercy_BaseRouter *, int __pyx_skip_dispatch);
  PyObject *(*handle_subsystem)(struct __pyx_obj_8volttron_8platform_3vip_6router_8routercy_BaseRouter *, PyObject *, PyObject *, int __pyx_skip_dispatch);
  PyObject *(*issue)(struct __pyx_obj_8volttron_8platform_3vip_6router_8routercy_BaseRouter *, int, PyObject *, int __pyx_skip_dispatch, struct __pyx_opt_args_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_issue *__pyx_optional_args);
  PyObject *(*_distribute)(struct __pyx_obj_8volttron_8platform_3vip_6router_8routercy_BaseRouter *, PyObject *, PyObject *, std::string);
  PyObject *(*_add_peer)(struct __pyx_obj_8volttron_8platform_3vip_6router_8routercy_BaseRouter *, std::string, int __pyx_skip_dispatch);
  PyObject *(*_drop_peer)(struct __pyx_obj_8volttron_8platform_3vip_6router_8routercy_BaseRouter *, std::string, int __pyx_skip_dispatch);
  PyObject *(*route)(struct __pyx_obj_8volttron_8platform_3vip_6router_8routercy_BaseRouter *, int __pyx_skip_dispatch);
  struct __pyx_obj_8volttron_8platform_3vip_6router_5queue_Queue *(*_send)(struct __pyx_obj_8volttron_8platform_3vip_6router_8routercy_BaseRouter *, struct __pyx_obj_8volttron_8platform_3vip_6router_5queue_Queue *, int __pyx_skip_dispatch);
};
static struct __pyx_vtabstruct_8volttron_8platform_3vip_6router_8routercy_BaseRouter *__pyx_vtabptr_8volttron_8platform_3vip_6router_8routercy_BaseRouter;

/* --- Runtime support code (head) --- */
/* Refnanny.proto */
#ifndef CYTHON_REFNANNY
  #define CYTHON_REFNANNY 0
#endif
#if CYTHON_REFNANNY
  typedef struct {
    void (*INCREF)(void*, PyObject*, int);
    void (*DECREF)(void*, PyObject*, int);
    void (*GOTREF)(void*, PyObject*, int);
    void (*GIVEREF)(void*, PyObject*, int);
    void* (*SetupContext)(const char*, int, const char*);
    void (*FinishContext)(void**);
  } __Pyx_RefNannyAPIStruct;
  static __Pyx_RefNannyAPIStruct *__Pyx_RefNanny = NULL;
  static __Pyx_RefNannyAPIStruct *__Pyx_RefNannyImportAPI(const char *modname);
  #define __Pyx_RefNannyDeclarations void *__pyx_refnanny = NULL;
#ifdef WITH_THREAD
  #define __Pyx_RefNannySetupContext(name, acquire_gil)\
          if (acquire_gil) {\
              PyGILState_STATE __pyx_gilstate_save = PyGILState_Ensure();\
              __pyx_refnanny = __Pyx_RefNanny->SetupContext((name), __LINE__, __FILE__);\
              PyGILState_Release(__pyx_gilstate_save);\
          } else {\
              __pyx_refnanny = __Pyx_RefNanny->SetupContext((name), __LINE__, __FILE__);\
          }
#else
  #define __Pyx_RefNannySetupContext(name, acquire_gil)\
          __pyx_refnanny = __Pyx_RefNanny->SetupContext((name), __LINE__, __FILE__)
#endif
  #define __Pyx_RefNannyFinishContext()\
          __Pyx_RefNanny->FinishContext(&__pyx_refnanny)
  #define __Pyx_INCREF(r)  __Pyx_RefNanny->INCREF(__pyx_refnanny, (PyObject *)(r), __LINE__)
  #define __Pyx_DECREF(r)  __Pyx_RefNanny->DECREF(__pyx_refnanny, (PyObject *)(r), __LINE__)
  #define __Pyx_GOTREF(r)  __Pyx_RefNanny->GOTREF(__pyx_refnanny, (PyObject *)(r), __LINE__)
  #define __Pyx_GIVEREF(r) __Pyx_RefNanny->GIVEREF(__pyx_refnanny, (PyObject *)(r), __LINE__)
  #define __Pyx_XINCREF(r)  do { if((r) != NULL) {__Pyx_INCREF(r); }} while(0)
  #define __Pyx_XDECREF(r)  do { if((r) != NULL) {__Pyx_DECREF(r); }} while(0)
  #define __Pyx_XGOTREF(r)  do { if((r) != NULL) {__Pyx_GOTREF(r); }} while(0)
  #define __Pyx_XGIVEREF(r) do { if((r) != NULL) {__Pyx_GIVEREF(r);}} while(0)
#else
  #define __Pyx_RefNannyDeclarations
  #define __Pyx_RefNannySetupContext(name, acquire_gil)
  #define __Pyx_RefNannyFinishContext()
  #define __Pyx_INCREF(r) Py_INCREF(r)
  #define __Pyx_DECREF(r) Py_DECREF(r)
  #define __Pyx_GOTREF(r)
  #define __Pyx_GIVEREF(r)
  #define __Pyx_XINCREF(r) Py_XINCREF(r)
  #define __Pyx_XDECREF(r) Py_XDECREF(r)
  #define __Pyx_XGOTREF(r)
  #define __Pyx_XGIVEREF(r)
#endif
#define __Pyx_XDECREF_SET(r, v) do {\
        PyObject *tmp = (PyObject *) r;\
        r = v; __Pyx_XDECREF(tmp);\
    } while (0)
#define __Pyx_DECREF_SET(r, v) do {\
        PyObject *tmp = (PyObject *) r;\
        r = v; __Pyx_DECREF(tmp);\
    } while (0)
#define __Pyx_CLEAR(r)    do { PyObject* tmp = ((PyObject*)(r)); r = NULL; __Pyx_DECREF(tmp);} while(0)
#define __Pyx_XCLEAR(r)   do { if((r) != NULL) {PyObject* tmp = ((PyObject*)(r)); r = NULL; __Pyx_DECREF(tmp);}} while(0)

/* PyObjectGetAttrStr.proto */
#if CYTHON_COMPILING_IN_CPYTHON
static CYTHON_INLINE PyObject* __Pyx_PyObject_GetAttrStr(PyObject* obj, PyObject* attr_name) {
    PyTypeObject* tp = Py_TYPE(obj);
    if (likely(tp->tp_getattro))
        return tp->tp_getattro(obj, attr_name);
#if PY_MAJOR_VERSION < 3
    if (likely(tp->tp_getattr))
        return tp->tp_getattr(obj, PyString_AS_STRING(attr_name));
#endif
    return PyObject_GetAttr(obj, attr_name);
}
#else
#define __Pyx_PyObject_GetAttrStr(o,n) PyObject_GetAttr(o,n)
#endif

/* GetBuiltinName.proto */
static PyObject *__Pyx_GetBuiltinName(PyObject *name);

/* RaiseDoubleKeywords.proto */
static void __Pyx_RaiseDoubleKeywordsError(const char* func_name, PyObject* kw_name);

/* ParseKeywords.proto */
static int __Pyx_ParseOptionalKeywords(PyObject *kwds, PyObject **argnames[],\
    PyObject *kwds2, PyObject *values[], Py_ssize_t num_pos_args,\
    const char* function_name);

/* RaiseArgTupleInvalid.proto */
static void __Pyx_RaiseArgtupleInvalid(const char* func_name, int exact,
    Py_ssize_t num_min, Py_ssize_t num_max, Py_ssize_t num_found);

/* GetModuleGlobalName.proto */
static CYTHON_INLINE PyObject *__Pyx_GetModuleGlobalName(PyObject *name);

/* PyObjectCall.proto */
#if CYTHON_COMPILING_IN_CPYTHON
static CYTHON_INLINE PyObject* __Pyx_PyObject_Call(PyObject *func, PyObject *arg, PyObject *kw);
#else
#define __Pyx_PyObject_Call(func, arg, kw) PyObject_Call(func, arg, kw)
#endif

/* PyObjectCallMethO.proto */
#if CYTHON_COMPILING_IN_CPYTHON
static CYTHON_INLINE PyObject* __Pyx_PyObject_CallMethO(PyObject *func, PyObject *arg);
#endif

/* PyObjectCallOneArg.proto */
static CYTHON_INLINE PyObject* __Pyx_PyObject_CallOneArg(PyObject *func, PyObject *arg);

/* PyObjectCallNoArg.proto */
#if CYTHON_COMPILING_IN_CPYTHON
static CYTHON_INLINE PyObject* __Pyx_PyObject_CallNoArg(PyObject *func);
#else
#define __Pyx_PyObject_CallNoArg(func) __Pyx_PyObject_Call(func, __pyx_empty_tuple, NULL)
#endif

/* PyDictContains.proto */
static CYTHON_INLINE int __Pyx_PyDict_ContainsTF(PyObject* item, PyObject* dict, int eq) {
    int result = PyDict_Contains(dict, item);
    return unlikely(result < 0) ? result : (result == (eq == Py_EQ));
}

/* DictGetItem.proto */
#if PY_MAJOR_VERSION >= 3 && !CYTHON_COMPILING_IN_PYPY
static PyObject *__Pyx_PyDict_GetItem(PyObject *d, PyObject* key) {
    PyObject *value;
    value = PyDict_GetItemWithError(d, key);
    if (unlikely(!value)) {
        if (!PyErr_Occurred()) {
            PyObject* args = PyTuple_Pack(1, key);
            if (likely(args))
                PyErr_SetObject(PyExc_KeyError, args);
            Py_XDECREF(args);
        }
        return NULL;
    }
    Py_INCREF(value);
    return value;
}
#else
    #define __Pyx_PyDict_GetItem(d, key) PyObject_GetItem(d, key)
#endif

/* PyThreadStateGet.proto */
#if CYTHON_COMPILING_IN_CPYTHON
#define __Pyx_PyThreadState_declare  PyThreadState *__pyx_tstate;
#define __Pyx_PyThreadState_assign  __pyx_tstate = PyThreadState_GET();
#else
#define __Pyx_PyThreadState_declare
#define __Pyx_PyThreadState_assign
#endif

/* PyErrFetchRestore.proto */
#if CYTHON_COMPILING_IN_CPYTHON
#define __Pyx_ErrRestoreWithState(type, value, tb)  __Pyx_ErrRestoreInState(PyThreadState_GET(), type, value, tb)
#define __Pyx_ErrFetchWithState(type, value, tb)    __Pyx_ErrFetchInState(PyThreadState_GET(), type, value, tb)
#define __Pyx_ErrRestore(type, value, tb)  __Pyx_ErrRestoreInState(__pyx_tstate, type, value, tb)
#define __Pyx_ErrFetch(type, value, tb)    __Pyx_ErrFetchInState(__pyx_tstate, type, value, tb)
static CYTHON_INLINE void __Pyx_ErrRestoreInState(PyThreadState *tstate, PyObject *type, PyObject *value, PyObject *tb);
static CYTHON_INLINE void __Pyx_ErrFetchInState(PyThreadState *tstate, PyObject **type, PyObject **value, PyObject **tb);
#else
#define __Pyx_ErrRestoreWithState(type, value, tb)  PyErr_Restore(type, value, tb)
#define __Pyx_ErrFetchWithState(type, value, tb)  PyErr_Fetch(type, value, tb)
#define __Pyx_ErrRestore(type, value, tb)  PyErr_Restore(type, value, tb)
#define __Pyx_ErrFetch(type, value, tb)  PyErr_Fetch(type, value, tb)
#endif

/* GetException.proto */
#if CYTHON_COMPILING_IN_CPYTHON
#define __Pyx_GetException(type, value, tb)  __Pyx__GetException(__pyx_tstate, type, value, tb)
static int __Pyx__GetException(PyThreadState *tstate, PyObject **type, PyObject **value, PyObject **tb);
#else
static int __Pyx_GetException(PyObject **type, PyObject **value, PyObject **tb);
#endif

/* SwapException.proto */
#if CYTHON_COMPILING_IN_CPYTHON
#define __Pyx_ExceptionSwap(type, value, tb)  __Pyx__ExceptionSwap(__pyx_tstate, type, value, tb)
static CYTHON_INLINE void __Pyx__ExceptionSwap(PyThreadState *tstate, PyObject **type, PyObject **value, PyObject **tb);
#else
static CYTHON_INLINE void __Pyx_ExceptionSwap(PyObject **type, PyObject **value, PyObject **tb);
#endif

/* SaveResetException.proto */
#if CYTHON_COMPILING_IN_CPYTHON
#define __Pyx_ExceptionSave(type, value, tb)  __Pyx__ExceptionSave(__pyx_tstate, type, value, tb)
static CYTHON_INLINE void __Pyx__ExceptionSave(PyThreadState *tstate, PyObject **type, PyObject **value, PyObject **tb);
#define __Pyx_ExceptionReset(type, value, tb)  __Pyx__ExceptionReset(__pyx_tstate, type, value, tb)
static CYTHON_INLINE void __Pyx__ExceptionReset(PyThreadState *tstate, PyObject *type, PyObject *value, PyObject *tb);
#else
#define __Pyx_ExceptionSave(type, value, tb)   PyErr_GetExcInfo(type, value, tb)
#define __Pyx_ExceptionReset(type, value, tb)  PyErr_SetExcInfo(type, value, tb)
#endif

/* ExtTypeTest.proto */
static CYTHON_INLINE int __Pyx_TypeTest(PyObject *obj, PyTypeObject *type);

/* PyObjectSetAttrStr.proto */
#if CYTHON_COMPILING_IN_CPYTHON
#define __Pyx_PyObject_DelAttrStr(o,n) __Pyx_PyObject_SetAttrStr(o,n,NULL)
static CYTHON_INLINE int __Pyx_PyObject_SetAttrStr(PyObject* obj, PyObject* attr_name, PyObject* value) {
    PyTypeObject* tp = Py_TYPE(obj);
    if (likely(tp->tp_setattro))
        return tp->tp_setattro(obj, attr_name, value);
#if PY_MAJOR_VERSION < 3
    if (likely(tp->tp_setattr))
        return tp->tp_setattr(obj, PyString_AS_STRING(attr_name), value);
#endif
    return PyObject_SetAttr(obj, attr_name, value);
}
#else
#define __Pyx_PyObject_DelAttrStr(o,n)   PyObject_DelAttr(o,n)
#define __Pyx_PyObject_SetAttrStr(o,n,v) PyObject_SetAttr(o,n,v)
#endif

/* RaiseException.proto */
static void __Pyx_Raise(PyObject *type, PyObject *value, PyObject *tb, PyObject *cause);

/* PyErrExceptionMatches.proto */
#if CYTHON_COMPILING_IN_CPYTHON
#define __Pyx_PyErr_ExceptionMatches(err) __Pyx_PyErr_ExceptionMatchesInState(__pyx_tstate, err)
static CYTHON_INLINE int __Pyx_PyErr_ExceptionMatchesInState(PyThreadState* tstate, PyObject* err);
#else
#define __Pyx_PyErr_ExceptionMatches(err)  PyErr_ExceptionMatches(err)
#endif

/* SetItemInt.proto */
#define __Pyx_SetItemInt(o, i, v, type, is_signed, to_py_func, is_list, wraparound, boundscheck)\
    (__Pyx_fits_Py_ssize_t(i, type, is_signed) ?\
    __Pyx_SetItemInt_Fast(o, (Py_ssize_t)i, v, is_list, wraparound, boundscheck) :\
    (is_list ? (PyErr_SetString(PyExc_IndexError, "list assignment index out of range"), -1) :\
               __Pyx_SetItemInt_Generic(o, to_py_func(i), v)))
static CYTHON_INLINE int __Pyx_SetItemInt_Generic(PyObject *o, PyObject *j, PyObject *v);
static CYTHON_INLINE int __Pyx_SetItemInt_Fast(PyObject *o, Py_ssize_t i, PyObject *v,
                                               int is_list, int wraparound, int boundscheck);

/* PyIntBinop.proto */
#if CYTHON_COMPILING_IN_CPYTHON
static PyObject* __Pyx_PyInt_EqObjC(PyObject *op1, PyObject *op2, long intval, int inplace);
#else
#define __Pyx_PyInt_EqObjC(op1, op2, intval, inplace)\
    PyObject_RichCompare(op1, op2, Py_EQ)
    #endif

/* GetItemInt.proto */
#define __Pyx_GetItemInt(o, i, type, is_signed, to_py_func, is_list, wraparound, boundscheck)\
    (__Pyx_fits_Py_ssize_t(i, type, is_signed) ?\
    __Pyx_GetItemInt_Fast(o, (Py_ssize_t)i, is_list, wraparound, boundscheck) :\
    (is_list ? (PyErr_SetString(PyExc_IndexError, "list index out of range"), (PyObject*)NULL) :\
               __Pyx_GetItemInt_Generic(o, to_py_func(i))))
#define __Pyx_GetItemInt_List(o, i, type, is_signed, to_py_func, is_list, wraparound, boundscheck)\
    (__Pyx_fits_Py_ssize_t(i, type, is_signed) ?\
    __Pyx_GetItemInt_List_Fast(o, (Py_ssize_t)i, wraparound, boundscheck) :\
    (PyErr_SetString(PyExc_IndexError, "list index out of range"), (PyObject*)NULL))
static CYTHON_INLINE PyObject *__Pyx_GetItemInt_List_Fast(PyObject *o, Py_ssize_t i,
                                                              int wraparound, int boundscheck);
#define __Pyx_GetItemInt_Tuple(o, i, type, is_signed, to_py_func, is_list, wraparound, boundscheck)\
    (__Pyx_fits_Py_ssize_t(i, type, is_signed) ?\
    __Pyx_GetItemInt_Tuple_Fast(o, (Py_ssize_t)i, wraparound, boundscheck) :\
    (PyErr_SetString(PyExc_IndexError, "tuple index out of range"), (PyObject*)NULL))
static CYTHON_INLINE PyObject *__Pyx_GetItemInt_Tuple_Fast(PyObject *o, Py_ssize_t i,
                                                              int wraparound, int boundscheck);
static CYTHON_INLINE PyObject *__Pyx_GetItemInt_Generic(PyObject *o, PyObject* j);
static CYTHON_INLINE PyObject *__Pyx_GetItemInt_Fast(PyObject *o, Py_ssize_t i,
                                                     int is_list, int wraparound, int boundscheck);

/* IncludeStringH.proto */
#include <string.h>

/* BytesEquals.proto */
static CYTHON_INLINE int __Pyx_PyBytes_Equals(PyObject* s1, PyObject* s2, int equals);

/* RaiseTooManyValuesToUnpack.proto */
static CYTHON_INLINE void __Pyx_RaiseTooManyValuesError(Py_ssize_t expected);

/* RaiseNeedMoreValuesToUnpack.proto */
static CYTHON_INLINE void __Pyx_RaiseNeedMoreValuesError(Py_ssize_t index);

/* IterFinish.proto */
static CYTHON_INLINE int __Pyx_IterFinish(void);

/* UnpackItemEndCheck.proto */
static int __Pyx_IternextUnpackEndCheck(PyObject *retval, Py_ssize_t expected);

/* SliceObject.proto */
static CYTHON_INLINE PyObject* __Pyx_PyObject_GetSlice(
        PyObject* obj, Py_ssize_t cstart, Py_ssize_t cstop,
        PyObject** py_start, PyObject** py_stop, PyObject** py_slice,
        int has_cstart, int has_cstop, int wraparound);

/* ArgTypeTest.proto */
static CYTHON_INLINE int __Pyx_ArgTypeTest(PyObject *obj, PyTypeObject *type, int none_allowed,
    const char *name, int exact);

/* SetVTable.proto */
static int __Pyx_SetVtable(PyObject *dict, void *vtable);

/* GetVTable.proto */
static void* __Pyx_GetVtable(PyObject *dict);

/* Import.proto */
static PyObject *__Pyx_Import(PyObject *name, PyObject *from_list, int level);

/* ImportFrom.proto */
static PyObject* __Pyx_ImportFrom(PyObject* module, PyObject* name);

/* CodeObjectCache.proto */
typedef struct {
    PyCodeObject* code_object;
    int code_line;
} __Pyx_CodeObjectCacheEntry;
struct __Pyx_CodeObjectCache {
    int count;
    int max_count;
    __Pyx_CodeObjectCacheEntry* entries;
};
static struct __Pyx_CodeObjectCache __pyx_code_cache = {0,0,NULL};
static int __pyx_bisect_code_objects(__Pyx_CodeObjectCacheEntry* entries, int count, int code_line);
static PyCodeObject *__pyx_find_code_object(int code_line);
static void __pyx_insert_code_object(int code_line, PyCodeObject* code_object);

/* AddTraceback.proto */
static void __Pyx_AddTraceback(const char *funcname, int c_line,
                               int py_line, const char *filename);

/* None.proto */
#include <new>

/* Print.proto */
static int __Pyx_Print(PyObject*, PyObject *, int);
#if CYTHON_COMPILING_IN_PYPY || PY_MAJOR_VERSION >= 3
static PyObject* __pyx_print = 0;
static PyObject* __pyx_print_kwargs = 0;
#endif

/* CIntToPy.proto */
static CYTHON_INLINE PyObject* __Pyx_PyInt_From_int(int value);

/* CIntToPy.proto */
static CYTHON_INLINE PyObject* __Pyx_PyInt_From_long(long value);

/* CppExceptionConversion.proto */
#ifndef __Pyx_CppExn2PyErr
#include <new>
#include <typeinfo>
#include <stdexcept>
#include <ios>
static void __Pyx_CppExn2PyErr() {
  try {
    if (PyErr_Occurred())
      ; // let the latest Python exn pass through and ignore the current one
    else
      throw;
  } catch (const std::bad_alloc& exn) {
    PyErr_SetString(PyExc_MemoryError, exn.what());
  } catch (const std::bad_cast& exn) {
    PyErr_SetString(PyExc_TypeError, exn.what());
  } catch (const std::domain_error& exn) {
    PyErr_SetString(PyExc_ValueError, exn.what());
  } catch (const std::invalid_argument& exn) {
    PyErr_SetString(PyExc_ValueError, exn.what());
  } catch (const std::ios_base::failure& exn) {
    PyErr_SetString(PyExc_IOError, exn.what());
  } catch (const std::out_of_range& exn) {
    PyErr_SetString(PyExc_IndexError, exn.what());
  } catch (const std::overflow_error& exn) {
    PyErr_SetString(PyExc_OverflowError, exn.what());
  } catch (const std::range_error& exn) {
    PyErr_SetString(PyExc_ArithmeticError, exn.what());
  } catch (const std::underflow_error& exn) {
    PyErr_SetString(PyExc_ArithmeticError, exn.what());
  } catch (const std::exception& exn) {
    PyErr_SetString(PyExc_RuntimeError, exn.what());
  }
  catch (...)
  {
    PyErr_SetString(PyExc_RuntimeError, "Unknown exception");
  }
}
#endif

/* CIntFromPy.proto */
static CYTHON_INLINE int __Pyx_PyInt_As_int(PyObject *);

/* PrintOne.proto */
static int __Pyx_PrintOne(PyObject* stream, PyObject *o);

/* CIntFromPy.proto */
static CYTHON_INLINE long __Pyx_PyInt_As_long(PyObject *);

/* CStringEquals.proto */
static CYTHON_INLINE int __Pyx_StrEq(const char *, const char *);

/* CheckBinaryVersion.proto */
static int __Pyx_check_binary_version(void);

/* PyIdentifierFromString.proto */
#if !defined(__Pyx_PyIdentifier_FromString)
#if PY_MAJOR_VERSION < 3
  #define __Pyx_PyIdentifier_FromString(s) PyString_FromString(s)
#else
  #define __Pyx_PyIdentifier_FromString(s) PyUnicode_FromString(s)
#endif
#endif

/* ModuleImport.proto */
static PyObject *__Pyx_ImportModule(const char *name);

/* TypeImport.proto */
static PyTypeObject *__Pyx_ImportType(const char *module_name, const char *class_name, size_t size, int strict);

/* InitStrings.proto */
static int __Pyx_InitStrings(__Pyx_StringTabEntry *t);

static PyObject *__pyx_f_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_run(struct __pyx_obj_8volttron_8platform_3vip_6router_8routercy_BaseRouter *__pyx_v_self, int __pyx_skip_dispatch); /* proto*/
static PyObject *__pyx_f_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_start(struct __pyx_obj_8volttron_8platform_3vip_6router_8routercy_BaseRouter *__pyx_v_self, int __pyx_skip_dispatch); /* proto*/
static PyObject *__pyx_f_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_stop(struct __pyx_obj_8volttron_8platform_3vip_6router_8routercy_BaseRouter *__pyx_v_self, int __pyx_skip_dispatch, struct __pyx_opt_args_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_stop *__pyx_optional_args); /* proto*/
static PyObject *__pyx_f_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_setup(CYTHON_UNUSED struct __pyx_obj_8volttron_8platform_3vip_6router_8routercy_BaseRouter *__pyx_v_self, int __pyx_skip_dispatch); /* proto*/
static PyObject *__pyx_f_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_poll(struct __pyx_obj_8volttron_8platform_3vip_6router_8routercy_BaseRouter *__pyx_v_self, int __pyx_skip_dispatch); /* proto*/
static PyObject *__pyx_f_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_handle_subsystem(CYTHON_UNUSED struct __pyx_obj_8volttron_8platform_3vip_6router_8routercy_BaseRouter *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v_frames, CYTHON_UNUSED PyObject *__pyx_v_user_id, int __pyx_skip_dispatch); /* proto*/
static PyObject *__pyx_f_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_issue(CYTHON_UNUSED struct __pyx_obj_8volttron_8platform_3vip_6router_8routercy_BaseRouter *__pyx_v_self, CYTHON_UNUSED int __pyx_v_topic, CYTHON_UNUSED PyObject *__pyx_v_frames, int __pyx_skip_dispatch, struct __pyx_opt_args_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_issue *__pyx_optional_args); /* proto*/
static PyObject *__pyx_f_8volttron_8platform_3vip_6router_8routercy_10BaseRouter__distribute(struct __pyx_obj_8volttron_8platform_3vip_6router_8routercy_BaseRouter *__pyx_v_self, PyObject *__pyx_v_subsys, PyObject *__pyx_v_cmd, std::string __pyx_v_peer); /* proto*/
static PyObject *__pyx_f_8volttron_8platform_3vip_6router_8routercy_10BaseRouter__add_peer(struct __pyx_obj_8volttron_8platform_3vip_6router_8routercy_BaseRouter *__pyx_v_self, std::string __pyx_v_peer, int __pyx_skip_dispatch); /* proto*/
static PyObject *__pyx_f_8volttron_8platform_3vip_6router_8routercy_10BaseRouter__drop_peer(struct __pyx_obj_8volttron_8platform_3vip_6router_8routercy_BaseRouter *__pyx_v_self, std::string __pyx_v_peer, int __pyx_skip_dispatch); /* proto*/
static PyObject *__pyx_f_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_route(struct __pyx_obj_8volttron_8platform_3vip_6router_8routercy_BaseRouter *__pyx_v_self, int __pyx_skip_dispatch); /* proto*/
static struct __pyx_obj_8volttron_8platform_3vip_6router_5queue_Queue *__pyx_f_8volttron_8platform_3vip_6router_8routercy_10BaseRouter__send(struct __pyx_obj_8volttron_8platform_3vip_6router_8routercy_BaseRouter *__pyx_v_self, struct __pyx_obj_8volttron_8platform_3vip_6router_5queue_Queue *__pyx_v_frames, int __pyx_skip_dispatch); /* proto*/

/* Module declarations from 'libc.string' */

/* Module declarations from 'libcpp.string' */

/* Module declarations from 'libcpp.utility' */

/* Module declarations from 'libcpp.set' */

/* Module declarations from 'libcpp.vector' */

/* Module declarations from 'volttron.platform.vip.router.cqueue' */

/* Module declarations from 'volttron.platform.vip.router.queue' */
static PyTypeObject *__pyx_ptype_8volttron_8platform_3vip_6router_5queue_Queue = 0;

/* Module declarations from 'zmq.backend.cython.context' */
static PyTypeObject *__pyx_ptype_3zmq_7backend_6cython_7context_Context = 0;

/* Module declarations from 'zmq.backend.cython.socket' */
static PyTypeObject *__pyx_ptype_3zmq_7backend_6cython_6socket_Socket = 0;

/* Module declarations from 'volttron.platform.vip.router.cysocket' */
static PyTypeObject *__pyx_ptype_8volttron_8platform_3vip_6router_8cysocket_Socket = 0;

/* Module declarations from 'zmq.utils.buffers' */
static CYTHON_INLINE int __pyx_f_3zmq_5utils_7buffers_memoryview_available(void); /*proto*/
static CYTHON_INLINE int __pyx_f_3zmq_5utils_7buffers_oldstyle_available(void); /*proto*/
static CYTHON_INLINE int __pyx_f_3zmq_5utils_7buffers_check_buffer(PyObject *); /*proto*/
static CYTHON_INLINE PyObject *__pyx_f_3zmq_5utils_7buffers_asbuffer(PyObject *, int, int, void **, Py_ssize_t *, Py_ssize_t *); /*proto*/
static CYTHON_INLINE PyObject *__pyx_f_3zmq_5utils_7buffers_asbuffer_r(PyObject *, void **, Py_ssize_t *); /*proto*/
static CYTHON_INLINE PyObject *__pyx_f_3zmq_5utils_7buffers_frombuffer_3(void *, Py_ssize_t, int); /*proto*/
static CYTHON_INLINE PyObject *__pyx_f_3zmq_5utils_7buffers_frombuffer_2(void *, Py_ssize_t, int); /*proto*/
static CYTHON_INLINE PyObject *__pyx_f_3zmq_5utils_7buffers_frombuffer(void *, Py_ssize_t, int); /*proto*/
static CYTHON_INLINE PyObject *__pyx_f_3zmq_5utils_7buffers_viewfromobject(PyObject *, int); /*proto*/

/* Module declarations from 'cpython.version' */

/* Module declarations from '__builtin__' */

/* Module declarations from 'cpython.type' */
static PyTypeObject *__pyx_ptype_7cpython_4type_type = 0;

/* Module declarations from 'libc.stdio' */

/* Module declarations from 'cpython.object' */

/* Module declarations from 'cpython.ref' */

/* Module declarations from 'cpython.exc' */

/* Module declarations from 'cpython.module' */

/* Module declarations from 'cpython.mem' */

/* Module declarations from 'cpython.tuple' */

/* Module declarations from 'cpython.list' */

/* Module declarations from 'cpython.sequence' */

/* Module declarations from 'cpython.mapping' */

/* Module declarations from 'cpython.iterator' */

/* Module declarations from 'cpython.number' */

/* Module declarations from 'cpython.int' */

/* Module declarations from '__builtin__' */

/* Module declarations from 'cpython.bool' */
static PyTypeObject *__pyx_ptype_7cpython_4bool_bool = 0;

/* Module declarations from 'cpython.long' */

/* Module declarations from 'cpython.float' */

/* Module declarations from '__builtin__' */

/* Module declarations from 'cpython.complex' */
static PyTypeObject *__pyx_ptype_7cpython_7complex_complex = 0;

/* Module declarations from 'cpython.string' */

/* Module declarations from 'cpython.unicode' */

/* Module declarations from 'cpython.dict' */

/* Module declarations from 'cpython.instance' */

/* Module declarations from 'cpython.function' */

/* Module declarations from 'cpython.method' */

/* Module declarations from 'cpython.weakref' */

/* Module declarations from 'cpython.getargs' */

/* Module declarations from 'cpython.pythread' */

/* Module declarations from 'cpython.pystate' */

/* Module declarations from 'cpython.cobject' */

/* Module declarations from 'cpython.oldbuffer' */

/* Module declarations from 'cpython.set' */

/* Module declarations from 'cpython.buffer' */

/* Module declarations from 'cpython.bytes' */

/* Module declarations from 'cpython.pycapsule' */

/* Module declarations from 'cpython' */

/* Module declarations from 'zmq.backend.cython.libzmq' */

/* Module declarations from 'volttron.platform.vip.router.cymessage' */
static PyTypeObject *__pyx_ptype_8volttron_8platform_3vip_6router_9cymessage_Frame = 0;

/* Module declarations from 'volttron.platform.vip.router.routercy' */
static PyTypeObject *__pyx_ptype_8volttron_8platform_3vip_6router_8routercy_BaseRouter = 0;
static std::string __pyx_convert_string_from_py_std__in_string(PyObject *); /*proto*/
static CYTHON_INLINE PyObject *__pyx_convert_PyObject_string_to_py_std__in_string(std::string const &); /*proto*/
static CYTHON_INLINE PyObject *__pyx_convert_PyUnicode_string_to_py_std__in_string(std::string const &); /*proto*/
static CYTHON_INLINE PyObject *__pyx_convert_PyStr_string_to_py_std__in_string(std::string const &); /*proto*/
static CYTHON_INLINE PyObject *__pyx_convert_PyBytes_string_to_py_std__in_string(std::string const &); /*proto*/
static CYTHON_INLINE PyObject *__pyx_convert_PyByteArray_string_to_py_std__in_string(std::string const &); /*proto*/
static std::vector<std::string>  __pyx_convert_vector_from_py_std_3a__3a_string(PyObject *); /*proto*/
static PyObject *__pyx_convert_set_to_py_std_3a__3a_string(std::set<std::string>  const &); /*proto*/
#define __Pyx_MODULE_NAME "volttron.platform.vip.router.routercy"
int __pyx_module_is_main_volttron__platform__vip__router__routercy = 0;

/* Implementation of 'volttron.platform.vip.router.routercy' */
static PyObject *__pyx_builtin_NotImplementedError;
static PyObject *__pyx_builtin_IndexError;
static PyObject *__pyx_builtin_KeyError;
static PyObject *__pyx_builtin_TypeError;
static PyObject *__pyx_builtin_AttributeError;
static const char __pyx_k_B[] = "B";
static const char __pyx_k_at[] = "at";
static const char __pyx_k_os[] = "os";
static const char __pyx_k_1_0[] = "1.0";
static const char __pyx_k_VIP[] = "VIP";
static const char __pyx_k__10[] = "";
static const char __pyx_k__22[] = "*";
static const char __pyx_k_add[] = "add";
static const char __pyx_k_end[] = "end";
static const char __pyx_k_get[] = "get";
static const char __pyx_k_run[] = "run";
static const char __pyx_k_sys[] = "sys";
static const char __pyx_k_zmq[] = "zmq";
static const char __pyx_k_VIP1[] = "VIP1";
static const char __pyx_k_char[] = "char";
static const char __pyx_k_copy[] = "copy";
static const char __pyx_k_drop[] = "drop";
static const char __pyx_k_file[] = "file";
static const char __pyx_k_list[] = "list";
static const char __pyx_k_main[] = "__main__";
static const char __pyx_k_ping[] = "ping";
static const char __pyx_k_poll[] = "poll";
static const char __pyx_k_pong[] = "pong";
static const char __pyx_k_send[] = "_send";
static const char __pyx_k_size[] = "size";
static const char __pyx_k_stop[] = "stop";
static const char __pyx_k_test[] = "__test__";
static const char __pyx_k_uuid[] = "uuid";
static const char __pyx_k_DEBUG[] = "DEBUG";
static const char __pyx_k_ERROR[] = "ERROR";
static const char __pyx_k_ascii[] = "ascii";
static const char __pyx_k_bytes[] = "bytes";
static const char __pyx_k_clear[] = "clear";
static const char __pyx_k_close[] = "close";
static const char __pyx_k_dtype[] = "dtype";
static const char __pyx_k_empty[] = "empty";
static const char __pyx_k_errno[] = "errno";
static const char __pyx_k_error[] = "error";
static const char __pyx_k_extra[] = "extra";
static const char __pyx_k_flags[] = "flags";
static const char __pyx_k_hello[] = "hello";
static const char __pyx_k_issue[] = "issue";
static const char __pyx_k_level[] = "level";
static const char __pyx_k_print[] = "print";
static const char __pyx_k_route[] = "route";
static const char __pyx_k_setup[] = "setup";
static const char __pyx_k_start[] = "start";
static const char __pyx_k_topic[] = "topic";
static const char __pyx_k_utf_8[] = "utf-8";
static const char __pyx_k_EINVAL[] = "EINVAL";
static const char __pyx_k_NOTSET[] = "NOTSET";
static const char __pyx_k_ROUTER[] = "ROUTER";
static const char __pyx_k_decode[] = "decode";
static const char __pyx_k_encode[] = "encode";
static const char __pyx_k_extend[] = "extend";
static const char __pyx_k_frames[] = "frames";
static const char __pyx_k_import[] = "__import__";
static const char __pyx_k_linger[] = "linger";
static const char __pyx_k_sender[] = "sender";
static const char __pyx_k_Context[] = "Context";
static const char __pyx_k_NOBLOCK[] = "NOBLOCK";
static const char __pyx_k_User_Id[] = "User-Id";
static const char __pyx_k_context[] = "context";
static const char __pyx_k_listing[] = "listing";
static const char __pyx_k_logging[] = "logging";
static const char __pyx_k_missing[] = "missing";
static const char __pyx_k_unknown[] = "unknown";
static const char __pyx_k_user_id[] = "user_id";
static const char __pyx_k_welcome[] = "welcome";
static const char __pyx_k_INCOMING[] = "INCOMING";
static const char __pyx_k_KeyError[] = "KeyError";
static const char __pyx_k_OUTGOING[] = "OUTGOING";
static const char __pyx_k_ZMQError[] = "ZMQError";
static const char __pyx_k_add_peer[] = "_add_peer";
static const char __pyx_k_handlers[] = "handlers";
static const char __pyx_k_instance[] = "instance";
static const char __pyx_k_itemsize[] = "itemsize";
static const char __pyx_k_peerlist[] = "peerlist";
static const char __pyx_k_setLevel[] = "setLevel";
static const char __pyx_k_sndtimeo[] = "sndtimeo";
static const char __pyx_k_typecode[] = "typecode";
static const char __pyx_k_TypeError[] = "TypeError";
static const char __pyx_k_drop_peer[] = "_drop_peer";
static const char __pyx_k_getLogger[] = "getLogger";
static const char __pyx_k_operation[] = " operation";
static const char __pyx_k_recipient[] = "recipient";
static const char __pyx_k_zmq_utils[] = "zmq.utils";
static const char __pyx_k_IndexError[] = "IndexError";
static const char __pyx_k_UNROUTABLE[] = "UNROUTABLE";
static const char __pyx_k_auth_token[] = "auth_token";
static const char __pyx_k_pyx_vtable[] = "__pyx_vtable__";
static const char __pyx_k_EHOSTUNREACH[] = "EHOSTUNREACH";
static const char __pyx_k_ROUTE_ERRORS[] = "_ROUTE_ERRORS";
static const char __pyx_k_router_probe[] = "router probe";
static const char __pyx_k_socket_class[] = "_socket_class";
static const char __pyx_k_tcp_keepalive[] = "tcp_keepalive";
static const char __pyx_k_AttributeError[] = "AttributeError";
static const char __pyx_k_BaseRouter_run[] = "BaseRouter run";
static const char __pyx_k_logging_config[] = "logging.config";
static const char __pyx_k_recv_multipart[] = "recv_multipart";
static const char __pyx_k_send_multipart[] = "send_multipart";
static const char __pyx_k_too_few_frames[] = "too few frames";
static const char __pyx_k_BaseRouter_stop[] = "BaseRouter stop()";
static const char __pyx_k_default_user_id[] = "default_user_id";
static const char __pyx_k_BaseRouter_cinit[] = "BaseRouter cinit";
static const char __pyx_k_BaseRouter_start[] = "BaseRouter start()";
static const char __pyx_k_handle_subsystem[] = "handle_subsystem";
static const char __pyx_k_router_mandatory[] = "router_mandatory";
static const char __pyx_k_zmq_version_info[] = "zmq_version_info";
static const char __pyx_k_INVALID_SUBSYSTEM[] = "_INVALID_SUBSYSTEM";
static const char __pyx_k_bad_VIP_signature[] = "bad VIP signature";
static const char __pyx_k_cython_baserouter[] = "cython.baserouter";
static const char __pyx_k_tcp_keepalive_cnt[] = "tcp_keepalive_cnt";
static const char __pyx_k_tcp_keepalive_idle[] = "tcp_keepalive_idle";
static const char __pyx_k_NotImplementedError[] = "NotImplementedError";
static const char __pyx_k_tcp_keepalive_intvl[] = "tcp_keepalive_intvl";
static const char __pyx_k_Old_style_buffers_not_available[] = "Old style buffers not available.";
static const char __pyx_k_r_does_not_provide_a_buffer_int[] = "%r does not provide a buffer interface.";
static PyObject *__pyx_kp_b_1_0;
static PyObject *__pyx_n_s_AttributeError;
static PyObject *__pyx_n_b_B;
static PyObject *__pyx_kp_s_BaseRouter_cinit;
static PyObject *__pyx_kp_s_BaseRouter_run;
static PyObject *__pyx_kp_s_BaseRouter_start;
static PyObject *__pyx_kp_s_BaseRouter_stop;
static PyObject *__pyx_n_s_Context;
static PyObject *__pyx_n_s_DEBUG;
static PyObject *__pyx_n_s_EHOSTUNREACH;
static PyObject *__pyx_n_s_EINVAL;
static PyObject *__pyx_n_s_ERROR;
static PyObject *__pyx_n_s_INCOMING;
static PyObject *__pyx_n_s_INVALID_SUBSYSTEM;
static PyObject *__pyx_n_s_IndexError;
static PyObject *__pyx_n_s_KeyError;
static PyObject *__pyx_n_s_NOBLOCK;
static PyObject *__pyx_n_s_NOTSET;
static PyObject *__pyx_n_s_NotImplementedError;
static PyObject *__pyx_n_s_OUTGOING;
static PyObject *__pyx_kp_s_Old_style_buffers_not_available;
static PyObject *__pyx_n_s_ROUTER;
static PyObject *__pyx_n_s_ROUTE_ERRORS;
static PyObject *__pyx_n_s_TypeError;
static PyObject *__pyx_n_s_UNROUTABLE;
static PyObject *__pyx_kp_s_User_Id;
static PyObject *__pyx_n_b_VIP;
static PyObject *__pyx_n_b_VIP1;
static PyObject *__pyx_n_s_ZMQError;
static PyObject *__pyx_kp_b__10;
static PyObject *__pyx_kp_s__10;
static PyObject *__pyx_n_s__22;
static PyObject *__pyx_n_b_add;
static PyObject *__pyx_n_s_add_peer;
static PyObject *__pyx_n_s_ascii;
static PyObject *__pyx_n_s_at;
static PyObject *__pyx_n_s_auth_token;
static PyObject *__pyx_kp_s_bad_VIP_signature;
static PyObject *__pyx_n_s_bytes;
static PyObject *__pyx_n_s_char;
static PyObject *__pyx_n_s_clear;
static PyObject *__pyx_n_s_close;
static PyObject *__pyx_n_s_context;
static PyObject *__pyx_n_s_copy;
static PyObject *__pyx_kp_s_cython_baserouter;
static PyObject *__pyx_n_s_decode;
static PyObject *__pyx_n_s_default_user_id;
static PyObject *__pyx_n_b_drop;
static PyObject *__pyx_n_s_drop_peer;
static PyObject *__pyx_n_s_dtype;
static PyObject *__pyx_n_s_empty;
static PyObject *__pyx_n_s_encode;
static PyObject *__pyx_n_s_end;
static PyObject *__pyx_n_s_errno;
static PyObject *__pyx_n_b_error;
static PyObject *__pyx_n_s_extend;
static PyObject *__pyx_n_s_extra;
static PyObject *__pyx_n_s_file;
static PyObject *__pyx_n_s_flags;
static PyObject *__pyx_n_s_frames;
static PyObject *__pyx_n_s_get;
static PyObject *__pyx_n_s_getLogger;
static PyObject *__pyx_n_s_handle_subsystem;
static PyObject *__pyx_n_s_handlers;
static PyObject *__pyx_n_b_hello;
static PyObject *__pyx_n_s_import;
static PyObject *__pyx_n_s_instance;
static PyObject *__pyx_n_s_issue;
static PyObject *__pyx_n_s_itemsize;
static PyObject *__pyx_n_s_level;
static PyObject *__pyx_n_s_linger;
static PyObject *__pyx_n_b_list;
static PyObject *__pyx_n_b_listing;
static PyObject *__pyx_n_s_logging;
static PyObject *__pyx_n_s_logging_config;
static PyObject *__pyx_n_s_main;
static PyObject *__pyx_n_b_missing;
static PyObject *__pyx_kp_b_operation;
static PyObject *__pyx_n_s_os;
static PyObject *__pyx_n_b_peerlist;
static PyObject *__pyx_n_b_ping;
static PyObject *__pyx_n_s_poll;
static PyObject *__pyx_n_b_pong;
static PyObject *__pyx_n_s_print;
static PyObject *__pyx_n_s_pyx_vtable;
static PyObject *__pyx_kp_s_r_does_not_provide_a_buffer_int;
static PyObject *__pyx_n_s_recipient;
static PyObject *__pyx_n_s_recv_multipart;
static PyObject *__pyx_n_s_route;
static PyObject *__pyx_n_s_router_mandatory;
static PyObject *__pyx_kp_s_router_probe;
static PyObject *__pyx_n_s_run;
static PyObject *__pyx_n_s_send;
static PyObject *__pyx_n_s_send_multipart;
static PyObject *__pyx_n_s_sender;
static PyObject *__pyx_n_s_setLevel;
static PyObject *__pyx_n_s_setup;
static PyObject *__pyx_n_s_size;
static PyObject *__pyx_n_s_sndtimeo;
static PyObject *__pyx_n_s_socket_class;
static PyObject *__pyx_n_s_start;
static PyObject *__pyx_n_s_stop;
static PyObject *__pyx_n_s_sys;
static PyObject *__pyx_n_s_tcp_keepalive;
static PyObject *__pyx_n_s_tcp_keepalive_cnt;
static PyObject *__pyx_n_s_tcp_keepalive_idle;
static PyObject *__pyx_n_s_tcp_keepalive_intvl;
static PyObject *__pyx_n_s_test;
static PyObject *__pyx_kp_s_too_few_frames;
static PyObject *__pyx_n_s_topic;
static PyObject *__pyx_n_s_typecode;
static PyObject *__pyx_n_b_unknown;
static PyObject *__pyx_n_s_user_id;
static PyObject *__pyx_kp_s_utf_8;
static PyObject *__pyx_n_s_uuid;
static PyObject *__pyx_n_b_welcome;
static PyObject *__pyx_n_s_zmq;
static PyObject *__pyx_n_s_zmq_utils;
static PyObject *__pyx_n_s_zmq_version_info;
static int __pyx_pf_8volttron_8platform_3vip_6router_8routercy_10BaseRouter___cinit__(struct __pyx_obj_8volttron_8platform_3vip_6router_8routercy_BaseRouter *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v_context, CYTHON_UNUSED PyObject *__pyx_v_default_user_id, PyObject *__pyx_v_kwargs); /* proto */
static PyObject *__pyx_pf_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_2run(struct __pyx_obj_8volttron_8platform_3vip_6router_8routercy_BaseRouter *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_4start(struct __pyx_obj_8volttron_8platform_3vip_6router_8routercy_BaseRouter *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_6stop(struct __pyx_obj_8volttron_8platform_3vip_6router_8routercy_BaseRouter *__pyx_v_self, int __pyx_v_linger); /* proto */
static PyObject *__pyx_pf_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_8setup(struct __pyx_obj_8volttron_8platform_3vip_6router_8routercy_BaseRouter *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_10poll(struct __pyx_obj_8volttron_8platform_3vip_6router_8routercy_BaseRouter *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_12handle_subsystem(struct __pyx_obj_8volttron_8platform_3vip_6router_8routercy_BaseRouter *__pyx_v_self, PyObject *__pyx_v_frames, PyObject *__pyx_v_user_id); /* proto */
static PyObject *__pyx_pf_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_14issue(struct __pyx_obj_8volttron_8platform_3vip_6router_8routercy_BaseRouter *__pyx_v_self, int __pyx_v_topic, PyObject *__pyx_v_frames, PyObject *__pyx_v_extra); /* proto */
static PyObject *__pyx_pf_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_16lookup_user_id(struct __pyx_obj_8volttron_8platform_3vip_6router_8routercy_BaseRouter *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v_sender, PyObject *__pyx_v_recipient, CYTHON_UNUSED PyObject *__pyx_v_auth_token); /* proto */
static PyObject *__pyx_pf_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_18lookup_user_id(struct __pyx_obj_8volttron_8platform_3vip_6router_8routercy_BaseRouter *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v_sender, CYTHON_UNUSED PyObject *__pyx_v_recipient, CYTHON_UNUSED PyObject *__pyx_v_auth_token); /* proto */
static PyObject *__pyx_pf_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_20_add_peer(struct __pyx_obj_8volttron_8platform_3vip_6router_8routercy_BaseRouter *__pyx_v_self, std::string __pyx_v_peer); /* proto */
static PyObject *__pyx_pf_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_22_drop_peer(struct __pyx_obj_8volttron_8platform_3vip_6router_8routercy_BaseRouter *__pyx_v_self, std::string __pyx_v_peer); /* proto */
static PyObject *__pyx_pf_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_24route(struct __pyx_obj_8volttron_8platform_3vip_6router_8routercy_BaseRouter *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_26_send(struct __pyx_obj_8volttron_8platform_3vip_6router_8routercy_BaseRouter *__pyx_v_self, struct __pyx_obj_8volttron_8platform_3vip_6router_5queue_Queue *__pyx_v_frames); /* proto */
static PyObject *__pyx_tp_new_8volttron_8platform_3vip_6router_8routercy_BaseRouter(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
static PyObject *__pyx_int_0;
static PyObject *__pyx_int_1;
static PyObject *__pyx_int_2;
static PyObject *__pyx_int_3;
static PyObject *__pyx_int_4;
static PyObject *__pyx_int_6;
static PyObject *__pyx_int_20;
static PyObject *__pyx_int_180;
static PyObject *__pyx_tuple_;
static PyObject *__pyx_tuple__2;
static PyObject *__pyx_tuple__3;
static PyObject *__pyx_tuple__4;
static PyObject *__pyx_tuple__5;
static PyObject *__pyx_tuple__6;
static PyObject *__pyx_tuple__7;
static PyObject *__pyx_tuple__8;
static PyObject *__pyx_tuple__9;
static PyObject *__pyx_slice__18;
static PyObject *__pyx_tuple__11;
static PyObject *__pyx_tuple__12;
static PyObject *__pyx_tuple__13;
static PyObject *__pyx_tuple__14;
static PyObject *__pyx_tuple__15;
static PyObject *__pyx_tuple__16;
static PyObject *__pyx_tuple__17;
static PyObject *__pyx_tuple__19;
static PyObject *__pyx_tuple__20;
static PyObject *__pyx_tuple__21;
static PyObject *__pyx_tuple__23;

/* "volttron/platform/vip/router/routercy.pyx":45
 *     _socket_class = CySocket
 * 
 *     def __cinit__(self, context=None, default_user_id=None, **kwargs):             # <<<<<<<<<<<<<<
 *         '''Initialize the object instance.
 * 
 */

/* Python wrapper */
static int __pyx_pw_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  CYTHON_UNUSED PyObject *__pyx_v_context = 0;
  CYTHON_UNUSED PyObject *__pyx_v_default_user_id = 0;
  PyObject *__pyx_v_kwargs = 0;
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__cinit__ (wrapper)", 0);
  __pyx_v_kwargs = PyDict_New(); if (unlikely(!__pyx_v_kwargs)) return -1;
  __Pyx_GOTREF(__pyx_v_kwargs);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_context,&__pyx_n_s_default_user_id,0};
    PyObject* values[2] = {0,0};
    values[0] = ((PyObject *)Py_None);
    values[1] = ((PyObject *)Py_None);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (kw_args > 0) {
          PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_context);
          if (value) { values[0] = value; kw_args--; }
        }
        case  1:
        if (kw_args > 0) {
          PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_default_user_id);
          if (value) { values[1] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, __pyx_v_kwargs, values, pos_args, "__cinit__") < 0)) __PYX_ERR(0, 45, __pyx_L3_error)
      }
    } else {
      switch (PyTuple_GET_SIZE(__pyx_args)) {
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_context = values[0];
    __pyx_v_default_user_id = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("__cinit__", 0, 0, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 45, __pyx_L3_error)
  __pyx_L3_error:;
  __Pyx_DECREF(__pyx_v_kwargs); __pyx_v_kwargs = 0;
  __Pyx_AddTraceback("volttron.platform.vip.router.routercy.BaseRouter.__cinit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_8volttron_8platform_3vip_6router_8routercy_10BaseRouter___cinit__(((struct __pyx_obj_8volttron_8platform_3vip_6router_8routercy_BaseRouter *)__pyx_v_self), __pyx_v_context, __pyx_v_default_user_id, __pyx_v_kwargs);

  /* function exit code */
  __Pyx_XDECREF(__pyx_v_kwargs);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static int __pyx_pf_8volttron_8platform_3vip_6router_8routercy_10BaseRouter___cinit__(struct __pyx_obj_8volttron_8platform_3vip_6router_8routercy_BaseRouter *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v_context, CYTHON_UNUSED PyObject *__pyx_v_default_user_id, PyObject *__pyx_v_kwargs) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  int __pyx_t_4;
  int __pyx_t_5;
  PyObject *__pyx_t_6 = NULL;
  PyObject *__pyx_t_7 = NULL;
  __Pyx_RefNannySetupContext("__cinit__", 0);

  /* "volttron/platform/vip/router/routercy.pyx":51
 *         used for socket creation.
 *         '''
 *         print("BaseRouter cinit")             # <<<<<<<<<<<<<<
 *         self.context = zmq.Context.instance()
 *         if 'default_user_id' in kwargs:
 */
  if (__Pyx_PrintOne(0, __pyx_kp_s_BaseRouter_cinit) < 0) __PYX_ERR(0, 51, __pyx_L1_error)

  /* "volttron/platform/vip/router/routercy.pyx":52
 *         '''
 *         print("BaseRouter cinit")
 *         self.context = zmq.Context.instance()             # <<<<<<<<<<<<<<
 *         if 'default_user_id' in kwargs:
 *             self.default_user_id = kwargs['default_user_id']
 */
  __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_zmq); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 52, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_Context); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 52, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_instance); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 52, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
    }
  }
  if (__pyx_t_3) {
    __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 52, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  } else {
    __pyx_t_1 = __Pyx_PyObject_CallNoArg(__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 52, __pyx_L1_error)
  }
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __Pyx_GIVEREF(__pyx_t_1);
  __Pyx_GOTREF(__pyx_v_self->context);
  __Pyx_DECREF(__pyx_v_self->context);
  __pyx_v_self->context = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "volttron/platform/vip/router/routercy.pyx":53
 *         print("BaseRouter cinit")
 *         self.context = zmq.Context.instance()
 *         if 'default_user_id' in kwargs:             # <<<<<<<<<<<<<<
 *             self.default_user_id = kwargs['default_user_id']
 *         else:
 */
  __pyx_t_4 = (__Pyx_PyDict_ContainsTF(__pyx_n_s_default_user_id, __pyx_v_kwargs, Py_EQ)); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 53, __pyx_L1_error)
  __pyx_t_5 = (__pyx_t_4 != 0);
  if (__pyx_t_5) {

    /* "volttron/platform/vip/router/routercy.pyx":54
 *         self.context = zmq.Context.instance()
 *         if 'default_user_id' in kwargs:
 *             self.default_user_id = kwargs['default_user_id']             # <<<<<<<<<<<<<<
 *         else:
 *             self.default_user_id = None
 */
    __pyx_t_1 = __Pyx_PyDict_GetItem(__pyx_v_kwargs, __pyx_n_s_default_user_id); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 54, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_GIVEREF(__pyx_t_1);
    __Pyx_GOTREF(__pyx_v_self->default_user_id);
    __Pyx_DECREF(__pyx_v_self->default_user_id);
    __pyx_v_self->default_user_id = __pyx_t_1;
    __pyx_t_1 = 0;

    /* "volttron/platform/vip/router/routercy.pyx":53
 *         print("BaseRouter cinit")
 *         self.context = zmq.Context.instance()
 *         if 'default_user_id' in kwargs:             # <<<<<<<<<<<<<<
 *             self.default_user_id = kwargs['default_user_id']
 *         else:
 */
    goto __pyx_L3;
  }

  /* "volttron/platform/vip/router/routercy.pyx":56
 *             self.default_user_id = kwargs['default_user_id']
 *         else:
 *             self.default_user_id = None             # <<<<<<<<<<<<<<
 *         self.logger = logging.getLogger('cython.baserouter')
 *         if self.logger.level == logging.NOTSET:
 */
  /*else*/ {
    __Pyx_INCREF(Py_None);
    __Pyx_GIVEREF(Py_None);
    __Pyx_GOTREF(__pyx_v_self->default_user_id);
    __Pyx_DECREF(__pyx_v_self->default_user_id);
    __pyx_v_self->default_user_id = Py_None;
  }
  __pyx_L3:;

  /* "volttron/platform/vip/router/routercy.pyx":57
 *         else:
 *             self.default_user_id = None
 *         self.logger = logging.getLogger('cython.baserouter')             # <<<<<<<<<<<<<<
 *         if self.logger.level == logging.NOTSET:
 *             self.logger.setLevel(logging.DEBUG)
 */
  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_logging); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 57, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_getLogger); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 57, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_tuple_, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 57, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __Pyx_GIVEREF(__pyx_t_1);
  __Pyx_GOTREF(__pyx_v_self->logger);
  __Pyx_DECREF(__pyx_v_self->logger);
  __pyx_v_self->logger = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "volttron/platform/vip/router/routercy.pyx":58
 *             self.default_user_id = None
 *         self.logger = logging.getLogger('cython.baserouter')
 *         if self.logger.level == logging.NOTSET:             # <<<<<<<<<<<<<<
 *             self.logger.setLevel(logging.DEBUG)
 *         self.OUTGOING = 0
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->logger, __pyx_n_s_level); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 58, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_logging); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 58, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_NOTSET); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 58, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = PyObject_RichCompare(__pyx_t_1, __pyx_t_3, Py_EQ); __Pyx_XGOTREF(__pyx_t_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 58, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 58, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  if (__pyx_t_5) {

    /* "volttron/platform/vip/router/routercy.pyx":59
 *         self.logger = logging.getLogger('cython.baserouter')
 *         if self.logger.level == logging.NOTSET:
 *             self.logger.setLevel(logging.DEBUG)             # <<<<<<<<<<<<<<
 *         self.OUTGOING = 0
 *         self.INCOMING = 1
 */
    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->logger, __pyx_n_s_setLevel); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 59, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_logging); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 59, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_DEBUG); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 59, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_3))) {
      __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_3);
      if (likely(__pyx_t_1)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
        __Pyx_INCREF(__pyx_t_1);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_3, function);
      }
    }
    if (!__pyx_t_1) {
      __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_6); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 59, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
      __Pyx_GOTREF(__pyx_t_2);
    } else {
      __pyx_t_7 = PyTuple_New(1+1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 59, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_7);
      __Pyx_GIVEREF(__pyx_t_1); PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_1); __pyx_t_1 = NULL;
      __Pyx_GIVEREF(__pyx_t_6);
      PyTuple_SET_ITEM(__pyx_t_7, 0+1, __pyx_t_6);
      __pyx_t_6 = 0;
      __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_7, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 59, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
    }
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

    /* "volttron/platform/vip/router/routercy.pyx":58
 *             self.default_user_id = None
 *         self.logger = logging.getLogger('cython.baserouter')
 *         if self.logger.level == logging.NOTSET:             # <<<<<<<<<<<<<<
 *             self.logger.setLevel(logging.DEBUG)
 *         self.OUTGOING = 0
 */
  }

  /* "volttron/platform/vip/router/routercy.pyx":60
 *         if self.logger.level == logging.NOTSET:
 *             self.logger.setLevel(logging.DEBUG)
 *         self.OUTGOING = 0             # <<<<<<<<<<<<<<
 *         self.INCOMING = 1
 *         self.UNROUTABLE = 2
 */
  __pyx_v_self->OUTGOING = 0;

  /* "volttron/platform/vip/router/routercy.pyx":61
 *             self.logger.setLevel(logging.DEBUG)
 *         self.OUTGOING = 0
 *         self.INCOMING = 1             # <<<<<<<<<<<<<<
 *         self.UNROUTABLE = 2
 *         self.ERROR = 3
 */
  __pyx_v_self->INCOMING = 1;

  /* "volttron/platform/vip/router/routercy.pyx":62
 *         self.OUTGOING = 0
 *         self.INCOMING = 1
 *         self.UNROUTABLE = 2             # <<<<<<<<<<<<<<
 *         self.ERROR = 3
 * 
 */
  __pyx_v_self->UNROUTABLE = 2;

  /* "volttron/platform/vip/router/routercy.pyx":63
 *         self.INCOMING = 1
 *         self.UNROUTABLE = 2
 *         self.ERROR = 3             # <<<<<<<<<<<<<<
 * 
 *     cpdef run(self):
 */
  __pyx_v_self->ERROR = 3;

  /* "volttron/platform/vip/router/routercy.pyx":45
 *     _socket_class = CySocket
 * 
 *     def __cinit__(self, context=None, default_user_id=None, **kwargs):             # <<<<<<<<<<<<<<
 *         '''Initialize the object instance.
 * 
 */

  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_AddTraceback("volttron.platform.vip.router.routercy.BaseRouter.__cinit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "volttron/platform/vip/router/routercy.pyx":65
 *         self.ERROR = 3
 * 
 *     cpdef run(self):             # <<<<<<<<<<<<<<
 *         '''Main router loop.'''
 *         print("BaseRouter run")
 */

static PyObject *__pyx_pw_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_3run(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyObject *__pyx_f_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_run(struct __pyx_obj_8volttron_8platform_3vip_6router_8routercy_BaseRouter *__pyx_v_self, int __pyx_skip_dispatch) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  int __pyx_t_5;
  int __pyx_t_6;
  int __pyx_t_7;
  char const *__pyx_t_8;
  PyObject *__pyx_t_9 = NULL;
  PyObject *__pyx_t_10 = NULL;
  PyObject *__pyx_t_11 = NULL;
  PyObject *__pyx_t_12 = NULL;
  PyObject *__pyx_t_13 = NULL;
  PyObject *__pyx_t_14 = NULL;
  __Pyx_RefNannySetupContext("run", 0);
  /* Check if called by wrapper */
  if (unlikely(__pyx_skip_dispatch)) ;
  /* Check if overridden in Python */
  else if (unlikely(Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0)) {
    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_run); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 65, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)__pyx_pw_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_3run)) {
      __Pyx_XDECREF(__pyx_r);
      __Pyx_INCREF(__pyx_t_1);
      __pyx_t_3 = __pyx_t_1; __pyx_t_4 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_3))) {
        __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
        if (likely(__pyx_t_4)) {
          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
          __Pyx_INCREF(__pyx_t_4);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_3, function);
        }
      }
      if (__pyx_t_4) {
        __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 65, __pyx_L1_error)
        __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      } else {
        __pyx_t_2 = __Pyx_PyObject_CallNoArg(__pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 65, __pyx_L1_error)
      }
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_r = __pyx_t_2;
      __pyx_t_2 = 0;
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      goto __pyx_L0;
    }
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  }

  /* "volttron/platform/vip/router/routercy.pyx":67
 *     cpdef run(self):
 *         '''Main router loop.'''
 *         print("BaseRouter run")             # <<<<<<<<<<<<<<
 *         self.start()
 *         try:
 */
  if (__Pyx_PrintOne(0, __pyx_kp_s_BaseRouter_run) < 0) __PYX_ERR(0, 67, __pyx_L1_error)

  /* "volttron/platform/vip/router/routercy.pyx":68
 *         '''Main router loop.'''
 *         print("BaseRouter run")
 *         self.start()             # <<<<<<<<<<<<<<
 *         try:
 *             while self.poll():
 */
  __pyx_t_1 = ((struct __pyx_vtabstruct_8volttron_8platform_3vip_6router_8routercy_BaseRouter *)__pyx_v_self->__pyx_vtab)->start(__pyx_v_self, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 68, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "volttron/platform/vip/router/routercy.pyx":69
 *         print("BaseRouter run")
 *         self.start()
 *         try:             # <<<<<<<<<<<<<<
 *             while self.poll():
 *                 self.route()
 */
  /*try:*/ {

    /* "volttron/platform/vip/router/routercy.pyx":70
 *         self.start()
 *         try:
 *             while self.poll():             # <<<<<<<<<<<<<<
 *                 self.route()
 *         finally:
 */
    while (1) {
      __pyx_t_1 = ((struct __pyx_vtabstruct_8volttron_8platform_3vip_6router_8routercy_BaseRouter *)__pyx_v_self->__pyx_vtab)->poll(__pyx_v_self, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 70, __pyx_L4_error)
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 70, __pyx_L4_error)
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      if (!__pyx_t_5) break;

      /* "volttron/platform/vip/router/routercy.pyx":71
 *         try:
 *             while self.poll():
 *                 self.route()             # <<<<<<<<<<<<<<
 *         finally:
 *             print("BaseRouter stop()")
 */
      __pyx_t_1 = ((struct __pyx_vtabstruct_8volttron_8platform_3vip_6router_8routercy_BaseRouter *)__pyx_v_self->__pyx_vtab)->route(__pyx_v_self, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 71, __pyx_L4_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    }
  }

  /* "volttron/platform/vip/router/routercy.pyx":73
 *                 self.route()
 *         finally:
 *             print("BaseRouter stop()")             # <<<<<<<<<<<<<<
 *             self.stop()
 * 
 */
  /*finally:*/ {
    /*normal exit:*/{
      if (__Pyx_PrintOne(0, __pyx_kp_s_BaseRouter_stop) < 0) __PYX_ERR(0, 73, __pyx_L1_error)

      /* "volttron/platform/vip/router/routercy.pyx":74
 *         finally:
 *             print("BaseRouter stop()")
 *             self.stop()             # <<<<<<<<<<<<<<
 * 
 *     cpdef start(self):
 */
      __pyx_t_1 = ((struct __pyx_vtabstruct_8volttron_8platform_3vip_6router_8routercy_BaseRouter *)__pyx_v_self->__pyx_vtab)->stop(__pyx_v_self, 0, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 74, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      goto __pyx_L5;
    }
    /*exception exit:*/{
      __Pyx_PyThreadState_declare
      __pyx_L4_error:;
      __pyx_t_9 = 0; __pyx_t_10 = 0; __pyx_t_11 = 0; __pyx_t_12 = 0; __pyx_t_13 = 0; __pyx_t_14 = 0;
      __Pyx_PyThreadState_assign
      __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
      __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
      __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
      __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
      if (PY_MAJOR_VERSION >= 3) __Pyx_ExceptionSwap(&__pyx_t_12, &__pyx_t_13, &__pyx_t_14);
      if ((PY_MAJOR_VERSION < 3) || unlikely(__Pyx_GetException(&__pyx_t_9, &__pyx_t_10, &__pyx_t_11) < 0)) __Pyx_ErrFetch(&__pyx_t_9, &__pyx_t_10, &__pyx_t_11);
      __Pyx_XGOTREF(__pyx_t_9);
      __Pyx_XGOTREF(__pyx_t_10);
      __Pyx_XGOTREF(__pyx_t_11);
      __Pyx_XGOTREF(__pyx_t_12);
      __Pyx_XGOTREF(__pyx_t_13);
      __Pyx_XGOTREF(__pyx_t_14);
      __pyx_t_6 = __pyx_lineno; __pyx_t_7 = __pyx_clineno; __pyx_t_8 = __pyx_filename;
      {

        /* "volttron/platform/vip/router/routercy.pyx":73
 *                 self.route()
 *         finally:
 *             print("BaseRouter stop()")             # <<<<<<<<<<<<<<
 *             self.stop()
 * 
 */
        if (__Pyx_PrintOne(0, __pyx_kp_s_BaseRouter_stop) < 0) __PYX_ERR(0, 73, __pyx_L9_error)

        /* "volttron/platform/vip/router/routercy.pyx":74
 *         finally:
 *             print("BaseRouter stop()")
 *             self.stop()             # <<<<<<<<<<<<<<
 * 
 *     cpdef start(self):
 */
        __pyx_t_1 = ((struct __pyx_vtabstruct_8volttron_8platform_3vip_6router_8routercy_BaseRouter *)__pyx_v_self->__pyx_vtab)->stop(__pyx_v_self, 0, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 74, __pyx_L9_error)
        __Pyx_GOTREF(__pyx_t_1);
        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      }
      __Pyx_PyThreadState_assign
      if (PY_MAJOR_VERSION >= 3) {
        __Pyx_XGIVEREF(__pyx_t_12);
        __Pyx_XGIVEREF(__pyx_t_13);
        __Pyx_XGIVEREF(__pyx_t_14);
        __Pyx_ExceptionReset(__pyx_t_12, __pyx_t_13, __pyx_t_14);
      }
      __Pyx_XGIVEREF(__pyx_t_9);
      __Pyx_XGIVEREF(__pyx_t_10);
      __Pyx_XGIVEREF(__pyx_t_11);
      __Pyx_ErrRestore(__pyx_t_9, __pyx_t_10, __pyx_t_11);
      __pyx_t_9 = 0; __pyx_t_10 = 0; __pyx_t_11 = 0; __pyx_t_12 = 0; __pyx_t_13 = 0; __pyx_t_14 = 0;
      __pyx_lineno = __pyx_t_6; __pyx_clineno = __pyx_t_7; __pyx_filename = __pyx_t_8;
      goto __pyx_L1_error;
      __pyx_L9_error:;
      __Pyx_PyThreadState_assign
      if (PY_MAJOR_VERSION >= 3) {
        __Pyx_XGIVEREF(__pyx_t_12);
        __Pyx_XGIVEREF(__pyx_t_13);
        __Pyx_XGIVEREF(__pyx_t_14);
        __Pyx_ExceptionReset(__pyx_t_12, __pyx_t_13, __pyx_t_14);
      }
      __Pyx_XDECREF(__pyx_t_9); __pyx_t_9 = 0;
      __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
      __Pyx_XDECREF(__pyx_t_11); __pyx_t_11 = 0;
      __pyx_t_12 = 0; __pyx_t_13 = 0; __pyx_t_14 = 0;
      goto __pyx_L1_error;
    }
    __pyx_L5:;
  }

  /* "volttron/platform/vip/router/routercy.pyx":65
 *         self.ERROR = 3
 * 
 *     cpdef run(self):             # <<<<<<<<<<<<<<
 *         '''Main router loop.'''
 *         print("BaseRouter run")
 */

  /* function exit code */
  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_AddTraceback("volttron.platform.vip.router.routercy.BaseRouter.run", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_3run(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_2run[] = "Main router loop.";
static PyObject *__pyx_pw_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_3run(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("run (wrapper)", 0);
  __pyx_r = __pyx_pf_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_2run(((struct __pyx_obj_8volttron_8platform_3vip_6router_8routercy_BaseRouter *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_2run(struct __pyx_obj_8volttron_8platform_3vip_6router_8routercy_BaseRouter *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  __Pyx_RefNannySetupContext("run", 0);
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = __pyx_f_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_run(__pyx_v_self, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 65, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("volttron.platform.vip.router.routercy.BaseRouter.run", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "volttron/platform/vip/router/routercy.pyx":76
 *             self.stop()
 * 
 *     cpdef start(self):             # <<<<<<<<<<<<<<
 *         '''Create the socket and call setup().
 * 
 */

static PyObject *__pyx_pw_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_5start(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyObject *__pyx_f_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_start(struct __pyx_obj_8volttron_8platform_3vip_6router_8routercy_BaseRouter *__pyx_v_self, int __pyx_skip_dispatch) {
  PyObject *__pyx_v_sock = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  Py_ssize_t __pyx_t_5;
  PyObject *__pyx_t_6 = NULL;
  __Pyx_RefNannySetupContext("start", 0);
  /* Check if called by wrapper */
  if (unlikely(__pyx_skip_dispatch)) ;
  /* Check if overridden in Python */
  else if (unlikely(Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0)) {
    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_start); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 76, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)__pyx_pw_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_5start)) {
      __Pyx_XDECREF(__pyx_r);
      __Pyx_INCREF(__pyx_t_1);
      __pyx_t_3 = __pyx_t_1; __pyx_t_4 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_3))) {
        __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
        if (likely(__pyx_t_4)) {
          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
          __Pyx_INCREF(__pyx_t_4);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_3, function);
        }
      }
      if (__pyx_t_4) {
        __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 76, __pyx_L1_error)
        __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      } else {
        __pyx_t_2 = __Pyx_PyObject_CallNoArg(__pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 76, __pyx_L1_error)
      }
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_r = __pyx_t_2;
      __pyx_t_2 = 0;
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      goto __pyx_L0;
    }
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  }

  /* "volttron/platform/vip/router/routercy.pyx":82
 *         is called at the end of the method to perform additional setup.
 *         '''
 *         print("BaseRouter start()")             # <<<<<<<<<<<<<<
 *         self.socket = sock = self._socket_class(self.context, zmq.ROUTER)
 *         sock.router_mandatory = True
 */
  if (__Pyx_PrintOne(0, __pyx_kp_s_BaseRouter_start) < 0) __PYX_ERR(0, 82, __pyx_L1_error)

  /* "volttron/platform/vip/router/routercy.pyx":83
 *         '''
 *         print("BaseRouter start()")
 *         self.socket = sock = self._socket_class(self.context, zmq.ROUTER)             # <<<<<<<<<<<<<<
 *         sock.router_mandatory = True
 *         sock.sndtimeo = 0
 */
  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_socket_class); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 83, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_zmq); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 83, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_ROUTER); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 83, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  __pyx_t_5 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
      __pyx_t_5 = 1;
    }
  }
  __pyx_t_6 = PyTuple_New(2+__pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 83, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  if (__pyx_t_3) {
    __Pyx_GIVEREF(__pyx_t_3); PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_3); __pyx_t_3 = NULL;
  }
  __Pyx_INCREF(__pyx_v_self->context);
  __Pyx_GIVEREF(__pyx_v_self->context);
  PyTuple_SET_ITEM(__pyx_t_6, 0+__pyx_t_5, __pyx_v_self->context);
  __Pyx_GIVEREF(__pyx_t_4);
  PyTuple_SET_ITEM(__pyx_t_6, 1+__pyx_t_5, __pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_6, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 83, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_8volttron_8platform_3vip_6router_8cysocket_Socket))))) __PYX_ERR(0, 83, __pyx_L1_error)
  __Pyx_INCREF(__pyx_t_1);
  __Pyx_GIVEREF(__pyx_t_1);
  __Pyx_GOTREF(__pyx_v_self->socket);
  __Pyx_DECREF(((PyObject *)__pyx_v_self->socket));
  __pyx_v_self->socket = ((struct __pyx_obj_8volttron_8platform_3vip_6router_8cysocket_Socket *)__pyx_t_1);
  __Pyx_INCREF(__pyx_t_1);
  __pyx_v_sock = __pyx_t_1;
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "volttron/platform/vip/router/routercy.pyx":84
 *         print("BaseRouter start()")
 *         self.socket = sock = self._socket_class(self.context, zmq.ROUTER)
 *         sock.router_mandatory = True             # <<<<<<<<<<<<<<
 *         sock.sndtimeo = 0
 *         sock.tcp_keepalive = True
 */
  if (__Pyx_PyObject_SetAttrStr(__pyx_v_sock, __pyx_n_s_router_mandatory, Py_True) < 0) __PYX_ERR(0, 84, __pyx_L1_error)

  /* "volttron/platform/vip/router/routercy.pyx":85
 *         self.socket = sock = self._socket_class(self.context, zmq.ROUTER)
 *         sock.router_mandatory = True
 *         sock.sndtimeo = 0             # <<<<<<<<<<<<<<
 *         sock.tcp_keepalive = True
 *         sock.tcp_keepalive_idle = 180
 */
  if (__Pyx_PyObject_SetAttrStr(__pyx_v_sock, __pyx_n_s_sndtimeo, __pyx_int_0) < 0) __PYX_ERR(0, 85, __pyx_L1_error)

  /* "volttron/platform/vip/router/routercy.pyx":86
 *         sock.router_mandatory = True
 *         sock.sndtimeo = 0
 *         sock.tcp_keepalive = True             # <<<<<<<<<<<<<<
 *         sock.tcp_keepalive_idle = 180
 *         sock.tcp_keepalive_intvl = 20
 */
  if (__Pyx_PyObject_SetAttrStr(__pyx_v_sock, __pyx_n_s_tcp_keepalive, Py_True) < 0) __PYX_ERR(0, 86, __pyx_L1_error)

  /* "volttron/platform/vip/router/routercy.pyx":87
 *         sock.sndtimeo = 0
 *         sock.tcp_keepalive = True
 *         sock.tcp_keepalive_idle = 180             # <<<<<<<<<<<<<<
 *         sock.tcp_keepalive_intvl = 20
 *         sock.tcp_keepalive_cnt = 6
 */
  if (__Pyx_PyObject_SetAttrStr(__pyx_v_sock, __pyx_n_s_tcp_keepalive_idle, __pyx_int_180) < 0) __PYX_ERR(0, 87, __pyx_L1_error)

  /* "volttron/platform/vip/router/routercy.pyx":88
 *         sock.tcp_keepalive = True
 *         sock.tcp_keepalive_idle = 180
 *         sock.tcp_keepalive_intvl = 20             # <<<<<<<<<<<<<<
 *         sock.tcp_keepalive_cnt = 6
 *         self.setup()
 */
  if (__Pyx_PyObject_SetAttrStr(__pyx_v_sock, __pyx_n_s_tcp_keepalive_intvl, __pyx_int_20) < 0) __PYX_ERR(0, 88, __pyx_L1_error)

  /* "volttron/platform/vip/router/routercy.pyx":89
 *         sock.tcp_keepalive_idle = 180
 *         sock.tcp_keepalive_intvl = 20
 *         sock.tcp_keepalive_cnt = 6             # <<<<<<<<<<<<<<
 *         self.setup()
 * 
 */
  if (__Pyx_PyObject_SetAttrStr(__pyx_v_sock, __pyx_n_s_tcp_keepalive_cnt, __pyx_int_6) < 0) __PYX_ERR(0, 89, __pyx_L1_error)

  /* "volttron/platform/vip/router/routercy.pyx":90
 *         sock.tcp_keepalive_intvl = 20
 *         sock.tcp_keepalive_cnt = 6
 *         self.setup()             # <<<<<<<<<<<<<<
 * 
 *     cpdef stop(self, int linger=1):
 */
  __pyx_t_1 = ((struct __pyx_vtabstruct_8volttron_8platform_3vip_6router_8routercy_BaseRouter *)__pyx_v_self->__pyx_vtab)->setup(__pyx_v_self, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 90, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "volttron/platform/vip/router/routercy.pyx":76
 *             self.stop()
 * 
 *     cpdef start(self):             # <<<<<<<<<<<<<<
 *         '''Create the socket and call setup().
 * 
 */

  /* function exit code */
  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_AddTraceback("volttron.platform.vip.router.routercy.BaseRouter.start", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_sock);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_5start(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_4start[] = "Create the socket and call setup().\n\n        The socket is save in the socket attribute. The setup() method\n        is called at the end of the method to perform additional setup.\n        ";
static PyObject *__pyx_pw_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_5start(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("start (wrapper)", 0);
  __pyx_r = __pyx_pf_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_4start(((struct __pyx_obj_8volttron_8platform_3vip_6router_8routercy_BaseRouter *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_4start(struct __pyx_obj_8volttron_8platform_3vip_6router_8routercy_BaseRouter *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  __Pyx_RefNannySetupContext("start", 0);
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = __pyx_f_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_start(__pyx_v_self, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 76, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("volttron.platform.vip.router.routercy.BaseRouter.start", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "volttron/platform/vip/router/routercy.pyx":92
 *         self.setup()
 * 
 *     cpdef stop(self, int linger=1):             # <<<<<<<<<<<<<<
 *         '''Close the socket.'''
 *         self.socket.close(linger)
 */

static PyObject *__pyx_pw_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_7stop(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_stop(struct __pyx_obj_8volttron_8platform_3vip_6router_8routercy_BaseRouter *__pyx_v_self, int __pyx_skip_dispatch, struct __pyx_opt_args_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_stop *__pyx_optional_args) {
  int __pyx_v_linger = ((int)1);
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  PyObject *__pyx_t_6 = NULL;
  __Pyx_RefNannySetupContext("stop", 0);
  if (__pyx_optional_args) {
    if (__pyx_optional_args->__pyx_n > 0) {
      __pyx_v_linger = __pyx_optional_args->linger;
    }
  }
  /* Check if called by wrapper */
  if (unlikely(__pyx_skip_dispatch)) ;
  /* Check if overridden in Python */
  else if (unlikely(Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0)) {
    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_stop); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 92, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)__pyx_pw_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_7stop)) {
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_linger); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 92, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_INCREF(__pyx_t_1);
      __pyx_t_4 = __pyx_t_1; __pyx_t_5 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_4))) {
        __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_4);
        if (likely(__pyx_t_5)) {
          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
          __Pyx_INCREF(__pyx_t_5);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_4, function);
        }
      }
      if (!__pyx_t_5) {
        __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 92, __pyx_L1_error)
        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
        __Pyx_GOTREF(__pyx_t_2);
      } else {
        __pyx_t_6 = PyTuple_New(1+1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 92, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_6);
        __Pyx_GIVEREF(__pyx_t_5); PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_5); __pyx_t_5 = NULL;
        __Pyx_GIVEREF(__pyx_t_3);
        PyTuple_SET_ITEM(__pyx_t_6, 0+1, __pyx_t_3);
        __pyx_t_3 = 0;
        __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_6, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 92, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
      }
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_r = __pyx_t_2;
      __pyx_t_2 = 0;
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      goto __pyx_L0;
    }
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  }

  /* "volttron/platform/vip/router/routercy.pyx":94
 *     cpdef stop(self, int linger=1):
 *         '''Close the socket.'''
 *         self.socket.close(linger)             # <<<<<<<<<<<<<<
 * 
 *     cpdef setup(self):
 */
  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self->socket), __pyx_n_s_close); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 94, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_linger); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 94, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_6 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_6)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_6);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
    }
  }
  if (!__pyx_t_6) {
    __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 94, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __Pyx_GOTREF(__pyx_t_1);
  } else {
    __pyx_t_3 = PyTuple_New(1+1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 94, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_GIVEREF(__pyx_t_6); PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_6); __pyx_t_6 = NULL;
    __Pyx_GIVEREF(__pyx_t_4);
    PyTuple_SET_ITEM(__pyx_t_3, 0+1, __pyx_t_4);
    __pyx_t_4 = 0;
    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_3, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 94, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  }
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "volttron/platform/vip/router/routercy.pyx":92
 *         self.setup()
 * 
 *     cpdef stop(self, int linger=1):             # <<<<<<<<<<<<<<
 *         '''Close the socket.'''
 *         self.socket.close(linger)
 */

  /* function exit code */
  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_AddTraceback("volttron.platform.vip.router.routercy.BaseRouter.stop", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_7stop(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_6stop[] = "Close the socket.";
static PyObject *__pyx_pw_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_7stop(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_v_linger;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("stop (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_linger,0};
    PyObject* values[1] = {0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (kw_args > 0) {
          PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_linger);
          if (value) { values[0] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "stop") < 0)) __PYX_ERR(0, 92, __pyx_L3_error)
      }
    } else {
      switch (PyTuple_GET_SIZE(__pyx_args)) {
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    if (values[0]) {
      __pyx_v_linger = __Pyx_PyInt_As_int(values[0]); if (unlikely((__pyx_v_linger == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 92, __pyx_L3_error)
    } else {
      __pyx_v_linger = ((int)1);
    }
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("stop", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 92, __pyx_L3_error)
  __pyx_L3_error:;
  __Pyx_AddTraceback("volttron.platform.vip.router.routercy.BaseRouter.stop", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_6stop(((struct __pyx_obj_8volttron_8platform_3vip_6router_8routercy_BaseRouter *)__pyx_v_self), __pyx_v_linger);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_6stop(struct __pyx_obj_8volttron_8platform_3vip_6router_8routercy_BaseRouter *__pyx_v_self, int __pyx_v_linger) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  struct __pyx_opt_args_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_stop __pyx_t_2;
  __Pyx_RefNannySetupContext("stop", 0);
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_2.__pyx_n = 1;
  __pyx_t_2.linger = __pyx_v_linger;
  __pyx_t_1 = __pyx_vtabptr_8volttron_8platform_3vip_6router_8routercy_BaseRouter->stop(__pyx_v_self, 1, &__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 92, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("volttron.platform.vip.router.routercy.BaseRouter.stop", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "volttron/platform/vip/router/routercy.pyx":96
 *         self.socket.close(linger)
 * 
 *     cpdef setup(self):             # <<<<<<<<<<<<<<
 *         '''Called from start() method to setup the socket.
 * 
 */

static PyObject *__pyx_pw_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_9setup(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyObject *__pyx_f_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_setup(CYTHON_UNUSED struct __pyx_obj_8volttron_8platform_3vip_6router_8routercy_BaseRouter *__pyx_v_self, int __pyx_skip_dispatch) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  __Pyx_RefNannySetupContext("setup", 0);
  /* Check if called by wrapper */
  if (unlikely(__pyx_skip_dispatch)) ;
  /* Check if overridden in Python */
  else if (unlikely(Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0)) {
    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_setup); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 96, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)__pyx_pw_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_9setup)) {
      __Pyx_XDECREF(__pyx_r);
      __Pyx_INCREF(__pyx_t_1);
      __pyx_t_3 = __pyx_t_1; __pyx_t_4 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_3))) {
        __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
        if (likely(__pyx_t_4)) {
          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
          __Pyx_INCREF(__pyx_t_4);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_3, function);
        }
      }
      if (__pyx_t_4) {
        __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 96, __pyx_L1_error)
        __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      } else {
        __pyx_t_2 = __Pyx_PyObject_CallNoArg(__pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 96, __pyx_L1_error)
      }
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_r = __pyx_t_2;
      __pyx_t_2 = 0;
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      goto __pyx_L0;
    }
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  }

  /* "volttron/platform/vip/router/routercy.pyx":102
 *         options, etc.
 *         '''
 *         raise NotImplementedError()             # <<<<<<<<<<<<<<
 * 
 *     #@property
 */
  __pyx_t_1 = __Pyx_PyObject_CallNoArg(__pyx_builtin_NotImplementedError); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 102, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_Raise(__pyx_t_1, 0, 0, 0);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __PYX_ERR(0, 102, __pyx_L1_error)

  /* "volttron/platform/vip/router/routercy.pyx":96
 *         self.socket.close(linger)
 * 
 *     cpdef setup(self):             # <<<<<<<<<<<<<<
 *         '''Called from start() method to setup the socket.
 * 
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_AddTraceback("volttron.platform.vip.router.routercy.BaseRouter.setup", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_9setup(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_8setup[] = "Called from start() method to setup the socket.\n\n        Implement this method to bind the socket, set identities and\n        options, etc.\n        ";
static PyObject *__pyx_pw_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_9setup(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("setup (wrapper)", 0);
  __pyx_r = __pyx_pf_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_8setup(((struct __pyx_obj_8volttron_8platform_3vip_6router_8routercy_BaseRouter *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_8setup(struct __pyx_obj_8volttron_8platform_3vip_6router_8routercy_BaseRouter *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  __Pyx_RefNannySetupContext("setup", 0);
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = __pyx_f_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_setup(__pyx_v_self, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 96, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("volttron.platform.vip.router.routercy.BaseRouter.setup", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "volttron/platform/vip/router/routercy.pyx":105
 * 
 *     #@property
 *     cpdef poll(self):             # <<<<<<<<<<<<<<
 *         '''Returns the underlying socket's poll method.'''
 *         return self.socket.poll
 */

static PyObject *__pyx_pw_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_11poll(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyObject *__pyx_f_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_poll(struct __pyx_obj_8volttron_8platform_3vip_6router_8routercy_BaseRouter *__pyx_v_self, int __pyx_skip_dispatch) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  __Pyx_RefNannySetupContext("poll", 0);
  /* Check if called by wrapper */
  if (unlikely(__pyx_skip_dispatch)) ;
  /* Check if overridden in Python */
  else if (unlikely(Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0)) {
    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_poll); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 105, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)__pyx_pw_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_11poll)) {
      __Pyx_XDECREF(__pyx_r);
      __Pyx_INCREF(__pyx_t_1);
      __pyx_t_3 = __pyx_t_1; __pyx_t_4 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_3))) {
        __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
        if (likely(__pyx_t_4)) {
          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
          __Pyx_INCREF(__pyx_t_4);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_3, function);
        }
      }
      if (__pyx_t_4) {
        __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 105, __pyx_L1_error)
        __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      } else {
        __pyx_t_2 = __Pyx_PyObject_CallNoArg(__pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 105, __pyx_L1_error)
      }
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_r = __pyx_t_2;
      __pyx_t_2 = 0;
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      goto __pyx_L0;
    }
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  }

  /* "volttron/platform/vip/router/routercy.pyx":107
 *     cpdef poll(self):
 *         '''Returns the underlying socket's poll method.'''
 *         return self.socket.poll             # <<<<<<<<<<<<<<
 * 
 *     cpdef object handle_subsystem(self, object frames, object user_id):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self->socket), __pyx_n_s_poll); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 107, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* "volttron/platform/vip/router/routercy.pyx":105
 * 
 *     #@property
 *     cpdef poll(self):             # <<<<<<<<<<<<<<
 *         '''Returns the underlying socket's poll method.'''
 *         return self.socket.poll
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_AddTraceback("volttron.platform.vip.router.routercy.BaseRouter.poll", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_11poll(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_10poll[] = "Returns the underlying socket's poll method.";
static PyObject *__pyx_pw_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_11poll(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("poll (wrapper)", 0);
  __pyx_r = __pyx_pf_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_10poll(((struct __pyx_obj_8volttron_8platform_3vip_6router_8routercy_BaseRouter *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_10poll(struct __pyx_obj_8volttron_8platform_3vip_6router_8routercy_BaseRouter *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  __Pyx_RefNannySetupContext("poll", 0);
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = __pyx_f_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_poll(__pyx_v_self, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 105, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("volttron.platform.vip.router.routercy.BaseRouter.poll", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "volttron/platform/vip/router/routercy.pyx":109
 *         return self.socket.poll
 * 
 *     cpdef object handle_subsystem(self, object frames, object user_id):             # <<<<<<<<<<<<<<
 *     #cpdef handle_subsystem(self, frames, user_id):
 *         '''Handle additional subsystems and provide a response.
 */

static PyObject *__pyx_pw_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_13handle_subsystem(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_handle_subsystem(CYTHON_UNUSED struct __pyx_obj_8volttron_8platform_3vip_6router_8routercy_BaseRouter *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v_frames, CYTHON_UNUSED PyObject *__pyx_v_user_id, int __pyx_skip_dispatch) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  Py_ssize_t __pyx_t_5;
  PyObject *__pyx_t_6 = NULL;
  __Pyx_RefNannySetupContext("handle_subsystem", 0);
  /* Check if called by wrapper */
  if (unlikely(__pyx_skip_dispatch)) ;
  /* Check if overridden in Python */
  else if (unlikely(Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0)) {
    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_handle_subsystem); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 109, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)__pyx_pw_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_13handle_subsystem)) {
      __Pyx_XDECREF(__pyx_r);
      __Pyx_INCREF(__pyx_t_1);
      __pyx_t_3 = __pyx_t_1; __pyx_t_4 = NULL;
      __pyx_t_5 = 0;
      if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_3))) {
        __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
        if (likely(__pyx_t_4)) {
          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
          __Pyx_INCREF(__pyx_t_4);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_3, function);
          __pyx_t_5 = 1;
        }
      }
      __pyx_t_6 = PyTuple_New(2+__pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 109, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_6);
      if (__pyx_t_4) {
        __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_4); __pyx_t_4 = NULL;
      }
      __Pyx_INCREF(__pyx_v_frames);
      __Pyx_GIVEREF(__pyx_v_frames);
      PyTuple_SET_ITEM(__pyx_t_6, 0+__pyx_t_5, __pyx_v_frames);
      __Pyx_INCREF(__pyx_v_user_id);
      __Pyx_GIVEREF(__pyx_v_user_id);
      PyTuple_SET_ITEM(__pyx_t_6, 1+__pyx_t_5, __pyx_v_user_id);
      __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_6, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 109, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_r = __pyx_t_2;
      __pyx_t_2 = 0;
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      goto __pyx_L0;
    }
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  }

  /* "volttron/platform/vip/router/routercy.pyx":111
 *     cpdef object handle_subsystem(self, object frames, object user_id):
 *     #cpdef handle_subsystem(self, frames, user_id):
 *         '''Handle additional subsystems and provide a response.             # <<<<<<<<<<<<<<
 * 
 *         This method does nothing by default and may be implemented by
 */

  /* function exit code */
  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_AddTraceback("volttron.platform.vip.router.routercy.BaseRouter.handle_subsystem", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "volttron/platform/vip/router/routercy.pyx":109
 *         return self.socket.poll
 * 
 *     cpdef object handle_subsystem(self, object frames, object user_id):             # <<<<<<<<<<<<<<
 *     #cpdef handle_subsystem(self, frames, user_id):
 *         '''Handle additional subsystems and provide a response.
 */

/* Python wrapper */
static PyObject *__pyx_pw_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_13handle_subsystem(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_12handle_subsystem[] = "Handle additional subsystems and provide a response.\n\n        This method does nothing by default and may be implemented by\n        subclasses to provide additional subsystems.\n\n        frames is a list of zmq.Frame objects with the following\n        elements:\n\n          [SENDER, RECIPIENT, PROTOCOL, USER_ID, MSG_ID, SUBSYSTEM, ...]\n\n        The return value should be None, if the subsystem is unknown, an\n        empty list or False (or other False value) if the message was\n        handled but does not require/generate a response, or a list of\n        containing the following elements:\n\n          [RECIPIENT, SENDER, PROTOCOL, USER_ID, MSG_ID, SUBSYSTEM, ...]\n\n        ";
static PyObject *__pyx_pw_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_13handle_subsystem(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_frames = 0;
  PyObject *__pyx_v_user_id = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("handle_subsystem (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_frames,&__pyx_n_s_user_id,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_frames)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_user_id)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("handle_subsystem", 1, 2, 2, 1); __PYX_ERR(0, 109, __pyx_L3_error)
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "handle_subsystem") < 0)) __PYX_ERR(0, 109, __pyx_L3_error)
      }
    } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
    }
    __pyx_v_frames = values[0];
    __pyx_v_user_id = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("handle_subsystem", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 109, __pyx_L3_error)
  __pyx_L3_error:;
  __Pyx_AddTraceback("volttron.platform.vip.router.routercy.BaseRouter.handle_subsystem", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_12handle_subsystem(((struct __pyx_obj_8volttron_8platform_3vip_6router_8routercy_BaseRouter *)__pyx_v_self), __pyx_v_frames, __pyx_v_user_id);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_12handle_subsystem(struct __pyx_obj_8volttron_8platform_3vip_6router_8routercy_BaseRouter *__pyx_v_self, PyObject *__pyx_v_frames, PyObject *__pyx_v_user_id) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  __Pyx_RefNannySetupContext("handle_subsystem", 0);
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = __pyx_f_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_handle_subsystem(__pyx_v_self, __pyx_v_frames, __pyx_v_user_id, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 109, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("volttron.platform.vip.router.routercy.BaseRouter.handle_subsystem", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "volttron/platform/vip/router/routercy.pyx":131
 *         pass
 * 
 *     cpdef issue(self, int topic, object frames, object extra=None):             # <<<<<<<<<<<<<<
 *         pass
 * 
 */

static PyObject *__pyx_pw_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_15issue(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_issue(CYTHON_UNUSED struct __pyx_obj_8volttron_8platform_3vip_6router_8routercy_BaseRouter *__pyx_v_self, CYTHON_UNUSED int __pyx_v_topic, CYTHON_UNUSED PyObject *__pyx_v_frames, int __pyx_skip_dispatch, struct __pyx_opt_args_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_issue *__pyx_optional_args) {
  PyObject *__pyx_v_extra = ((PyObject *)Py_None);
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  Py_ssize_t __pyx_t_6;
  PyObject *__pyx_t_7 = NULL;
  __Pyx_RefNannySetupContext("issue", 0);
  if (__pyx_optional_args) {
    if (__pyx_optional_args->__pyx_n > 0) {
      __pyx_v_extra = __pyx_optional_args->extra;
    }
  }
  /* Check if called by wrapper */
  if (unlikely(__pyx_skip_dispatch)) ;
  /* Check if overridden in Python */
  else if (unlikely(Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0)) {
    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_issue); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 131, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)__pyx_pw_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_15issue)) {
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_topic); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 131, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_INCREF(__pyx_t_1);
      __pyx_t_4 = __pyx_t_1; __pyx_t_5 = NULL;
      __pyx_t_6 = 0;
      if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_4))) {
        __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_4);
        if (likely(__pyx_t_5)) {
          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
          __Pyx_INCREF(__pyx_t_5);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_4, function);
          __pyx_t_6 = 1;
        }
      }
      __pyx_t_7 = PyTuple_New(3+__pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 131, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_7);
      if (__pyx_t_5) {
        __Pyx_GIVEREF(__pyx_t_5); PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_5); __pyx_t_5 = NULL;
      }
      __Pyx_GIVEREF(__pyx_t_3);
      PyTuple_SET_ITEM(__pyx_t_7, 0+__pyx_t_6, __pyx_t_3);
      __Pyx_INCREF(__pyx_v_frames);
      __Pyx_GIVEREF(__pyx_v_frames);
      PyTuple_SET_ITEM(__pyx_t_7, 1+__pyx_t_6, __pyx_v_frames);
      __Pyx_INCREF(__pyx_v_extra);
      __Pyx_GIVEREF(__pyx_v_extra);
      PyTuple_SET_ITEM(__pyx_t_7, 2+__pyx_t_6, __pyx_v_extra);
      __pyx_t_3 = 0;
      __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_7, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 131, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_r = __pyx_t_2;
      __pyx_t_2 = 0;
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      goto __pyx_L0;
    }
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  }

  /* "volttron/platform/vip/router/routercy.pyx":132
 * 
 *     cpdef issue(self, int topic, object frames, object extra=None):
 *         pass             # <<<<<<<<<<<<<<
 * 
 *     if zmq.zmq_version_info() >= (4, 1, 0):
 */

  /* function exit code */
  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_AddTraceback("volttron.platform.vip.router.routercy.BaseRouter.issue", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "volttron/platform/vip/router/routercy.pyx":131
 *         pass
 * 
 *     cpdef issue(self, int topic, object frames, object extra=None):             # <<<<<<<<<<<<<<
 *         pass
 * 
 */

/* Python wrapper */
static PyObject *__pyx_pw_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_15issue(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pw_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_15issue(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_v_topic;
  PyObject *__pyx_v_frames = 0;
  PyObject *__pyx_v_extra = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("issue (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_topic,&__pyx_n_s_frames,&__pyx_n_s_extra,0};
    PyObject* values[3] = {0,0,0};
    values[2] = ((PyObject *)Py_None);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_topic)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_frames)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("issue", 0, 2, 3, 1); __PYX_ERR(0, 131, __pyx_L3_error)
        }
        case  2:
        if (kw_args > 0) {
          PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_extra);
          if (value) { values[2] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "issue") < 0)) __PYX_ERR(0, 131, __pyx_L3_error)
      }
    } else {
      switch (PyTuple_GET_SIZE(__pyx_args)) {
        case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_topic = __Pyx_PyInt_As_int(values[0]); if (unlikely((__pyx_v_topic == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 131, __pyx_L3_error)
    __pyx_v_frames = values[1];
    __pyx_v_extra = values[2];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("issue", 0, 2, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 131, __pyx_L3_error)
  __pyx_L3_error:;
  __Pyx_AddTraceback("volttron.platform.vip.router.routercy.BaseRouter.issue", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_14issue(((struct __pyx_obj_8volttron_8platform_3vip_6router_8routercy_BaseRouter *)__pyx_v_self), __pyx_v_topic, __pyx_v_frames, __pyx_v_extra);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_14issue(struct __pyx_obj_8volttron_8platform_3vip_6router_8routercy_BaseRouter *__pyx_v_self, int __pyx_v_topic, PyObject *__pyx_v_frames, PyObject *__pyx_v_extra) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  struct __pyx_opt_args_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_issue __pyx_t_2;
  __Pyx_RefNannySetupContext("issue", 0);
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_2.__pyx_n = 1;
  __pyx_t_2.extra = __pyx_v_extra;
  __pyx_t_1 = __pyx_vtabptr_8volttron_8platform_3vip_6router_8routercy_BaseRouter->issue(__pyx_v_self, __pyx_v_topic, __pyx_v_frames, 1, &__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 131, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("volttron.platform.vip.router.routercy.BaseRouter.issue", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "volttron/platform/vip/router/routercy.pyx":135
 * 
 *     if zmq.zmq_version_info() >= (4, 1, 0):
 *         def lookup_user_id(self, sender, recipient, auth_token):             # <<<<<<<<<<<<<<
 *             '''Find and return a user identifier.
 * 
 */

/* Python wrapper */
static PyObject *__pyx_pw_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_17lookup_user_id(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_16lookup_user_id[] = "Find and return a user identifier.\n\n            Returns the UTF-8 encoded User-Id property from the sender\n            frame or None if the authenticator did not set the User-Id\n            metadata. May be extended to perform additional lookups.\n            ";
static PyObject *__pyx_pw_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_17lookup_user_id(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  CYTHON_UNUSED PyObject *__pyx_v_sender = 0;
  PyObject *__pyx_v_recipient = 0;
  CYTHON_UNUSED PyObject *__pyx_v_auth_token = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("lookup_user_id (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_sender,&__pyx_n_s_recipient,&__pyx_n_s_auth_token,0};
    PyObject* values[3] = {0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_sender)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_recipient)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("lookup_user_id", 1, 3, 3, 1); __PYX_ERR(0, 135, __pyx_L3_error)
        }
        case  2:
        if (likely((values[2] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_auth_token)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("lookup_user_id", 1, 3, 3, 2); __PYX_ERR(0, 135, __pyx_L3_error)
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "lookup_user_id") < 0)) __PYX_ERR(0, 135, __pyx_L3_error)
      }
    } else if (PyTuple_GET_SIZE(__pyx_args) != 3) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
    }
    __pyx_v_sender = values[0];
    __pyx_v_recipient = values[1];
    __pyx_v_auth_token = values[2];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("lookup_user_id", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 135, __pyx_L3_error)
  __pyx_L3_error:;
  __Pyx_AddTraceback("volttron.platform.vip.router.routercy.BaseRouter.lookup_user_id", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_16lookup_user_id(((struct __pyx_obj_8volttron_8platform_3vip_6router_8routercy_BaseRouter *)__pyx_v_self), __pyx_v_sender, __pyx_v_recipient, __pyx_v_auth_token);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_16lookup_user_id(struct __pyx_obj_8volttron_8platform_3vip_6router_8routercy_BaseRouter *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v_sender, PyObject *__pyx_v_recipient, CYTHON_UNUSED PyObject *__pyx_v_auth_token) {
  PyObject *__pyx_v_exc = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  int __pyx_t_6;
  PyObject *__pyx_t_7 = NULL;
  PyObject *__pyx_t_8 = NULL;
  PyObject *__pyx_t_9 = NULL;
  PyObject *__pyx_t_10 = NULL;
  int __pyx_t_11;
  __Pyx_RefNannySetupContext("lookup_user_id", 0);

  /* "volttron/platform/vip/router/routercy.pyx":144
 *             # pylint: disable=unused-argument
 *             # A user id might/should be set by the ZAP authenticator
 *             try:             # <<<<<<<<<<<<<<
 *                 return recipient.get('User-Id').encode('utf-8')
 *             except ZMQError as exc:
 */
  {
    __Pyx_PyThreadState_declare
    __Pyx_PyThreadState_assign
    __Pyx_ExceptionSave(&__pyx_t_1, &__pyx_t_2, &__pyx_t_3);
    __Pyx_XGOTREF(__pyx_t_1);
    __Pyx_XGOTREF(__pyx_t_2);
    __Pyx_XGOTREF(__pyx_t_3);
    /*try:*/ {

      /* "volttron/platform/vip/router/routercy.pyx":145
 *             # A user id might/should be set by the ZAP authenticator
 *             try:
 *                 return recipient.get('User-Id').encode('utf-8')             # <<<<<<<<<<<<<<
 *             except ZMQError as exc:
 *                 if exc.errno != EINVAL:
 */
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_recipient, __pyx_n_s_get); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 145, __pyx_L3_error)
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_tuple__2, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 145, __pyx_L3_error)
      __Pyx_GOTREF(__pyx_t_5);
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_encode); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 145, __pyx_L3_error)
      __Pyx_GOTREF(__pyx_t_4);
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_tuple__3, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 145, __pyx_L3_error)
      __Pyx_GOTREF(__pyx_t_5);
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_r = __pyx_t_5;
      __pyx_t_5 = 0;
      goto __pyx_L7_try_return;

      /* "volttron/platform/vip/router/routercy.pyx":144
 *             # pylint: disable=unused-argument
 *             # A user id might/should be set by the ZAP authenticator
 *             try:             # <<<<<<<<<<<<<<
 *                 return recipient.get('User-Id').encode('utf-8')
 *             except ZMQError as exc:
 */
    }
    __pyx_L3_error:;
    __Pyx_PyThreadState_assign
    __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
    __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;

    /* "volttron/platform/vip/router/routercy.pyx":146
 *             try:
 *                 return recipient.get('User-Id').encode('utf-8')
 *             except ZMQError as exc:             # <<<<<<<<<<<<<<
 *                 if exc.errno != EINVAL:
 *                     raise
 */
    __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_ZMQError); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 146, __pyx_L5_except_error)
    __Pyx_GOTREF(__pyx_t_5);
    __pyx_t_6 = __Pyx_PyErr_ExceptionMatches(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    if (__pyx_t_6) {
      __Pyx_AddTraceback("volttron.platform.vip.router.routercy.BaseRouter.lookup_user_id", __pyx_clineno, __pyx_lineno, __pyx_filename);
      if (__Pyx_GetException(&__pyx_t_5, &__pyx_t_4, &__pyx_t_7) < 0) __PYX_ERR(0, 146, __pyx_L5_except_error)
      __Pyx_GOTREF(__pyx_t_5);
      __Pyx_GOTREF(__pyx_t_4);
      __Pyx_GOTREF(__pyx_t_7);
      __Pyx_INCREF(__pyx_t_4);
      __pyx_v_exc = __pyx_t_4;

      /* "volttron/platform/vip/router/routercy.pyx":147
 *                 return recipient.get('User-Id').encode('utf-8')
 *             except ZMQError as exc:
 *                 if exc.errno != EINVAL:             # <<<<<<<<<<<<<<
 *                     raise
 *             return self.default_user_id
 */
      __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_v_exc, __pyx_n_s_errno); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 147, __pyx_L5_except_error)
      __Pyx_GOTREF(__pyx_t_8);
      __pyx_t_9 = __Pyx_GetModuleGlobalName(__pyx_n_s_EINVAL); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 147, __pyx_L5_except_error)
      __Pyx_GOTREF(__pyx_t_9);
      __pyx_t_10 = PyObject_RichCompare(__pyx_t_8, __pyx_t_9, Py_NE); __Pyx_XGOTREF(__pyx_t_10); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 147, __pyx_L5_except_error)
      __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
      __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
      __pyx_t_11 = __Pyx_PyObject_IsTrue(__pyx_t_10); if (unlikely(__pyx_t_11 < 0)) __PYX_ERR(0, 147, __pyx_L5_except_error)
      __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
      if (__pyx_t_11) {

        /* "volttron/platform/vip/router/routercy.pyx":148
 *             except ZMQError as exc:
 *                 if exc.errno != EINVAL:
 *                     raise             # <<<<<<<<<<<<<<
 *             return self.default_user_id
 *     else:
 */
        __Pyx_GIVEREF(__pyx_t_5);
        __Pyx_GIVEREF(__pyx_t_4);
        __Pyx_XGIVEREF(__pyx_t_7);
        __Pyx_ErrRestoreWithState(__pyx_t_5, __pyx_t_4, __pyx_t_7);
        __pyx_t_5 = 0; __pyx_t_4 = 0; __pyx_t_7 = 0; 
        __PYX_ERR(0, 148, __pyx_L5_except_error)

        /* "volttron/platform/vip/router/routercy.pyx":147
 *                 return recipient.get('User-Id').encode('utf-8')
 *             except ZMQError as exc:
 *                 if exc.errno != EINVAL:             # <<<<<<<<<<<<<<
 *                     raise
 *             return self.default_user_id
 */
      }
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
      goto __pyx_L4_exception_handled;
    }
    goto __pyx_L5_except_error;
    __pyx_L5_except_error:;

    /* "volttron/platform/vip/router/routercy.pyx":144
 *             # pylint: disable=unused-argument
 *             # A user id might/should be set by the ZAP authenticator
 *             try:             # <<<<<<<<<<<<<<
 *                 return recipient.get('User-Id').encode('utf-8')
 *             except ZMQError as exc:
 */
    __Pyx_PyThreadState_assign
    __Pyx_XGIVEREF(__pyx_t_1);
    __Pyx_XGIVEREF(__pyx_t_2);
    __Pyx_XGIVEREF(__pyx_t_3);
    __Pyx_ExceptionReset(__pyx_t_1, __pyx_t_2, __pyx_t_3);
    goto __pyx_L1_error;
    __pyx_L7_try_return:;
    __Pyx_PyThreadState_assign
    __Pyx_XGIVEREF(__pyx_t_1);
    __Pyx_XGIVEREF(__pyx_t_2);
    __Pyx_XGIVEREF(__pyx_t_3);
    __Pyx_ExceptionReset(__pyx_t_1, __pyx_t_2, __pyx_t_3);
    goto __pyx_L0;
    __pyx_L4_exception_handled:;
    __Pyx_PyThreadState_assign
    __Pyx_XGIVEREF(__pyx_t_1);
    __Pyx_XGIVEREF(__pyx_t_2);
    __Pyx_XGIVEREF(__pyx_t_3);
    __Pyx_ExceptionReset(__pyx_t_1, __pyx_t_2, __pyx_t_3);
  }

  /* "volttron/platform/vip/router/routercy.pyx":149
 *                 if exc.errno != EINVAL:
 *                     raise
 *             return self.default_user_id             # <<<<<<<<<<<<<<
 *     else:
 *         def lookup_user_id(self, sender, recipient, auth_token):
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_self->default_user_id);
  __pyx_r = __pyx_v_self->default_user_id;
  goto __pyx_L0;

  /* "volttron/platform/vip/router/routercy.pyx":135
 * 
 *     if zmq.zmq_version_info() >= (4, 1, 0):
 *         def lookup_user_id(self, sender, recipient, auth_token):             # <<<<<<<<<<<<<<
 *             '''Find and return a user identifier.
 * 
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_XDECREF(__pyx_t_8);
  __Pyx_XDECREF(__pyx_t_9);
  __Pyx_XDECREF(__pyx_t_10);
  __Pyx_AddTraceback("volttron.platform.vip.router.routercy.BaseRouter.lookup_user_id", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_exc);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "volttron/platform/vip/router/routercy.pyx":151
 *             return self.default_user_id
 *     else:
 *         def lookup_user_id(self, sender, recipient, auth_token):             # <<<<<<<<<<<<<<
 *             '''Find and return a user identifier.
 * 
 */

/* Python wrapper */
static PyObject *__pyx_pw_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_19lookup_user_id(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_18lookup_user_id[] = "Find and return a user identifier.\n\n            A no-op by default, this method must be overridden to map\n            the sender and auth_token to a user ID. The returned value\n            must be a string or None (if the token was not found).\n            ";
static PyObject *__pyx_pw_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_19lookup_user_id(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  CYTHON_UNUSED PyObject *__pyx_v_sender = 0;
  CYTHON_UNUSED PyObject *__pyx_v_recipient = 0;
  CYTHON_UNUSED PyObject *__pyx_v_auth_token = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("lookup_user_id (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_sender,&__pyx_n_s_recipient,&__pyx_n_s_auth_token,0};
    PyObject* values[3] = {0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_sender)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_recipient)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("lookup_user_id", 1, 3, 3, 1); __PYX_ERR(0, 151, __pyx_L3_error)
        }
        case  2:
        if (likely((values[2] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_auth_token)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("lookup_user_id", 1, 3, 3, 2); __PYX_ERR(0, 151, __pyx_L3_error)
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "lookup_user_id") < 0)) __PYX_ERR(0, 151, __pyx_L3_error)
      }
    } else if (PyTuple_GET_SIZE(__pyx_args) != 3) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
    }
    __pyx_v_sender = values[0];
    __pyx_v_recipient = values[1];
    __pyx_v_auth_token = values[2];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("lookup_user_id", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 151, __pyx_L3_error)
  __pyx_L3_error:;
  __Pyx_AddTraceback("volttron.platform.vip.router.routercy.BaseRouter.lookup_user_id", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_18lookup_user_id(((struct __pyx_obj_8volttron_8platform_3vip_6router_8routercy_BaseRouter *)__pyx_v_self), __pyx_v_sender, __pyx_v_recipient, __pyx_v_auth_token);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_18lookup_user_id(struct __pyx_obj_8volttron_8platform_3vip_6router_8routercy_BaseRouter *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v_sender, CYTHON_UNUSED PyObject *__pyx_v_recipient, CYTHON_UNUSED PyObject *__pyx_v_auth_token) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("lookup_user_id", 0);

  /* "volttron/platform/vip/router/routercy.pyx":158
 *             must be a string or None (if the token was not found).
 *             '''
 *             return self.default_user_id             # <<<<<<<<<<<<<<
 * 
 *     cdef _distribute(self, bytes subsys, bytes cmd, string peer):
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_self->default_user_id);
  __pyx_r = __pyx_v_self->default_user_id;
  goto __pyx_L0;

  /* "volttron/platform/vip/router/routercy.pyx":151
 *             return self.default_user_id
 *     else:
 *         def lookup_user_id(self, sender, recipient, auth_token):             # <<<<<<<<<<<<<<
 *             '''Find and return a user identifier.
 * 
 */

  /* function exit code */
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "volttron/platform/vip/router/routercy.pyx":160
 *             return self.default_user_id
 * 
 *     cdef _distribute(self, bytes subsys, bytes cmd, string peer):             # <<<<<<<<<<<<<<
 *         cdef:
 *             set[string] drop
 */

static PyObject *__pyx_f_8volttron_8platform_3vip_6router_8routercy_10BaseRouter__distribute(struct __pyx_obj_8volttron_8platform_3vip_6router_8routercy_BaseRouter *__pyx_v_self, PyObject *__pyx_v_subsys, PyObject *__pyx_v_cmd, std::string __pyx_v_peer) {
  std::set<std::string>  __pyx_v_drop;
  struct __pyx_obj_8volttron_8platform_3vip_6router_9cymessage_Frame *__pyx_v_empty = 0;
  struct __pyx_obj_8volttron_8platform_3vip_6router_5queue_Queue *__pyx_v_frames = 0;
  CYTHON_UNUSED std::string __pyx_v_pr;
  std::set<std::string> ::iterator __pyx_v_end;
  std::set<std::string> ::iterator __pyx_v_it;
  std::vector<std::string>  __pyx_v_peerlist;
  std::vector<std::string> ::iterator __pyx_v_it1;
  std::set<std::string> ::iterator __pyx_v_dit;
  char *__pyx_v_subsys_data;
  Py_ssize_t __pyx_v_data_len_c;
  char *__pyx_v_cmd_data;
  char *__pyx_v_peer_data;
  struct __pyx_obj_8volttron_8platform_3vip_6router_9cymessage_Frame *__pyx_v_vipframe = 0;
  struct __pyx_obj_8volttron_8platform_3vip_6router_9cymessage_Frame *__pyx_v_sysdata = 0;
  struct __pyx_obj_8volttron_8platform_3vip_6router_9cymessage_Frame *__pyx_v_cmdata = 0;
  struct __pyx_obj_8volttron_8platform_3vip_6router_9cymessage_Frame *__pyx_v_prdata = 0;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_t_3;
  std::vector<std::string>  __pyx_t_4;
  __Pyx_RefNannySetupContext("_distribute", 0);

  /* "volttron/platform/vip/router/routercy.pyx":163
 *         cdef:
 *             set[string] drop
 *             cymessage.Frame empty = cymessage.Frame(<char*>'')             # <<<<<<<<<<<<<<
 *             Queue frames = Queue()
 *             #object frames = [empty, empty, Frame(b'VIP1'), empty, empty]
 */
  __pyx_t_1 = __Pyx_PyBytes_FromString(((char *)((char *)""))); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 163, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 163, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_GIVEREF(__pyx_t_1);
  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_8volttron_8platform_3vip_6router_9cymessage_Frame), __pyx_t_2, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 163, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_empty = ((struct __pyx_obj_8volttron_8platform_3vip_6router_9cymessage_Frame *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "volttron/platform/vip/router/routercy.pyx":164
 *             set[string] drop
 *             cymessage.Frame empty = cymessage.Frame(<char*>'')
 *             Queue frames = Queue()             # <<<<<<<<<<<<<<
 *             #object frames = [empty, empty, Frame(b'VIP1'), empty, empty]
 *             string pr
 */
  __pyx_t_1 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_8volttron_8platform_3vip_6router_5queue_Queue), __pyx_empty_tuple, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 164, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_frames = ((struct __pyx_obj_8volttron_8platform_3vip_6router_5queue_Queue *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "volttron/platform/vip/router/routercy.pyx":167
 *             #object frames = [empty, empty, Frame(b'VIP1'), empty, empty]
 *             string pr
 *             set[string].iterator end = self._peers.end()             # <<<<<<<<<<<<<<
 *             set[string].iterator it = self._peers.begin()
 *             vector[string] peerlist
 */
  __pyx_v_end = __pyx_v_self->_peers.end();

  /* "volttron/platform/vip/router/routercy.pyx":168
 *             string pr
 *             set[string].iterator end = self._peers.end()
 *             set[string].iterator it = self._peers.begin()             # <<<<<<<<<<<<<<
 *             vector[string] peerlist
 *             vector[string].iterator it1 = peerlist.begin()
 */
  __pyx_v_it = __pyx_v_self->_peers.begin();

  /* "volttron/platform/vip/router/routercy.pyx":170
 *             set[string].iterator it = self._peers.begin()
 *             vector[string] peerlist
 *             vector[string].iterator it1 = peerlist.begin()             # <<<<<<<<<<<<<<
 *             set[string].iterator dit = drop.begin()
 *             char* subsys_data = NULL
 */
  __pyx_v_it1 = __pyx_v_peerlist.begin();

  /* "volttron/platform/vip/router/routercy.pyx":171
 *             vector[string] peerlist
 *             vector[string].iterator it1 = peerlist.begin()
 *             set[string].iterator dit = drop.begin()             # <<<<<<<<<<<<<<
 *             char* subsys_data = NULL
 *             Py_ssize_t data_len_c=0
 */
  __pyx_v_dit = __pyx_v_drop.begin();

  /* "volttron/platform/vip/router/routercy.pyx":172
 *             vector[string].iterator it1 = peerlist.begin()
 *             set[string].iterator dit = drop.begin()
 *             char* subsys_data = NULL             # <<<<<<<<<<<<<<
 *             Py_ssize_t data_len_c=0
 *             char* cmd_data = NULL
 */
  __pyx_v_subsys_data = NULL;

  /* "volttron/platform/vip/router/routercy.pyx":173
 *             set[string].iterator dit = drop.begin()
 *             char* subsys_data = NULL
 *             Py_ssize_t data_len_c=0             # <<<<<<<<<<<<<<
 *             char* cmd_data = NULL
 *             char* peer_data = NULL
 */
  __pyx_v_data_len_c = 0;

  /* "volttron/platform/vip/router/routercy.pyx":174
 *             char* subsys_data = NULL
 *             Py_ssize_t data_len_c=0
 *             char* cmd_data = NULL             # <<<<<<<<<<<<<<
 *             char* peer_data = NULL
 *             cymessage.Frame vipframe = cymessage.Frame(b'VIP')
 */
  __pyx_v_cmd_data = NULL;

  /* "volttron/platform/vip/router/routercy.pyx":175
 *             Py_ssize_t data_len_c=0
 *             char* cmd_data = NULL
 *             char* peer_data = NULL             # <<<<<<<<<<<<<<
 *             cymessage.Frame vipframe = cymessage.Frame(b'VIP')
 *             cymessage.Frame sysdata, cmdata, prdata
 */
  __pyx_v_peer_data = NULL;

  /* "volttron/platform/vip/router/routercy.pyx":176
 *             char* cmd_data = NULL
 *             char* peer_data = NULL
 *             cymessage.Frame vipframe = cymessage.Frame(b'VIP')             # <<<<<<<<<<<<<<
 *             cymessage.Frame sysdata, cmdata, prdata
 * 
 */
  __pyx_t_1 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_8volttron_8platform_3vip_6router_9cymessage_Frame), __pyx_tuple__4, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 176, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_vipframe = ((struct __pyx_obj_8volttron_8platform_3vip_6router_9cymessage_Frame *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "volttron/platform/vip/router/routercy.pyx":179
 *             cymessage.Frame sysdata, cmdata, prdata
 * 
 *         frames.append(<void*>empty)             # <<<<<<<<<<<<<<
 *         frames.append(<void*>empty)
 *         frames.append(<void*>vipframe)
 */
  __pyx_t_1 = ((struct __pyx_vtabstruct_8volttron_8platform_3vip_6router_5queue_Queue *)__pyx_v_frames->__pyx_vtab)->append(__pyx_v_frames, ((void *)__pyx_v_empty)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 179, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "volttron/platform/vip/router/routercy.pyx":180
 * 
 *         frames.append(<void*>empty)
 *         frames.append(<void*>empty)             # <<<<<<<<<<<<<<
 *         frames.append(<void*>vipframe)
 *         frames.append(<void*>empty)
 */
  __pyx_t_1 = ((struct __pyx_vtabstruct_8volttron_8platform_3vip_6router_5queue_Queue *)__pyx_v_frames->__pyx_vtab)->append(__pyx_v_frames, ((void *)__pyx_v_empty)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 180, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "volttron/platform/vip/router/routercy.pyx":181
 *         frames.append(<void*>empty)
 *         frames.append(<void*>empty)
 *         frames.append(<void*>vipframe)             # <<<<<<<<<<<<<<
 *         frames.append(<void*>empty)
 *         frames.append(<void*>empty)
 */
  __pyx_t_1 = ((struct __pyx_vtabstruct_8volttron_8platform_3vip_6router_5queue_Queue *)__pyx_v_frames->__pyx_vtab)->append(__pyx_v_frames, ((void *)__pyx_v_vipframe)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 181, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "volttron/platform/vip/router/routercy.pyx":182
 *         frames.append(<void*>empty)
 *         frames.append(<void*>vipframe)
 *         frames.append(<void*>empty)             # <<<<<<<<<<<<<<
 *         frames.append(<void*>empty)
 *         asbuffer_r(subsys, <void **>&subsys_data, &data_len_c)
 */
  __pyx_t_1 = ((struct __pyx_vtabstruct_8volttron_8platform_3vip_6router_5queue_Queue *)__pyx_v_frames->__pyx_vtab)->append(__pyx_v_frames, ((void *)__pyx_v_empty)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 182, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "volttron/platform/vip/router/routercy.pyx":183
 *         frames.append(<void*>vipframe)
 *         frames.append(<void*>empty)
 *         frames.append(<void*>empty)             # <<<<<<<<<<<<<<
 *         asbuffer_r(subsys, <void **>&subsys_data, &data_len_c)
 *         asbuffer_r(cmd, <void **>&cmd_data, &data_len_c)
 */
  __pyx_t_1 = ((struct __pyx_vtabstruct_8volttron_8platform_3vip_6router_5queue_Queue *)__pyx_v_frames->__pyx_vtab)->append(__pyx_v_frames, ((void *)__pyx_v_empty)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 183, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "volttron/platform/vip/router/routercy.pyx":184
 *         frames.append(<void*>empty)
 *         frames.append(<void*>empty)
 *         asbuffer_r(subsys, <void **>&subsys_data, &data_len_c)             # <<<<<<<<<<<<<<
 *         asbuffer_r(cmd, <void **>&cmd_data, &data_len_c)
 *         asbuffer_r(peer, <void **>&peer_data, &data_len_c)
 */
  __pyx_t_1 = __pyx_f_3zmq_5utils_7buffers_asbuffer_r(__pyx_v_subsys, ((void **)(&__pyx_v_subsys_data)), (&__pyx_v_data_len_c)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 184, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "volttron/platform/vip/router/routercy.pyx":185
 *         frames.append(<void*>empty)
 *         asbuffer_r(subsys, <void **>&subsys_data, &data_len_c)
 *         asbuffer_r(cmd, <void **>&cmd_data, &data_len_c)             # <<<<<<<<<<<<<<
 *         asbuffer_r(peer, <void **>&peer_data, &data_len_c)
 *         sysdata = cymessage.Frame(subsys_data)
 */
  __pyx_t_1 = __pyx_f_3zmq_5utils_7buffers_asbuffer_r(__pyx_v_cmd, ((void **)(&__pyx_v_cmd_data)), (&__pyx_v_data_len_c)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 185, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "volttron/platform/vip/router/routercy.pyx":186
 *         asbuffer_r(subsys, <void **>&subsys_data, &data_len_c)
 *         asbuffer_r(cmd, <void **>&cmd_data, &data_len_c)
 *         asbuffer_r(peer, <void **>&peer_data, &data_len_c)             # <<<<<<<<<<<<<<
 *         sysdata = cymessage.Frame(subsys_data)
 *         cmdata = cymessage.Frame(cmd_data)
 */
  __pyx_t_1 = __pyx_convert_PyBytes_string_to_py_std__in_string(__pyx_v_peer); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 186, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __pyx_f_3zmq_5utils_7buffers_asbuffer_r(__pyx_t_1, ((void **)(&__pyx_v_peer_data)), (&__pyx_v_data_len_c)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 186, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "volttron/platform/vip/router/routercy.pyx":187
 *         asbuffer_r(cmd, <void **>&cmd_data, &data_len_c)
 *         asbuffer_r(peer, <void **>&peer_data, &data_len_c)
 *         sysdata = cymessage.Frame(subsys_data)             # <<<<<<<<<<<<<<
 *         cmdata = cymessage.Frame(cmd_data)
 *         prdata = cymessage.Frame(peer_data)
 */
  __pyx_t_2 = __Pyx_PyBytes_FromString(__pyx_v_subsys_data); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 187, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 187, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_GIVEREF(__pyx_t_2);
  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_8volttron_8platform_3vip_6router_9cymessage_Frame), __pyx_t_1, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 187, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_sysdata = ((struct __pyx_obj_8volttron_8platform_3vip_6router_9cymessage_Frame *)__pyx_t_2);
  __pyx_t_2 = 0;

  /* "volttron/platform/vip/router/routercy.pyx":188
 *         asbuffer_r(peer, <void **>&peer_data, &data_len_c)
 *         sysdata = cymessage.Frame(subsys_data)
 *         cmdata = cymessage.Frame(cmd_data)             # <<<<<<<<<<<<<<
 *         prdata = cymessage.Frame(peer_data)
 * 
 */
  __pyx_t_2 = __Pyx_PyBytes_FromString(__pyx_v_cmd_data); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 188, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 188, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_GIVEREF(__pyx_t_2);
  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_8volttron_8platform_3vip_6router_9cymessage_Frame), __pyx_t_1, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 188, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_cmdata = ((struct __pyx_obj_8volttron_8platform_3vip_6router_9cymessage_Frame *)__pyx_t_2);
  __pyx_t_2 = 0;

  /* "volttron/platform/vip/router/routercy.pyx":189
 *         sysdata = cymessage.Frame(subsys_data)
 *         cmdata = cymessage.Frame(cmd_data)
 *         prdata = cymessage.Frame(peer_data)             # <<<<<<<<<<<<<<
 * 
 *         frames.append(<void*>sysdata)
 */
  __pyx_t_2 = __Pyx_PyBytes_FromString(__pyx_v_peer_data); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 189, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 189, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_GIVEREF(__pyx_t_2);
  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_8volttron_8platform_3vip_6router_9cymessage_Frame), __pyx_t_1, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 189, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_prdata = ((struct __pyx_obj_8volttron_8platform_3vip_6router_9cymessage_Frame *)__pyx_t_2);
  __pyx_t_2 = 0;

  /* "volttron/platform/vip/router/routercy.pyx":191
 *         prdata = cymessage.Frame(peer_data)
 * 
 *         frames.append(<void*>sysdata)             # <<<<<<<<<<<<<<
 *         frames.append(<void*>cmdata)
 *         frames.append(<void*>prdata)
 */
  __pyx_t_2 = ((struct __pyx_vtabstruct_8volttron_8platform_3vip_6router_5queue_Queue *)__pyx_v_frames->__pyx_vtab)->append(__pyx_v_frames, ((void *)__pyx_v_sysdata)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 191, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "volttron/platform/vip/router/routercy.pyx":192
 * 
 *         frames.append(<void*>sysdata)
 *         frames.append(<void*>cmdata)             # <<<<<<<<<<<<<<
 *         frames.append(<void*>prdata)
 *         #frames.extend(Frame(f) for f in parts)
 */
  __pyx_t_2 = ((struct __pyx_vtabstruct_8volttron_8platform_3vip_6router_5queue_Queue *)__pyx_v_frames->__pyx_vtab)->append(__pyx_v_frames, ((void *)__pyx_v_cmdata)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 192, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "volttron/platform/vip/router/routercy.pyx":193
 *         frames.append(<void*>sysdata)
 *         frames.append(<void*>cmdata)
 *         frames.append(<void*>prdata)             # <<<<<<<<<<<<<<
 *         #frames.extend(Frame(f) for f in parts)
 *         #Send frames to all peers and drop it later
 */
  __pyx_t_2 = ((struct __pyx_vtabstruct_8volttron_8platform_3vip_6router_5queue_Queue *)__pyx_v_frames->__pyx_vtab)->append(__pyx_v_frames, ((void *)__pyx_v_prdata)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 193, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "volttron/platform/vip/router/routercy.pyx":196
 *         #frames.extend(Frame(f) for f in parts)
 *         #Send frames to all peers and drop it later
 *         while(it != end):             # <<<<<<<<<<<<<<
 *             pr = dereference(it)
 *             frames[0] = peer
 */
  while (1) {
    __pyx_t_3 = ((__pyx_v_it != __pyx_v_end) != 0);
    if (!__pyx_t_3) break;

    /* "volttron/platform/vip/router/routercy.pyx":197
 *         #Send frames to all peers and drop it later
 *         while(it != end):
 *             pr = dereference(it)             # <<<<<<<<<<<<<<
 *             frames[0] = peer
 *             peerlist = self._send(frames)
 */
    __pyx_v_pr = (*__pyx_v_it);

    /* "volttron/platform/vip/router/routercy.pyx":198
 *         while(it != end):
 *             pr = dereference(it)
 *             frames[0] = peer             # <<<<<<<<<<<<<<
 *             peerlist = self._send(frames)
 *             it1 = peerlist.begin()
 */
    __pyx_t_2 = __pyx_convert_PyBytes_string_to_py_std__in_string(__pyx_v_peer); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 198, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    if (unlikely(__Pyx_SetItemInt(((PyObject *)__pyx_v_frames), 0, __pyx_t_2, long, 1, __Pyx_PyInt_From_long, 0, 0, 1) < 0)) __PYX_ERR(0, 198, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

    /* "volttron/platform/vip/router/routercy.pyx":199
 *             pr = dereference(it)
 *             frames[0] = peer
 *             peerlist = self._send(frames)             # <<<<<<<<<<<<<<
 *             it1 = peerlist.begin()
 *             while(it1 != peerlist.end()):
 */
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_8volttron_8platform_3vip_6router_8routercy_BaseRouter *)__pyx_v_self->__pyx_vtab)->_send(__pyx_v_self, __pyx_v_frames, 0)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 199, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_4 = __pyx_convert_vector_from_py_std_3a__3a_string(__pyx_t_2); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 199, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_v_peerlist = __pyx_t_4;

    /* "volttron/platform/vip/router/routercy.pyx":200
 *             frames[0] = peer
 *             peerlist = self._send(frames)
 *             it1 = peerlist.begin()             # <<<<<<<<<<<<<<
 *             while(it1 != peerlist.end()):
 *                 drop.insert(dereference(it1))
 */
    __pyx_v_it1 = __pyx_v_peerlist.begin();

    /* "volttron/platform/vip/router/routercy.pyx":201
 *             peerlist = self._send(frames)
 *             it1 = peerlist.begin()
 *             while(it1 != peerlist.end()):             # <<<<<<<<<<<<<<
 *                 drop.insert(dereference(it1))
 *                 preincrement(it1)
 */
    while (1) {
      __pyx_t_3 = ((__pyx_v_it1 != __pyx_v_peerlist.end()) != 0);
      if (!__pyx_t_3) break;

      /* "volttron/platform/vip/router/routercy.pyx":202
 *             it1 = peerlist.begin()
 *             while(it1 != peerlist.end()):
 *                 drop.insert(dereference(it1))             # <<<<<<<<<<<<<<
 *                 preincrement(it1)
 *             preincrement(it)
 */
      try {
        __pyx_v_drop.insert((*__pyx_v_it1));
      } catch(...) {
        __Pyx_CppExn2PyErr();
        __PYX_ERR(0, 202, __pyx_L1_error)
      }

      /* "volttron/platform/vip/router/routercy.pyx":203
 *             while(it1 != peerlist.end()):
 *                 drop.insert(dereference(it1))
 *                 preincrement(it1)             # <<<<<<<<<<<<<<
 *             preincrement(it)
 * 
 */
      (++__pyx_v_it1);
    }

    /* "volttron/platform/vip/router/routercy.pyx":204
 *                 drop.insert(dereference(it1))
 *                 preincrement(it1)
 *             preincrement(it)             # <<<<<<<<<<<<<<
 * 
 *         dit = drop.begin()
 */
    (++__pyx_v_it);
  }

  /* "volttron/platform/vip/router/routercy.pyx":206
 *             preincrement(it)
 * 
 *         dit = drop.begin()             # <<<<<<<<<<<<<<
 * 
 *         while(dit != drop.end()):
 */
  __pyx_v_dit = __pyx_v_drop.begin();

  /* "volttron/platform/vip/router/routercy.pyx":208
 *         dit = drop.begin()
 * 
 *         while(dit != drop.end()):             # <<<<<<<<<<<<<<
 *             peer = dereference(dit)
 *             self._drop_peer(peer)
 */
  while (1) {
    __pyx_t_3 = ((__pyx_v_dit != __pyx_v_drop.end()) != 0);
    if (!__pyx_t_3) break;

    /* "volttron/platform/vip/router/routercy.pyx":209
 * 
 *         while(dit != drop.end()):
 *             peer = dereference(dit)             # <<<<<<<<<<<<<<
 *             self._drop_peer(peer)
 *             preincrement(dit)
 */
    __pyx_v_peer = (*__pyx_v_dit);

    /* "volttron/platform/vip/router/routercy.pyx":210
 *         while(dit != drop.end()):
 *             peer = dereference(dit)
 *             self._drop_peer(peer)             # <<<<<<<<<<<<<<
 *             preincrement(dit)
 * 
 */
    __pyx_t_2 = ((struct __pyx_vtabstruct_8volttron_8platform_3vip_6router_8routercy_BaseRouter *)__pyx_v_self->__pyx_vtab)->_drop_peer(__pyx_v_self, __pyx_v_peer, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 210, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

    /* "volttron/platform/vip/router/routercy.pyx":211
 *             peer = dereference(dit)
 *             self._drop_peer(peer)
 *             preincrement(dit)             # <<<<<<<<<<<<<<
 * 
 *     cpdef _add_peer(self, string peer):
 */
    (++__pyx_v_dit);
  }

  /* "volttron/platform/vip/router/routercy.pyx":160
 *             return self.default_user_id
 * 
 *     cdef _distribute(self, bytes subsys, bytes cmd, string peer):             # <<<<<<<<<<<<<<
 *         cdef:
 *             set[string] drop
 */

  /* function exit code */
  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("volttron.platform.vip.router.routercy.BaseRouter._distribute", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __Pyx_XDECREF((PyObject *)__pyx_v_empty);
  __Pyx_XDECREF((PyObject *)__pyx_v_frames);
  __Pyx_XDECREF((PyObject *)__pyx_v_vipframe);
  __Pyx_XDECREF((PyObject *)__pyx_v_sysdata);
  __Pyx_XDECREF((PyObject *)__pyx_v_cmdata);
  __Pyx_XDECREF((PyObject *)__pyx_v_prdata);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "volttron/platform/vip/router/routercy.pyx":213
 *             preincrement(dit)
 * 
 *     cpdef _add_peer(self, string peer):             # <<<<<<<<<<<<<<
 *         cdef:
 *             set[string].iterator end = self._peers.end()
 */

static PyObject *__pyx_pw_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_21_add_peer(PyObject *__pyx_v_self, PyObject *__pyx_arg_peer); /*proto*/
static PyObject *__pyx_f_8volttron_8platform_3vip_6router_8routercy_10BaseRouter__add_peer(struct __pyx_obj_8volttron_8platform_3vip_6router_8routercy_BaseRouter *__pyx_v_self, std::string __pyx_v_peer, int __pyx_skip_dispatch) {
  CYTHON_UNUSED std::set<std::string> ::iterator __pyx_v_end;
  CYTHON_UNUSED std::set<std::string> ::iterator __pyx_v_it;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  PyObject *__pyx_t_6 = NULL;
  int __pyx_t_7;
  __Pyx_RefNannySetupContext("_add_peer", 0);
  /* Check if called by wrapper */
  if (unlikely(__pyx_skip_dispatch)) ;
  /* Check if overridden in Python */
  else if (unlikely(Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0)) {
    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_add_peer); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 213, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)__pyx_pw_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_21_add_peer)) {
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_3 = __pyx_convert_PyBytes_string_to_py_std__in_string(__pyx_v_peer); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 213, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_INCREF(__pyx_t_1);
      __pyx_t_4 = __pyx_t_1; __pyx_t_5 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_4))) {
        __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_4);
        if (likely(__pyx_t_5)) {
          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
          __Pyx_INCREF(__pyx_t_5);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_4, function);
        }
      }
      if (!__pyx_t_5) {
        __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 213, __pyx_L1_error)
        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
        __Pyx_GOTREF(__pyx_t_2);
      } else {
        __pyx_t_6 = PyTuple_New(1+1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 213, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_6);
        __Pyx_GIVEREF(__pyx_t_5); PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_5); __pyx_t_5 = NULL;
        __Pyx_GIVEREF(__pyx_t_3);
        PyTuple_SET_ITEM(__pyx_t_6, 0+1, __pyx_t_3);
        __pyx_t_3 = 0;
        __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_6, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 213, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
      }
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_r = __pyx_t_2;
      __pyx_t_2 = 0;
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      goto __pyx_L0;
    }
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  }

  /* "volttron/platform/vip/router/routercy.pyx":215
 *     cpdef _add_peer(self, string peer):
 *         cdef:
 *             set[string].iterator end = self._peers.end()             # <<<<<<<<<<<<<<
 *             set[string].iterator it = self._peers.begin()
 * 
 */
  __pyx_v_end = __pyx_v_self->_peers.end();

  /* "volttron/platform/vip/router/routercy.pyx":216
 *         cdef:
 *             set[string].iterator end = self._peers.end()
 *             set[string].iterator it = self._peers.begin()             # <<<<<<<<<<<<<<
 * 
 *         if(self._peers.find(peer) == self._peers.end()):
 */
  __pyx_v_it = __pyx_v_self->_peers.begin();

  /* "volttron/platform/vip/router/routercy.pyx":218
 *             set[string].iterator it = self._peers.begin()
 * 
 *         if(self._peers.find(peer) == self._peers.end()):             # <<<<<<<<<<<<<<
 *             return
 *         self._distribute(b'peerlist', b'add', peer)
 */
  __pyx_t_7 = ((__pyx_v_self->_peers.find(__pyx_v_peer) == __pyx_v_self->_peers.end()) != 0);
  if (__pyx_t_7) {

    /* "volttron/platform/vip/router/routercy.pyx":219
 * 
 *         if(self._peers.find(peer) == self._peers.end()):
 *             return             # <<<<<<<<<<<<<<
 *         self._distribute(b'peerlist', b'add', peer)
 *         self._peers.insert(peer)
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;

    /* "volttron/platform/vip/router/routercy.pyx":218
 *             set[string].iterator it = self._peers.begin()
 * 
 *         if(self._peers.find(peer) == self._peers.end()):             # <<<<<<<<<<<<<<
 *             return
 *         self._distribute(b'peerlist', b'add', peer)
 */
  }

  /* "volttron/platform/vip/router/routercy.pyx":220
 *         if(self._peers.find(peer) == self._peers.end()):
 *             return
 *         self._distribute(b'peerlist', b'add', peer)             # <<<<<<<<<<<<<<
 *         self._peers.insert(peer)
 * 
 */
  __pyx_t_1 = ((struct __pyx_vtabstruct_8volttron_8platform_3vip_6router_8routercy_BaseRouter *)__pyx_v_self->__pyx_vtab)->_distribute(__pyx_v_self, __pyx_n_b_peerlist, __pyx_n_b_add, __pyx_v_peer); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 220, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "volttron/platform/vip/router/routercy.pyx":221
 *             return
 *         self._distribute(b'peerlist', b'add', peer)
 *         self._peers.insert(peer)             # <<<<<<<<<<<<<<
 * 
 *     cpdef _drop_peer(self, string peer):
 */
  try {
    __pyx_v_self->_peers.insert(__pyx_v_peer);
  } catch(...) {
    __Pyx_CppExn2PyErr();
    __PYX_ERR(0, 221, __pyx_L1_error)
  }

  /* "volttron/platform/vip/router/routercy.pyx":213
 *             preincrement(dit)
 * 
 *     cpdef _add_peer(self, string peer):             # <<<<<<<<<<<<<<
 *         cdef:
 *             set[string].iterator end = self._peers.end()
 */

  /* function exit code */
  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_AddTraceback("volttron.platform.vip.router.routercy.BaseRouter._add_peer", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_21_add_peer(PyObject *__pyx_v_self, PyObject *__pyx_arg_peer); /*proto*/
static PyObject *__pyx_pw_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_21_add_peer(PyObject *__pyx_v_self, PyObject *__pyx_arg_peer) {
  std::string __pyx_v_peer;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("_add_peer (wrapper)", 0);
  assert(__pyx_arg_peer); {
    __pyx_v_peer = __pyx_convert_string_from_py_std__in_string(__pyx_arg_peer); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 213, __pyx_L3_error)
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  __Pyx_AddTraceback("volttron.platform.vip.router.routercy.BaseRouter._add_peer", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_20_add_peer(((struct __pyx_obj_8volttron_8platform_3vip_6router_8routercy_BaseRouter *)__pyx_v_self), ((std::string)__pyx_v_peer));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_20_add_peer(struct __pyx_obj_8volttron_8platform_3vip_6router_8routercy_BaseRouter *__pyx_v_self, std::string __pyx_v_peer) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  __Pyx_RefNannySetupContext("_add_peer", 0);
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = __pyx_f_8volttron_8platform_3vip_6router_8routercy_10BaseRouter__add_peer(__pyx_v_self, __pyx_v_peer, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 213, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("volttron.platform.vip.router.routercy.BaseRouter._add_peer", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "volttron/platform/vip/router/routercy.pyx":223
 *         self._peers.insert(peer)
 * 
 *     cpdef _drop_peer(self, string peer):             # <<<<<<<<<<<<<<
 *         if (self._peers.find(peer) == self._peers.end()):
 *             self._peers.erase(self._peers.find(peer))
 */

static PyObject *__pyx_pw_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_23_drop_peer(PyObject *__pyx_v_self, PyObject *__pyx_arg_peer); /*proto*/
static PyObject *__pyx_f_8volttron_8platform_3vip_6router_8routercy_10BaseRouter__drop_peer(struct __pyx_obj_8volttron_8platform_3vip_6router_8routercy_BaseRouter *__pyx_v_self, std::string __pyx_v_peer, int __pyx_skip_dispatch) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  PyObject *__pyx_t_6 = NULL;
  int __pyx_t_7;
  __Pyx_RefNannySetupContext("_drop_peer", 0);
  /* Check if called by wrapper */
  if (unlikely(__pyx_skip_dispatch)) ;
  /* Check if overridden in Python */
  else if (unlikely(Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0)) {
    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_drop_peer); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 223, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)__pyx_pw_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_23_drop_peer)) {
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_3 = __pyx_convert_PyBytes_string_to_py_std__in_string(__pyx_v_peer); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 223, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_INCREF(__pyx_t_1);
      __pyx_t_4 = __pyx_t_1; __pyx_t_5 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_4))) {
        __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_4);
        if (likely(__pyx_t_5)) {
          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
          __Pyx_INCREF(__pyx_t_5);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_4, function);
        }
      }
      if (!__pyx_t_5) {
        __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 223, __pyx_L1_error)
        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
        __Pyx_GOTREF(__pyx_t_2);
      } else {
        __pyx_t_6 = PyTuple_New(1+1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 223, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_6);
        __Pyx_GIVEREF(__pyx_t_5); PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_5); __pyx_t_5 = NULL;
        __Pyx_GIVEREF(__pyx_t_3);
        PyTuple_SET_ITEM(__pyx_t_6, 0+1, __pyx_t_3);
        __pyx_t_3 = 0;
        __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_6, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 223, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
      }
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_r = __pyx_t_2;
      __pyx_t_2 = 0;
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      goto __pyx_L0;
    }
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  }

  /* "volttron/platform/vip/router/routercy.pyx":224
 * 
 *     cpdef _drop_peer(self, string peer):
 *         if (self._peers.find(peer) == self._peers.end()):             # <<<<<<<<<<<<<<
 *             self._peers.erase(self._peers.find(peer))
 *         self._distribute(b'peerlist', b'drop', peer)
 */
  __pyx_t_7 = ((__pyx_v_self->_peers.find(__pyx_v_peer) == __pyx_v_self->_peers.end()) != 0);
  if (__pyx_t_7) {

    /* "volttron/platform/vip/router/routercy.pyx":225
 *     cpdef _drop_peer(self, string peer):
 *         if (self._peers.find(peer) == self._peers.end()):
 *             self._peers.erase(self._peers.find(peer))             # <<<<<<<<<<<<<<
 *         self._distribute(b'peerlist', b'drop', peer)
 * 
 */
    __pyx_v_self->_peers.erase(__pyx_v_self->_peers.find(__pyx_v_peer));

    /* "volttron/platform/vip/router/routercy.pyx":224
 * 
 *     cpdef _drop_peer(self, string peer):
 *         if (self._peers.find(peer) == self._peers.end()):             # <<<<<<<<<<<<<<
 *             self._peers.erase(self._peers.find(peer))
 *         self._distribute(b'peerlist', b'drop', peer)
 */
  }

  /* "volttron/platform/vip/router/routercy.pyx":226
 *         if (self._peers.find(peer) == self._peers.end()):
 *             self._peers.erase(self._peers.find(peer))
 *         self._distribute(b'peerlist', b'drop', peer)             # <<<<<<<<<<<<<<
 * 
 *     cpdef route(self):
 */
  __pyx_t_1 = ((struct __pyx_vtabstruct_8volttron_8platform_3vip_6router_8routercy_BaseRouter *)__pyx_v_self->__pyx_vtab)->_distribute(__pyx_v_self, __pyx_n_b_peerlist, __pyx_n_b_drop, __pyx_v_peer); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 226, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "volttron/platform/vip/router/routercy.pyx":223
 *         self._peers.insert(peer)
 * 
 *     cpdef _drop_peer(self, string peer):             # <<<<<<<<<<<<<<
 *         if (self._peers.find(peer) == self._peers.end()):
 *             self._peers.erase(self._peers.find(peer))
 */

  /* function exit code */
  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_AddTraceback("volttron.platform.vip.router.routercy.BaseRouter._drop_peer", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_23_drop_peer(PyObject *__pyx_v_self, PyObject *__pyx_arg_peer); /*proto*/
static PyObject *__pyx_pw_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_23_drop_peer(PyObject *__pyx_v_self, PyObject *__pyx_arg_peer) {
  std::string __pyx_v_peer;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("_drop_peer (wrapper)", 0);
  assert(__pyx_arg_peer); {
    __pyx_v_peer = __pyx_convert_string_from_py_std__in_string(__pyx_arg_peer); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 223, __pyx_L3_error)
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  __Pyx_AddTraceback("volttron.platform.vip.router.routercy.BaseRouter._drop_peer", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_22_drop_peer(((struct __pyx_obj_8volttron_8platform_3vip_6router_8routercy_BaseRouter *)__pyx_v_self), ((std::string)__pyx_v_peer));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_22_drop_peer(struct __pyx_obj_8volttron_8platform_3vip_6router_8routercy_BaseRouter *__pyx_v_self, std::string __pyx_v_peer) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  __Pyx_RefNannySetupContext("_drop_peer", 0);
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = __pyx_f_8volttron_8platform_3vip_6router_8routercy_10BaseRouter__drop_peer(__pyx_v_self, __pyx_v_peer, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 223, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("volttron.platform.vip.router.routercy.BaseRouter._drop_peer", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "volttron/platform/vip/router/routercy.pyx":228
 *         self._distribute(b'peerlist', b'drop', peer)
 * 
 *     cpdef route(self):             # <<<<<<<<<<<<<<
 *         '''Route one message and return.
 * 
 */

static PyObject *__pyx_pw_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_25route(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyObject *__pyx_f_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_route(struct __pyx_obj_8volttron_8platform_3vip_6router_8routercy_BaseRouter *__pyx_v_self, int __pyx_skip_dispatch) {
  struct __pyx_obj_8volttron_8platform_3vip_6router_8cysocket_Socket *__pyx_v_socket = 0;
  PyObject *__pyx_v_issue = 0;
  struct __pyx_obj_8volttron_8platform_3vip_6router_5queue_Queue *__pyx_v_frames = 0;
  struct __pyx_obj_8volttron_8platform_3vip_6router_9cymessage_Frame *__pyx_v_sender = 0;
  struct __pyx_obj_8volttron_8platform_3vip_6router_9cymessage_Frame *__pyx_v_recipient = 0;
  struct __pyx_obj_8volttron_8platform_3vip_6router_9cymessage_Frame *__pyx_v_proto = 0;
  CYTHON_UNUSED struct __pyx_obj_8volttron_8platform_3vip_6router_9cymessage_Frame *__pyx_v_auth_token = 0;
  struct __pyx_obj_8volttron_8platform_3vip_6router_9cymessage_Frame *__pyx_v_msg_id = 0;
  struct __pyx_obj_8volttron_8platform_3vip_6router_9cymessage_Frame *__pyx_v_name = 0;
  struct __pyx_obj_8volttron_8platform_3vip_6router_9cymessage_Frame *__pyx_v_hello = 0;
  struct __pyx_obj_8volttron_8platform_3vip_6router_9cymessage_Frame *__pyx_v_welcome = 0;
  struct __pyx_obj_8volttron_8platform_3vip_6router_9cymessage_Frame *__pyx_v_ping = 0;
  struct __pyx_obj_8volttron_8platform_3vip_6router_9cymessage_Frame *__pyx_v_pong = 0;
  struct __pyx_obj_8volttron_8platform_3vip_6router_9cymessage_Frame *__pyx_v_temp = 0;
  struct __pyx_obj_8volttron_8platform_3vip_6router_9cymessage_Frame *__pyx_v_ver = 0;
  struct __pyx_obj_8volttron_8platform_3vip_6router_9cymessage_Frame *__pyx_v_err = 0;
  struct __pyx_obj_8volttron_8platform_3vip_6router_9cymessage_Frame *__pyx_v_errnum = 0;
  struct __pyx_obj_8volttron_8platform_3vip_6router_9cymessage_Frame *__pyx_v_errmsg = 0;
  struct __pyx_obj_8volttron_8platform_3vip_6router_9cymessage_Frame *__pyx_v_subsystem = 0;
  struct __pyx_obj_8volttron_8platform_3vip_6router_9cymessage_Frame *__pyx_v_opr = 0;
  std::vector<std::string>  __pyx_v_peerlist;
  std::vector<std::string> ::iterator __pyx_v_it;
  std::string __pyx_v_peer;
  PyObject *__pyx_v_op = NULL;
  PyObject *__pyx_v_listing = NULL;
  PyObject *__pyx_v_error = NULL;
  PyObject *__pyx_v_response = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  Py_ssize_t __pyx_t_5;
  PyObject *__pyx_t_6 = NULL;
  int __pyx_t_7;
  int __pyx_t_8;
  int __pyx_t_9;
  std::string __pyx_t_10;
  void *__pyx_t_11;
  PyObject *__pyx_t_12 = NULL;
  PyObject *__pyx_t_13 = NULL;
  PyObject *__pyx_t_14 = NULL;
  int __pyx_t_15;
  PyObject *(*__pyx_t_16)(PyObject *);
  std::vector<std::string>  __pyx_t_17;
  __Pyx_RefNannySetupContext("route", 0);
  /* Check if called by wrapper */
  if (unlikely(__pyx_skip_dispatch)) ;
  /* Check if overridden in Python */
  else if (unlikely(Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0)) {
    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_route); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 228, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)__pyx_pw_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_25route)) {
      __Pyx_XDECREF(__pyx_r);
      __Pyx_INCREF(__pyx_t_1);
      __pyx_t_3 = __pyx_t_1; __pyx_t_4 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_3))) {
        __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
        if (likely(__pyx_t_4)) {
          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
          __Pyx_INCREF(__pyx_t_4);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_3, function);
        }
      }
      if (__pyx_t_4) {
        __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 228, __pyx_L1_error)
        __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      } else {
        __pyx_t_2 = __Pyx_PyObject_CallNoArg(__pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 228, __pyx_L1_error)
      }
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_r = __pyx_t_2;
      __pyx_t_2 = 0;
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      goto __pyx_L0;
    }
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  }

  /* "volttron/platform/vip/router/routercy.pyx":241
 *             object issue
 *             #object frames
 *             Queue frames = Queue()             # <<<<<<<<<<<<<<
 *             cdef cymessage.Frame sender, recipient, proto, auth_token, msg_id, name
 *             cdef cymessage.Frame hello, welcome, ping, pong, temp, ver, err, errnum
 */
  __pyx_t_1 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_8volttron_8platform_3vip_6router_5queue_Queue), __pyx_empty_tuple, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 241, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_frames = ((struct __pyx_obj_8volttron_8platform_3vip_6router_5queue_Queue *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "volttron/platform/vip/router/routercy.pyx":249
 *             string peer
 * 
 *         socket = self.socket             # <<<<<<<<<<<<<<
 *         issue = self.issue
 *         # Expecting incoming frames:
 */
  __pyx_t_1 = ((PyObject *)__pyx_v_self->socket);
  __Pyx_INCREF(__pyx_t_1);
  __pyx_v_socket = ((struct __pyx_obj_8volttron_8platform_3vip_6router_8cysocket_Socket *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "volttron/platform/vip/router/routercy.pyx":250
 * 
 *         socket = self.socket
 *         issue = self.issue             # <<<<<<<<<<<<<<
 *         # Expecting incoming frames:
 *         #   [SENDER, RECIPIENT, PROTO, USER_ID, MSG_ID, SUBSYS, ...]
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_issue); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 250, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_issue = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "volttron/platform/vip/router/routercy.pyx":253
 *         # Expecting incoming frames:
 *         #   [SENDER, RECIPIENT, PROTO, USER_ID, MSG_ID, SUBSYS, ...]
 *         frames = socket.recv_multipart(copy=False)             # <<<<<<<<<<<<<<
 *         issue(self.INCOMING, frames)
 *         if frames.size() < 6:
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_socket), __pyx_n_s_recv_multipart); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 253, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = PyDict_New(); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 253, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_copy, Py_False) < 0) __PYX_ERR(0, 253, __pyx_L1_error)
  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_empty_tuple, __pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 253, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_8volttron_8platform_3vip_6router_5queue_Queue))))) __PYX_ERR(0, 253, __pyx_L1_error)
  __Pyx_DECREF_SET(__pyx_v_frames, ((struct __pyx_obj_8volttron_8platform_3vip_6router_5queue_Queue *)__pyx_t_3));
  __pyx_t_3 = 0;

  /* "volttron/platform/vip/router/routercy.pyx":254
 *         #   [SENDER, RECIPIENT, PROTO, USER_ID, MSG_ID, SUBSYS, ...]
 *         frames = socket.recv_multipart(copy=False)
 *         issue(self.INCOMING, frames)             # <<<<<<<<<<<<<<
 *         if frames.size() < 6:
 *             # Cannot route if there are insufficient frames, such as
 */
  __pyx_t_2 = __Pyx_PyInt_From_int(__pyx_v_self->INCOMING); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 254, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_INCREF(__pyx_v_issue);
  __pyx_t_1 = __pyx_v_issue; __pyx_t_4 = NULL;
  __pyx_t_5 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_1))) {
    __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_1);
    if (likely(__pyx_t_4)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
      __Pyx_INCREF(__pyx_t_4);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_1, function);
      __pyx_t_5 = 1;
    }
  }
  __pyx_t_6 = PyTuple_New(2+__pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 254, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  if (__pyx_t_4) {
    __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_4); __pyx_t_4 = NULL;
  }
  __Pyx_GIVEREF(__pyx_t_2);
  PyTuple_SET_ITEM(__pyx_t_6, 0+__pyx_t_5, __pyx_t_2);
  __Pyx_INCREF(((PyObject *)__pyx_v_frames));
  __Pyx_GIVEREF(((PyObject *)__pyx_v_frames));
  PyTuple_SET_ITEM(__pyx_t_6, 1+__pyx_t_5, ((PyObject *)__pyx_v_frames));
  __pyx_t_2 = 0;
  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_6, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 254, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

  /* "volttron/platform/vip/router/routercy.pyx":255
 *         frames = socket.recv_multipart(copy=False)
 *         issue(self.INCOMING, frames)
 *         if frames.size() < 6:             # <<<<<<<<<<<<<<
 *             # Cannot route if there are insufficient frames, such as
 *             # might happen with a router probe.
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_frames), __pyx_n_s_size); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 255, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_6 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_1))) {
    __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_1);
    if (likely(__pyx_t_6)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
      __Pyx_INCREF(__pyx_t_6);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_1, function);
    }
  }
  if (__pyx_t_6) {
    __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_t_6); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 255, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  } else {
    __pyx_t_3 = __Pyx_PyObject_CallNoArg(__pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 255, __pyx_L1_error)
  }
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = PyObject_RichCompare(__pyx_t_3, __pyx_int_6, Py_LT); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 255, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_7 < 0)) __PYX_ERR(0, 255, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (__pyx_t_7) {

    /* "volttron/platform/vip/router/routercy.pyx":259
 *             # might happen with a router probe.
 *             #if len(frames) == 2 and frames[0] and not frames[1]:
 *             if frames.size() == 2 and frames[0] and not frames[1]:             # <<<<<<<<<<<<<<
 *                 issue(self.UNROUTABLE, frames, 'router probe')
 *                 self._add_peer(frames[0].bytes)
 */
    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_frames), __pyx_n_s_size); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 259, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_6 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_3))) {
      __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_3);
      if (likely(__pyx_t_6)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
        __Pyx_INCREF(__pyx_t_6);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_3, function);
      }
    }
    if (__pyx_t_6) {
      __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 259, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    } else {
      __pyx_t_1 = __Pyx_PyObject_CallNoArg(__pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 259, __pyx_L1_error)
    }
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = __Pyx_PyInt_EqObjC(__pyx_t_1, __pyx_int_2, 2, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 259, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_8 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_8 < 0)) __PYX_ERR(0, 259, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    if (__pyx_t_8) {
    } else {
      __pyx_t_7 = __pyx_t_8;
      goto __pyx_L5_bool_binop_done;
    }
    __pyx_t_3 = __Pyx_GetItemInt(((PyObject *)__pyx_v_frames), 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 259, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_8 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_8 < 0)) __PYX_ERR(0, 259, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    if (__pyx_t_8) {
    } else {
      __pyx_t_7 = __pyx_t_8;
      goto __pyx_L5_bool_binop_done;
    }
    __pyx_t_3 = __Pyx_GetItemInt(((PyObject *)__pyx_v_frames), 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 259, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_8 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_8 < 0)) __PYX_ERR(0, 259, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_9 = ((!__pyx_t_8) != 0);
    __pyx_t_7 = __pyx_t_9;
    __pyx_L5_bool_binop_done:;
    if (__pyx_t_7) {

      /* "volttron/platform/vip/router/routercy.pyx":260
 *             #if len(frames) == 2 and frames[0] and not frames[1]:
 *             if frames.size() == 2 and frames[0] and not frames[1]:
 *                 issue(self.UNROUTABLE, frames, 'router probe')             # <<<<<<<<<<<<<<
 *                 self._add_peer(frames[0].bytes)
 *             else:
 */
      __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_self->UNROUTABLE); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 260, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_INCREF(__pyx_v_issue);
      __pyx_t_6 = __pyx_v_issue; __pyx_t_2 = NULL;
      __pyx_t_5 = 0;
      if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_6))) {
        __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_6);
        if (likely(__pyx_t_2)) {
          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
          __Pyx_INCREF(__pyx_t_2);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_6, function);
          __pyx_t_5 = 1;
        }
      }
      __pyx_t_4 = PyTuple_New(3+__pyx_t_5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 260, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      if (__pyx_t_2) {
        __Pyx_GIVEREF(__pyx_t_2); PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_2); __pyx_t_2 = NULL;
      }
      __Pyx_GIVEREF(__pyx_t_1);
      PyTuple_SET_ITEM(__pyx_t_4, 0+__pyx_t_5, __pyx_t_1);
      __Pyx_INCREF(((PyObject *)__pyx_v_frames));
      __Pyx_GIVEREF(((PyObject *)__pyx_v_frames));
      PyTuple_SET_ITEM(__pyx_t_4, 1+__pyx_t_5, ((PyObject *)__pyx_v_frames));
      __Pyx_INCREF(__pyx_kp_s_router_probe);
      __Pyx_GIVEREF(__pyx_kp_s_router_probe);
      PyTuple_SET_ITEM(__pyx_t_4, 2+__pyx_t_5, __pyx_kp_s_router_probe);
      __pyx_t_1 = 0;
      __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_4, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 260, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

      /* "volttron/platform/vip/router/routercy.pyx":261
 *             if frames.size() == 2 and frames[0] and not frames[1]:
 *                 issue(self.UNROUTABLE, frames, 'router probe')
 *                 self._add_peer(frames[0].bytes)             # <<<<<<<<<<<<<<
 *             else:
 *                 issue(self.UNROUTABLE, frames, 'too few frames')
 */
      __pyx_t_3 = __Pyx_GetItemInt(((PyObject *)__pyx_v_frames), 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 261, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_bytes); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 261, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_6);
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_10 = __pyx_convert_string_from_py_std__in_string(__pyx_t_6); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 261, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
      __pyx_t_6 = ((struct __pyx_vtabstruct_8volttron_8platform_3vip_6router_8routercy_BaseRouter *)__pyx_v_self->__pyx_vtab)->_add_peer(__pyx_v_self, __pyx_t_10, 0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 261, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_6);
      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

      /* "volttron/platform/vip/router/routercy.pyx":259
 *             # might happen with a router probe.
 *             #if len(frames) == 2 and frames[0] and not frames[1]:
 *             if frames.size() == 2 and frames[0] and not frames[1]:             # <<<<<<<<<<<<<<
 *                 issue(self.UNROUTABLE, frames, 'router probe')
 *                 self._add_peer(frames[0].bytes)
 */
      goto __pyx_L4;
    }

    /* "volttron/platform/vip/router/routercy.pyx":263
 *                 self._add_peer(frames[0].bytes)
 *             else:
 *                 issue(self.UNROUTABLE, frames, 'too few frames')             # <<<<<<<<<<<<<<
 *             return
 * 
 */
    /*else*/ {
      __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_self->UNROUTABLE); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 263, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_INCREF(__pyx_v_issue);
      __pyx_t_4 = __pyx_v_issue; __pyx_t_1 = NULL;
      __pyx_t_5 = 0;
      if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_4))) {
        __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_4);
        if (likely(__pyx_t_1)) {
          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
          __Pyx_INCREF(__pyx_t_1);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_4, function);
          __pyx_t_5 = 1;
        }
      }
      __pyx_t_2 = PyTuple_New(3+__pyx_t_5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 263, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      if (__pyx_t_1) {
        __Pyx_GIVEREF(__pyx_t_1); PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_1); __pyx_t_1 = NULL;
      }
      __Pyx_GIVEREF(__pyx_t_3);
      PyTuple_SET_ITEM(__pyx_t_2, 0+__pyx_t_5, __pyx_t_3);
      __Pyx_INCREF(((PyObject *)__pyx_v_frames));
      __Pyx_GIVEREF(((PyObject *)__pyx_v_frames));
      PyTuple_SET_ITEM(__pyx_t_2, 1+__pyx_t_5, ((PyObject *)__pyx_v_frames));
      __Pyx_INCREF(__pyx_kp_s_too_few_frames);
      __Pyx_GIVEREF(__pyx_kp_s_too_few_frames);
      PyTuple_SET_ITEM(__pyx_t_2, 2+__pyx_t_5, __pyx_kp_s_too_few_frames);
      __pyx_t_3 = 0;
      __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_2, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 263, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_6);
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    }
    __pyx_L4:;

    /* "volttron/platform/vip/router/routercy.pyx":264
 *             else:
 *                 issue(self.UNROUTABLE, frames, 'too few frames')
 *             return             # <<<<<<<<<<<<<<
 * 
 *         sender = <cymessage.Frame>frames.pop()
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;

    /* "volttron/platform/vip/router/routercy.pyx":255
 *         frames = socket.recv_multipart(copy=False)
 *         issue(self.INCOMING, frames)
 *         if frames.size() < 6:             # <<<<<<<<<<<<<<
 *             # Cannot route if there are insufficient frames, such as
 *             # might happen with a router probe.
 */
  }

  /* "volttron/platform/vip/router/routercy.pyx":266
 *             return
 * 
 *         sender = <cymessage.Frame>frames.pop()             # <<<<<<<<<<<<<<
 *         recipient = <cymessage.Frame>frames.pop()
 *         proto= <cymessage.Frame>frames.pop()
 */
  __pyx_t_11 = ((struct __pyx_vtabstruct_8volttron_8platform_3vip_6router_5queue_Queue *)__pyx_v_frames->__pyx_vtab)->pop(__pyx_v_frames); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 266, __pyx_L1_error)
  __pyx_t_6 = ((PyObject *)__pyx_t_11);
  __Pyx_INCREF(__pyx_t_6);
  __pyx_v_sender = ((struct __pyx_obj_8volttron_8platform_3vip_6router_9cymessage_Frame *)__pyx_t_6);
  __pyx_t_6 = 0;

  /* "volttron/platform/vip/router/routercy.pyx":267
 * 
 *         sender = <cymessage.Frame>frames.pop()
 *         recipient = <cymessage.Frame>frames.pop()             # <<<<<<<<<<<<<<
 *         proto= <cymessage.Frame>frames.pop()
 *         auth_token= <cymessage.Frame>frames.pop()
 */
  __pyx_t_11 = ((struct __pyx_vtabstruct_8volttron_8platform_3vip_6router_5queue_Queue *)__pyx_v_frames->__pyx_vtab)->pop(__pyx_v_frames); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 267, __pyx_L1_error)
  __pyx_t_6 = ((PyObject *)__pyx_t_11);
  __Pyx_INCREF(__pyx_t_6);
  __pyx_v_recipient = ((struct __pyx_obj_8volttron_8platform_3vip_6router_9cymessage_Frame *)__pyx_t_6);
  __pyx_t_6 = 0;

  /* "volttron/platform/vip/router/routercy.pyx":268
 *         sender = <cymessage.Frame>frames.pop()
 *         recipient = <cymessage.Frame>frames.pop()
 *         proto= <cymessage.Frame>frames.pop()             # <<<<<<<<<<<<<<
 *         auth_token= <cymessage.Frame>frames.pop()
 *         msg_id = <cymessage.Frame>frames.pop()
 */
  __pyx_t_11 = ((struct __pyx_vtabstruct_8volttron_8platform_3vip_6router_5queue_Queue *)__pyx_v_frames->__pyx_vtab)->pop(__pyx_v_frames); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 268, __pyx_L1_error)
  __pyx_t_6 = ((PyObject *)__pyx_t_11);
  __Pyx_INCREF(__pyx_t_6);
  __pyx_v_proto = ((struct __pyx_obj_8volttron_8platform_3vip_6router_9cymessage_Frame *)__pyx_t_6);
  __pyx_t_6 = 0;

  /* "volttron/platform/vip/router/routercy.pyx":269
 *         recipient = <cymessage.Frame>frames.pop()
 *         proto= <cymessage.Frame>frames.pop()
 *         auth_token= <cymessage.Frame>frames.pop()             # <<<<<<<<<<<<<<
 *         msg_id = <cymessage.Frame>frames.pop()
 * 
 */
  __pyx_t_11 = ((struct __pyx_vtabstruct_8volttron_8platform_3vip_6router_5queue_Queue *)__pyx_v_frames->__pyx_vtab)->pop(__pyx_v_frames); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 269, __pyx_L1_error)
  __pyx_t_6 = ((PyObject *)__pyx_t_11);
  __Pyx_INCREF(__pyx_t_6);
  __pyx_v_auth_token = ((struct __pyx_obj_8volttron_8platform_3vip_6router_9cymessage_Frame *)__pyx_t_6);
  __pyx_t_6 = 0;

  /* "volttron/platform/vip/router/routercy.pyx":270
 *         proto= <cymessage.Frame>frames.pop()
 *         auth_token= <cymessage.Frame>frames.pop()
 *         msg_id = <cymessage.Frame>frames.pop()             # <<<<<<<<<<<<<<
 * 
 *         if proto.bytes() != b'VIP1':
 */
  __pyx_t_11 = ((struct __pyx_vtabstruct_8volttron_8platform_3vip_6router_5queue_Queue *)__pyx_v_frames->__pyx_vtab)->pop(__pyx_v_frames); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 270, __pyx_L1_error)
  __pyx_t_6 = ((PyObject *)__pyx_t_11);
  __Pyx_INCREF(__pyx_t_6);
  __pyx_v_msg_id = ((struct __pyx_obj_8volttron_8platform_3vip_6router_9cymessage_Frame *)__pyx_t_6);
  __pyx_t_6 = 0;

  /* "volttron/platform/vip/router/routercy.pyx":272
 *         msg_id = <cymessage.Frame>frames.pop()
 * 
 *         if proto.bytes() != b'VIP1':             # <<<<<<<<<<<<<<
 *             # Peer is not talking a protocol we understand
 *             issue(self.UNROUTABLE, frames, 'bad VIP signature')
 */
  __pyx_t_6 = ((struct __pyx_vtabstruct_8volttron_8platform_3vip_6router_9cymessage_Frame *)__pyx_v_proto->__pyx_vtab)->bytes(__pyx_v_proto); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 272, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_7 = (__Pyx_PyBytes_Equals(__pyx_t_6, __pyx_n_b_VIP1, Py_NE)); if (unlikely(__pyx_t_7 < 0)) __PYX_ERR(0, 272, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  if (__pyx_t_7) {

    /* "volttron/platform/vip/router/routercy.pyx":274
 *         if proto.bytes() != b'VIP1':
 *             # Peer is not talking a protocol we understand
 *             issue(self.UNROUTABLE, frames, 'bad VIP signature')             # <<<<<<<<<<<<<<
 *             return
 *         self._add_peer(sender.bytes())
 */
    __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_self->UNROUTABLE); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 274, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_INCREF(__pyx_v_issue);
    __pyx_t_2 = __pyx_v_issue; __pyx_t_3 = NULL;
    __pyx_t_5 = 0;
    if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_2))) {
      __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
      if (likely(__pyx_t_3)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
        __Pyx_INCREF(__pyx_t_3);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_2, function);
        __pyx_t_5 = 1;
      }
    }
    __pyx_t_1 = PyTuple_New(3+__pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 274, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    if (__pyx_t_3) {
      __Pyx_GIVEREF(__pyx_t_3); PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_3); __pyx_t_3 = NULL;
    }
    __Pyx_GIVEREF(__pyx_t_4);
    PyTuple_SET_ITEM(__pyx_t_1, 0+__pyx_t_5, __pyx_t_4);
    __Pyx_INCREF(((PyObject *)__pyx_v_frames));
    __Pyx_GIVEREF(((PyObject *)__pyx_v_frames));
    PyTuple_SET_ITEM(__pyx_t_1, 1+__pyx_t_5, ((PyObject *)__pyx_v_frames));
    __Pyx_INCREF(__pyx_kp_s_bad_VIP_signature);
    __Pyx_GIVEREF(__pyx_kp_s_bad_VIP_signature);
    PyTuple_SET_ITEM(__pyx_t_1, 2+__pyx_t_5, __pyx_kp_s_bad_VIP_signature);
    __pyx_t_4 = 0;
    __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_1, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 274, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

    /* "volttron/platform/vip/router/routercy.pyx":275
 *             # Peer is not talking a protocol we understand
 *             issue(self.UNROUTABLE, frames, 'bad VIP signature')
 *             return             # <<<<<<<<<<<<<<
 *         self._add_peer(sender.bytes())
 *         subsystem = <cymessage.Frame>frames.pop()
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;

    /* "volttron/platform/vip/router/routercy.pyx":272
 *         msg_id = <cymessage.Frame>frames.pop()
 * 
 *         if proto.bytes() != b'VIP1':             # <<<<<<<<<<<<<<
 *             # Peer is not talking a protocol we understand
 *             issue(self.UNROUTABLE, frames, 'bad VIP signature')
 */
  }

  /* "volttron/platform/vip/router/routercy.pyx":276
 *             issue(self.UNROUTABLE, frames, 'bad VIP signature')
 *             return
 *         self._add_peer(sender.bytes())             # <<<<<<<<<<<<<<
 *         subsystem = <cymessage.Frame>frames.pop()
 *         if not recipient.bytes():
 */
  __pyx_t_6 = ((struct __pyx_vtabstruct_8volttron_8platform_3vip_6router_9cymessage_Frame *)__pyx_v_sender->__pyx_vtab)->bytes(__pyx_v_sender); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 276, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_10 = __pyx_convert_string_from_py_std__in_string(__pyx_t_6); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 276, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = ((struct __pyx_vtabstruct_8volttron_8platform_3vip_6router_8routercy_BaseRouter *)__pyx_v_self->__pyx_vtab)->_add_peer(__pyx_v_self, __pyx_t_10, 0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 276, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "volttron/platform/vip/router/routercy.pyx":277
 *             return
 *         self._add_peer(sender.bytes())
 *         subsystem = <cymessage.Frame>frames.pop()             # <<<<<<<<<<<<<<
 *         if not recipient.bytes():
 *             # Handle requests directed at the router
 */
  __pyx_t_11 = ((struct __pyx_vtabstruct_8volttron_8platform_3vip_6router_5queue_Queue *)__pyx_v_frames->__pyx_vtab)->pop(__pyx_v_frames); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 277, __pyx_L1_error)
  __pyx_t_6 = ((PyObject *)__pyx_t_11);
  __Pyx_INCREF(__pyx_t_6);
  __pyx_v_subsystem = ((struct __pyx_obj_8volttron_8platform_3vip_6router_9cymessage_Frame *)__pyx_t_6);
  __pyx_t_6 = 0;

  /* "volttron/platform/vip/router/routercy.pyx":278
 *         self._add_peer(sender.bytes())
 *         subsystem = <cymessage.Frame>frames.pop()
 *         if not recipient.bytes():             # <<<<<<<<<<<<<<
 *             # Handle requests directed at the router
 *             name = subsystem.bytes()
 */
  __pyx_t_6 = ((struct __pyx_vtabstruct_8volttron_8platform_3vip_6router_9cymessage_Frame *)__pyx_v_recipient->__pyx_vtab)->bytes(__pyx_v_recipient); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 278, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_t_6); if (unlikely(__pyx_t_7 < 0)) __PYX_ERR(0, 278, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_9 = ((!__pyx_t_7) != 0);
  if (__pyx_t_9) {

    /* "volttron/platform/vip/router/routercy.pyx":280
 *         if not recipient.bytes():
 *             # Handle requests directed at the router
 *             name = subsystem.bytes()             # <<<<<<<<<<<<<<
 *             if name == b'hello':
 *                 #frames.clear()???
 */
    __pyx_t_6 = ((struct __pyx_vtabstruct_8volttron_8platform_3vip_6router_9cymessage_Frame *)__pyx_v_subsystem->__pyx_vtab)->bytes(__pyx_v_subsystem); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 280, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    if (!(likely(((__pyx_t_6) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_6, __pyx_ptype_8volttron_8platform_3vip_6router_9cymessage_Frame))))) __PYX_ERR(0, 280, __pyx_L1_error)
    __pyx_v_name = ((struct __pyx_obj_8volttron_8platform_3vip_6router_9cymessage_Frame *)__pyx_t_6);
    __pyx_t_6 = 0;

    /* "volttron/platform/vip/router/routercy.pyx":281
 *             # Handle requests directed at the router
 *             name = subsystem.bytes()
 *             if name == b'hello':             # <<<<<<<<<<<<<<
 *                 #frames.clear()???
 *                 #frames = [sender, recipient, proto, user_id, msg_id,
 */
    __pyx_t_9 = (__Pyx_PyBytes_Equals(((PyObject *)__pyx_v_name), __pyx_n_b_hello, Py_EQ)); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 281, __pyx_L1_error)
    if (__pyx_t_9) {

      /* "volttron/platform/vip/router/routercy.pyx":285
 *                 #frames = [sender, recipient, proto, user_id, msg_id,
 *                 #          b'hello', b'welcome', b'1.0', socket.identity, sender]
 *                 frames.append(<void*>sender)             # <<<<<<<<<<<<<<
 *                 frames.append(<void*>recipient)
 *                 frames.append(<void*>proto)
 */
      __pyx_t_6 = ((struct __pyx_vtabstruct_8volttron_8platform_3vip_6router_5queue_Queue *)__pyx_v_frames->__pyx_vtab)->append(__pyx_v_frames, ((void *)__pyx_v_sender)); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 285, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_6);
      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

      /* "volttron/platform/vip/router/routercy.pyx":286
 *                 #          b'hello', b'welcome', b'1.0', socket.identity, sender]
 *                 frames.append(<void*>sender)
 *                 frames.append(<void*>recipient)             # <<<<<<<<<<<<<<
 *                 frames.append(<void*>proto)
 *                 frames.append(<void*>user_id)
 */
      __pyx_t_6 = ((struct __pyx_vtabstruct_8volttron_8platform_3vip_6router_5queue_Queue *)__pyx_v_frames->__pyx_vtab)->append(__pyx_v_frames, ((void *)__pyx_v_recipient)); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 286, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_6);
      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

      /* "volttron/platform/vip/router/routercy.pyx":287
 *                 frames.append(<void*>sender)
 *                 frames.append(<void*>recipient)
 *                 frames.append(<void*>proto)             # <<<<<<<<<<<<<<
 *                 frames.append(<void*>user_id)
 *                 frames.append(<void*>msg_id)
 */
      __pyx_t_6 = ((struct __pyx_vtabstruct_8volttron_8platform_3vip_6router_5queue_Queue *)__pyx_v_frames->__pyx_vtab)->append(__pyx_v_frames, ((void *)__pyx_v_proto)); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 287, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_6);
      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

      /* "volttron/platform/vip/router/routercy.pyx":288
 *                 frames.append(<void*>recipient)
 *                 frames.append(<void*>proto)
 *                 frames.append(<void*>user_id)             # <<<<<<<<<<<<<<
 *                 frames.append(<void*>msg_id)
 *                 hello = cymessage.Frame(b'hello')
 */
      __pyx_t_6 = __Pyx_GetModuleGlobalName(__pyx_n_s_user_id); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 288, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_6);
      __pyx_t_2 = ((struct __pyx_vtabstruct_8volttron_8platform_3vip_6router_5queue_Queue *)__pyx_v_frames->__pyx_vtab)->append(__pyx_v_frames, ((void *)__pyx_t_6)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 288, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

      /* "volttron/platform/vip/router/routercy.pyx":289
 *                 frames.append(<void*>proto)
 *                 frames.append(<void*>user_id)
 *                 frames.append(<void*>msg_id)             # <<<<<<<<<<<<<<
 *                 hello = cymessage.Frame(b'hello')
 *                 welcome =cymessage.Frame(b'welcome')
 */
      __pyx_t_2 = ((struct __pyx_vtabstruct_8volttron_8platform_3vip_6router_5queue_Queue *)__pyx_v_frames->__pyx_vtab)->append(__pyx_v_frames, ((void *)__pyx_v_msg_id)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 289, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

      /* "volttron/platform/vip/router/routercy.pyx":290
 *                 frames.append(<void*>user_id)
 *                 frames.append(<void*>msg_id)
 *                 hello = cymessage.Frame(b'hello')             # <<<<<<<<<<<<<<
 *                 welcome =cymessage.Frame(b'welcome')
 *                 ver = cymessage.Frame(b'1.0')
 */
      __pyx_t_2 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_8volttron_8platform_3vip_6router_9cymessage_Frame), __pyx_tuple__5, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 290, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_v_hello = ((struct __pyx_obj_8volttron_8platform_3vip_6router_9cymessage_Frame *)__pyx_t_2);
      __pyx_t_2 = 0;

      /* "volttron/platform/vip/router/routercy.pyx":291
 *                 frames.append(<void*>msg_id)
 *                 hello = cymessage.Frame(b'hello')
 *                 welcome =cymessage.Frame(b'welcome')             # <<<<<<<<<<<<<<
 *                 ver = cymessage.Frame(b'1.0')
 *                 frames.append(<void*>hello)
 */
      __pyx_t_2 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_8volttron_8platform_3vip_6router_9cymessage_Frame), __pyx_tuple__6, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 291, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_v_welcome = ((struct __pyx_obj_8volttron_8platform_3vip_6router_9cymessage_Frame *)__pyx_t_2);
      __pyx_t_2 = 0;

      /* "volttron/platform/vip/router/routercy.pyx":292
 *                 hello = cymessage.Frame(b'hello')
 *                 welcome =cymessage.Frame(b'welcome')
 *                 ver = cymessage.Frame(b'1.0')             # <<<<<<<<<<<<<<
 *                 frames.append(<void*>hello)
 *                 frames.append(<void*>welcome)
 */
      __pyx_t_2 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_8volttron_8platform_3vip_6router_9cymessage_Frame), __pyx_tuple__7, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 292, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_v_ver = ((struct __pyx_obj_8volttron_8platform_3vip_6router_9cymessage_Frame *)__pyx_t_2);
      __pyx_t_2 = 0;

      /* "volttron/platform/vip/router/routercy.pyx":293
 *                 welcome =cymessage.Frame(b'welcome')
 *                 ver = cymessage.Frame(b'1.0')
 *                 frames.append(<void*>hello)             # <<<<<<<<<<<<<<
 *                 frames.append(<void*>welcome)
 *                 frames.append(<void*>ver)
 */
      __pyx_t_2 = ((struct __pyx_vtabstruct_8volttron_8platform_3vip_6router_5queue_Queue *)__pyx_v_frames->__pyx_vtab)->append(__pyx_v_frames, ((void *)__pyx_v_hello)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 293, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

      /* "volttron/platform/vip/router/routercy.pyx":294
 *                 ver = cymessage.Frame(b'1.0')
 *                 frames.append(<void*>hello)
 *                 frames.append(<void*>welcome)             # <<<<<<<<<<<<<<
 *                 frames.append(<void*>ver)
 *                 #frames.append(socket.identity) #To check
 */
      __pyx_t_2 = ((struct __pyx_vtabstruct_8volttron_8platform_3vip_6router_5queue_Queue *)__pyx_v_frames->__pyx_vtab)->append(__pyx_v_frames, ((void *)__pyx_v_welcome)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 294, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

      /* "volttron/platform/vip/router/routercy.pyx":295
 *                 frames.append(<void*>hello)
 *                 frames.append(<void*>welcome)
 *                 frames.append(<void*>ver)             # <<<<<<<<<<<<<<
 *                 #frames.append(socket.identity) #To check
 *                 frames.append(<void*>sender)
 */
      __pyx_t_2 = ((struct __pyx_vtabstruct_8volttron_8platform_3vip_6router_5queue_Queue *)__pyx_v_frames->__pyx_vtab)->append(__pyx_v_frames, ((void *)__pyx_v_ver)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 295, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

      /* "volttron/platform/vip/router/routercy.pyx":297
 *                 frames.append(<void*>ver)
 *                 #frames.append(socket.identity) #To check
 *                 frames.append(<void*>sender)             # <<<<<<<<<<<<<<
 *             elif name == b'ping':
 *                 #frames.clear() ??
 */
      __pyx_t_2 = ((struct __pyx_vtabstruct_8volttron_8platform_3vip_6router_5queue_Queue *)__pyx_v_frames->__pyx_vtab)->append(__pyx_v_frames, ((void *)__pyx_v_sender)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 297, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

      /* "volttron/platform/vip/router/routercy.pyx":281
 *             # Handle requests directed at the router
 *             name = subsystem.bytes()
 *             if name == b'hello':             # <<<<<<<<<<<<<<
 *                 #frames.clear()???
 *                 #frames = [sender, recipient, proto, user_id, msg_id,
 */
      goto __pyx_L10;
    }

    /* "volttron/platform/vip/router/routercy.pyx":298
 *                 #frames.append(socket.identity) #To check
 *                 frames.append(<void*>sender)
 *             elif name == b'ping':             # <<<<<<<<<<<<<<
 *                 #frames.clear() ??
 *                 frames.append(<void*>sender)
 */
    __pyx_t_9 = (__Pyx_PyBytes_Equals(((PyObject *)__pyx_v_name), __pyx_n_b_ping, Py_EQ)); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 298, __pyx_L1_error)
    if (__pyx_t_9) {

      /* "volttron/platform/vip/router/routercy.pyx":300
 *             elif name == b'ping':
 *                 #frames.clear() ??
 *                 frames.append(<void*>sender)             # <<<<<<<<<<<<<<
 *                 frames.append(<void*>recipient)
 *                 frames.append(<void*>proto)
 */
      __pyx_t_2 = ((struct __pyx_vtabstruct_8volttron_8platform_3vip_6router_5queue_Queue *)__pyx_v_frames->__pyx_vtab)->append(__pyx_v_frames, ((void *)__pyx_v_sender)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 300, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

      /* "volttron/platform/vip/router/routercy.pyx":301
 *                 #frames.clear() ??
 *                 frames.append(<void*>sender)
 *                 frames.append(<void*>recipient)             # <<<<<<<<<<<<<<
 *                 frames.append(<void*>proto)
 *                 frames.append(<void*>user_id)
 */
      __pyx_t_2 = ((struct __pyx_vtabstruct_8volttron_8platform_3vip_6router_5queue_Queue *)__pyx_v_frames->__pyx_vtab)->append(__pyx_v_frames, ((void *)__pyx_v_recipient)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 301, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

      /* "volttron/platform/vip/router/routercy.pyx":302
 *                 frames.append(<void*>sender)
 *                 frames.append(<void*>recipient)
 *                 frames.append(<void*>proto)             # <<<<<<<<<<<<<<
 *                 frames.append(<void*>user_id)
 *                 frames.append(<void*>msg_id)
 */
      __pyx_t_2 = ((struct __pyx_vtabstruct_8volttron_8platform_3vip_6router_5queue_Queue *)__pyx_v_frames->__pyx_vtab)->append(__pyx_v_frames, ((void *)__pyx_v_proto)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 302, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

      /* "volttron/platform/vip/router/routercy.pyx":303
 *                 frames.append(<void*>recipient)
 *                 frames.append(<void*>proto)
 *                 frames.append(<void*>user_id)             # <<<<<<<<<<<<<<
 *                 frames.append(<void*>msg_id)
 *                 ping = cymessage.Frame(b'ping')
 */
      __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_user_id); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 303, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_t_6 = ((struct __pyx_vtabstruct_8volttron_8platform_3vip_6router_5queue_Queue *)__pyx_v_frames->__pyx_vtab)->append(__pyx_v_frames, ((void *)__pyx_t_2)); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 303, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_6);
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

      /* "volttron/platform/vip/router/routercy.pyx":304
 *                 frames.append(<void*>proto)
 *                 frames.append(<void*>user_id)
 *                 frames.append(<void*>msg_id)             # <<<<<<<<<<<<<<
 *                 ping = cymessage.Frame(b'ping')
 *                 pong = cymessage.Frame(b'pong')
 */
      __pyx_t_6 = ((struct __pyx_vtabstruct_8volttron_8platform_3vip_6router_5queue_Queue *)__pyx_v_frames->__pyx_vtab)->append(__pyx_v_frames, ((void *)__pyx_v_msg_id)); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 304, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_6);
      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

      /* "volttron/platform/vip/router/routercy.pyx":305
 *                 frames.append(<void*>user_id)
 *                 frames.append(<void*>msg_id)
 *                 ping = cymessage.Frame(b'ping')             # <<<<<<<<<<<<<<
 *                 pong = cymessage.Frame(b'pong')
 *                 frames.append(<void*>ping)
 */
      __pyx_t_6 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_8volttron_8platform_3vip_6router_9cymessage_Frame), __pyx_tuple__8, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 305, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_6);
      __pyx_v_ping = ((struct __pyx_obj_8volttron_8platform_3vip_6router_9cymessage_Frame *)__pyx_t_6);
      __pyx_t_6 = 0;

      /* "volttron/platform/vip/router/routercy.pyx":306
 *                 frames.append(<void*>msg_id)
 *                 ping = cymessage.Frame(b'ping')
 *                 pong = cymessage.Frame(b'pong')             # <<<<<<<<<<<<<<
 *                 frames.append(<void*>ping)
 *                 frames.append(<void*>pong)
 */
      __pyx_t_6 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_8volttron_8platform_3vip_6router_9cymessage_Frame), __pyx_tuple__9, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 306, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_6);
      __pyx_v_pong = ((struct __pyx_obj_8volttron_8platform_3vip_6router_9cymessage_Frame *)__pyx_t_6);
      __pyx_t_6 = 0;

      /* "volttron/platform/vip/router/routercy.pyx":307
 *                 ping = cymessage.Frame(b'ping')
 *                 pong = cymessage.Frame(b'pong')
 *                 frames.append(<void*>ping)             # <<<<<<<<<<<<<<
 *                 frames.append(<void*>pong)
 *             elif name == b'peerlist':
 */
      __pyx_t_6 = ((struct __pyx_vtabstruct_8volttron_8platform_3vip_6router_5queue_Queue *)__pyx_v_frames->__pyx_vtab)->append(__pyx_v_frames, ((void *)__pyx_v_ping)); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 307, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_6);
      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

      /* "volttron/platform/vip/router/routercy.pyx":308
 *                 pong = cymessage.Frame(b'pong')
 *                 frames.append(<void*>ping)
 *                 frames.append(<void*>pong)             # <<<<<<<<<<<<<<
 *             elif name == b'peerlist':
 *                 try:
 */
      __pyx_t_6 = ((struct __pyx_vtabstruct_8volttron_8platform_3vip_6router_5queue_Queue *)__pyx_v_frames->__pyx_vtab)->append(__pyx_v_frames, ((void *)__pyx_v_pong)); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 308, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_6);
      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

      /* "volttron/platform/vip/router/routercy.pyx":298
 *                 #frames.append(socket.identity) #To check
 *                 frames.append(<void*>sender)
 *             elif name == b'ping':             # <<<<<<<<<<<<<<
 *                 #frames.clear() ??
 *                 frames.append(<void*>sender)
 */
      goto __pyx_L10;
    }

    /* "volttron/platform/vip/router/routercy.pyx":309
 *                 frames.append(<void*>ping)
 *                 frames.append(<void*>pong)
 *             elif name == b'peerlist':             # <<<<<<<<<<<<<<
 *                 try:
 *                     opr = <cymessage.Frame> frames.pop()
 */
    __pyx_t_9 = (__Pyx_PyBytes_Equals(((PyObject *)__pyx_v_name), __pyx_n_b_peerlist, Py_EQ)); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 309, __pyx_L1_error)
    if (__pyx_t_9) {

      /* "volttron/platform/vip/router/routercy.pyx":310
 *                 frames.append(<void*>pong)
 *             elif name == b'peerlist':
 *                 try:             # <<<<<<<<<<<<<<
 *                     opr = <cymessage.Frame> frames.pop()
 *                     op = opr.bytes()
 */
      {
        __Pyx_PyThreadState_declare
        __Pyx_PyThreadState_assign
        __Pyx_ExceptionSave(&__pyx_t_12, &__pyx_t_13, &__pyx_t_14);
        __Pyx_XGOTREF(__pyx_t_12);
        __Pyx_XGOTREF(__pyx_t_13);
        __Pyx_XGOTREF(__pyx_t_14);
        /*try:*/ {

          /* "volttron/platform/vip/router/routercy.pyx":311
 *             elif name == b'peerlist':
 *                 try:
 *                     opr = <cymessage.Frame> frames.pop()             # <<<<<<<<<<<<<<
 *                     op = opr.bytes()
 *                     #op = frames[6].bytes
 */
          __pyx_t_11 = ((struct __pyx_vtabstruct_8volttron_8platform_3vip_6router_5queue_Queue *)__pyx_v_frames->__pyx_vtab)->pop(__pyx_v_frames); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 311, __pyx_L11_error)
          __pyx_t_6 = ((PyObject *)__pyx_t_11);
          __Pyx_INCREF(__pyx_t_6);
          __pyx_v_opr = ((struct __pyx_obj_8volttron_8platform_3vip_6router_9cymessage_Frame *)__pyx_t_6);
          __pyx_t_6 = 0;

          /* "volttron/platform/vip/router/routercy.pyx":312
 *                 try:
 *                     opr = <cymessage.Frame> frames.pop()
 *                     op = opr.bytes()             # <<<<<<<<<<<<<<
 *                     #op = frames[6].bytes
 *                 except IndexError:
 */
          __pyx_t_6 = ((struct __pyx_vtabstruct_8volttron_8platform_3vip_6router_9cymessage_Frame *)__pyx_v_opr->__pyx_vtab)->bytes(__pyx_v_opr); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 312, __pyx_L11_error)
          __Pyx_GOTREF(__pyx_t_6);
          __pyx_v_op = __pyx_t_6;
          __pyx_t_6 = 0;

          /* "volttron/platform/vip/router/routercy.pyx":310
 *                 frames.append(<void*>pong)
 *             elif name == b'peerlist':
 *                 try:             # <<<<<<<<<<<<<<
 *                     opr = <cymessage.Frame> frames.pop()
 *                     op = opr.bytes()
 */
        }
        __Pyx_XDECREF(__pyx_t_12); __pyx_t_12 = 0;
        __Pyx_XDECREF(__pyx_t_13); __pyx_t_13 = 0;
        __Pyx_XDECREF(__pyx_t_14); __pyx_t_14 = 0;
        goto __pyx_L18_try_end;
        __pyx_L11_error:;
        __Pyx_PyThreadState_assign
        __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
        __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
        __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
        __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
        __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;

        /* "volttron/platform/vip/router/routercy.pyx":314
 *                     op = opr.bytes()
 *                     #op = frames[6].bytes
 *                 except IndexError:             # <<<<<<<<<<<<<<
 *                     op = None
 *                 #frames.clear() ??
 */
        __pyx_t_15 = __Pyx_PyErr_ExceptionMatches(__pyx_builtin_IndexError);
        if (__pyx_t_15) {
          __Pyx_AddTraceback("volttron.platform.vip.router.routercy.BaseRouter.route", __pyx_clineno, __pyx_lineno, __pyx_filename);
          if (__Pyx_GetException(&__pyx_t_6, &__pyx_t_2, &__pyx_t_1) < 0) __PYX_ERR(0, 314, __pyx_L13_except_error)
          __Pyx_GOTREF(__pyx_t_6);
          __Pyx_GOTREF(__pyx_t_2);
          __Pyx_GOTREF(__pyx_t_1);

          /* "volttron/platform/vip/router/routercy.pyx":315
 *                     #op = frames[6].bytes
 *                 except IndexError:
 *                     op = None             # <<<<<<<<<<<<<<
 *                 #frames.clear() ??
 *                 frames.append(<void*>sender)
 */
          __Pyx_INCREF(Py_None);
          __Pyx_XDECREF_SET(__pyx_v_op, Py_None);
          __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
          __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
          __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
          goto __pyx_L12_exception_handled;
        }
        goto __pyx_L13_except_error;
        __pyx_L13_except_error:;

        /* "volttron/platform/vip/router/routercy.pyx":310
 *                 frames.append(<void*>pong)
 *             elif name == b'peerlist':
 *                 try:             # <<<<<<<<<<<<<<
 *                     opr = <cymessage.Frame> frames.pop()
 *                     op = opr.bytes()
 */
        __Pyx_PyThreadState_assign
        __Pyx_XGIVEREF(__pyx_t_12);
        __Pyx_XGIVEREF(__pyx_t_13);
        __Pyx_XGIVEREF(__pyx_t_14);
        __Pyx_ExceptionReset(__pyx_t_12, __pyx_t_13, __pyx_t_14);
        goto __pyx_L1_error;
        __pyx_L12_exception_handled:;
        __Pyx_PyThreadState_assign
        __Pyx_XGIVEREF(__pyx_t_12);
        __Pyx_XGIVEREF(__pyx_t_13);
        __Pyx_XGIVEREF(__pyx_t_14);
        __Pyx_ExceptionReset(__pyx_t_12, __pyx_t_13, __pyx_t_14);
        __pyx_L18_try_end:;
      }

      /* "volttron/platform/vip/router/routercy.pyx":317
 *                     op = None
 *                 #frames.clear() ??
 *                 frames.append(<void*>sender)             # <<<<<<<<<<<<<<
 *                 frames.append(<void*>recipient)
 *                 frames.append(<void*>proto)
 */
      __pyx_t_1 = ((struct __pyx_vtabstruct_8volttron_8platform_3vip_6router_5queue_Queue *)__pyx_v_frames->__pyx_vtab)->append(__pyx_v_frames, ((void *)__pyx_v_sender)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 317, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

      /* "volttron/platform/vip/router/routercy.pyx":318
 *                 #frames.clear() ??
 *                 frames.append(<void*>sender)
 *                 frames.append(<void*>recipient)             # <<<<<<<<<<<<<<
 *                 frames.append(<void*>proto)
 *                 temp = cymessage.Frame(b'')
 */
      __pyx_t_1 = ((struct __pyx_vtabstruct_8volttron_8platform_3vip_6router_5queue_Queue *)__pyx_v_frames->__pyx_vtab)->append(__pyx_v_frames, ((void *)__pyx_v_recipient)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 318, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

      /* "volttron/platform/vip/router/routercy.pyx":319
 *                 frames.append(<void*>sender)
 *                 frames.append(<void*>recipient)
 *                 frames.append(<void*>proto)             # <<<<<<<<<<<<<<
 *                 temp = cymessage.Frame(b'')
 *                 frames.append(<void*>temp)
 */
      __pyx_t_1 = ((struct __pyx_vtabstruct_8volttron_8platform_3vip_6router_5queue_Queue *)__pyx_v_frames->__pyx_vtab)->append(__pyx_v_frames, ((void *)__pyx_v_proto)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 319, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

      /* "volttron/platform/vip/router/routercy.pyx":320
 *                 frames.append(<void*>recipient)
 *                 frames.append(<void*>proto)
 *                 temp = cymessage.Frame(b'')             # <<<<<<<<<<<<<<
 *                 frames.append(<void*>temp)
 *                 frames.append(<void*>msg_id)
 */
      __pyx_t_1 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_8volttron_8platform_3vip_6router_9cymessage_Frame), __pyx_tuple__11, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 320, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_v_temp = ((struct __pyx_obj_8volttron_8platform_3vip_6router_9cymessage_Frame *)__pyx_t_1);
      __pyx_t_1 = 0;

      /* "volttron/platform/vip/router/routercy.pyx":321
 *                 frames.append(<void*>proto)
 *                 temp = cymessage.Frame(b'')
 *                 frames.append(<void*>temp)             # <<<<<<<<<<<<<<
 *                 frames.append(<void*>msg_id)
 *                 frames.append(<void*>subsystem)
 */
      __pyx_t_1 = ((struct __pyx_vtabstruct_8volttron_8platform_3vip_6router_5queue_Queue *)__pyx_v_frames->__pyx_vtab)->append(__pyx_v_frames, ((void *)__pyx_v_temp)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 321, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

      /* "volttron/platform/vip/router/routercy.pyx":322
 *                 temp = cymessage.Frame(b'')
 *                 frames.append(<void*>temp)
 *                 frames.append(<void*>msg_id)             # <<<<<<<<<<<<<<
 *                 frames.append(<void*>subsystem)
 *                 if op == b'list':
 */
      __pyx_t_1 = ((struct __pyx_vtabstruct_8volttron_8platform_3vip_6router_5queue_Queue *)__pyx_v_frames->__pyx_vtab)->append(__pyx_v_frames, ((void *)__pyx_v_msg_id)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 322, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

      /* "volttron/platform/vip/router/routercy.pyx":323
 *                 frames.append(<void*>temp)
 *                 frames.append(<void*>msg_id)
 *                 frames.append(<void*>subsystem)             # <<<<<<<<<<<<<<
 *                 if op == b'list':
 *                     listing = cymessage.Frame(b'listing')
 */
      __pyx_t_1 = ((struct __pyx_vtabstruct_8volttron_8platform_3vip_6router_5queue_Queue *)__pyx_v_frames->__pyx_vtab)->append(__pyx_v_frames, ((void *)__pyx_v_subsystem)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 323, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

      /* "volttron/platform/vip/router/routercy.pyx":324
 *                 frames.append(<void*>msg_id)
 *                 frames.append(<void*>subsystem)
 *                 if op == b'list':             # <<<<<<<<<<<<<<
 *                     listing = cymessage.Frame(b'listing')
 *                     frames.append(<void*>listing)
 */
      __pyx_t_9 = (__Pyx_PyBytes_Equals(__pyx_v_op, __pyx_n_b_list, Py_EQ)); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 324, __pyx_L1_error)
      if (__pyx_t_9) {

        /* "volttron/platform/vip/router/routercy.pyx":325
 *                 frames.append(<void*>subsystem)
 *                 if op == b'list':
 *                     listing = cymessage.Frame(b'listing')             # <<<<<<<<<<<<<<
 *                     frames.append(<void*>listing)
 *                     frames.append(<void*>recipient)
 */
        __pyx_t_1 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_8volttron_8platform_3vip_6router_9cymessage_Frame), __pyx_tuple__12, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 325, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        __pyx_v_listing = __pyx_t_1;
        __pyx_t_1 = 0;

        /* "volttron/platform/vip/router/routercy.pyx":326
 *                 if op == b'list':
 *                     listing = cymessage.Frame(b'listing')
 *                     frames.append(<void*>listing)             # <<<<<<<<<<<<<<
 *                     frames.append(<void*>recipient)
 *                     frames.append(<void*>listing)
 */
        __pyx_t_1 = ((struct __pyx_vtabstruct_8volttron_8platform_3vip_6router_5queue_Queue *)__pyx_v_frames->__pyx_vtab)->append(__pyx_v_frames, ((void *)__pyx_v_listing)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 326, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

        /* "volttron/platform/vip/router/routercy.pyx":327
 *                     listing = cymessage.Frame(b'listing')
 *                     frames.append(<void*>listing)
 *                     frames.append(<void*>recipient)             # <<<<<<<<<<<<<<
 *                     frames.append(<void*>listing)
 *                     frames.extend(self._peers) #???
 */
        __pyx_t_1 = ((struct __pyx_vtabstruct_8volttron_8platform_3vip_6router_5queue_Queue *)__pyx_v_frames->__pyx_vtab)->append(__pyx_v_frames, ((void *)__pyx_v_recipient)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 327, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

        /* "volttron/platform/vip/router/routercy.pyx":328
 *                     frames.append(<void*>listing)
 *                     frames.append(<void*>recipient)
 *                     frames.append(<void*>listing)             # <<<<<<<<<<<<<<
 *                     frames.extend(self._peers) #???
 *                 else:
 */
        __pyx_t_1 = ((struct __pyx_vtabstruct_8volttron_8platform_3vip_6router_5queue_Queue *)__pyx_v_frames->__pyx_vtab)->append(__pyx_v_frames, ((void *)__pyx_v_listing)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 328, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

        /* "volttron/platform/vip/router/routercy.pyx":329
 *                     frames.append(<void*>recipient)
 *                     frames.append(<void*>listing)
 *                     frames.extend(self._peers) #???             # <<<<<<<<<<<<<<
 *                 else:
 *                     error = (b'unknown' if op else b'missing') + b' operation'
 */
        __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_frames), __pyx_n_s_extend); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 329, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        __pyx_t_6 = __pyx_convert_set_to_py_std_3a__3a_string(__pyx_v_self->_peers); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 329, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_6);
        __pyx_t_4 = NULL;
        if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_2))) {
          __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
          if (likely(__pyx_t_4)) {
            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
            __Pyx_INCREF(__pyx_t_4);
            __Pyx_INCREF(function);
            __Pyx_DECREF_SET(__pyx_t_2, function);
          }
        }
        if (!__pyx_t_4) {
          __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 329, __pyx_L1_error)
          __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
          __Pyx_GOTREF(__pyx_t_1);
        } else {
          __pyx_t_3 = PyTuple_New(1+1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 329, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_3);
          __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_4); __pyx_t_4 = NULL;
          __Pyx_GIVEREF(__pyx_t_6);
          PyTuple_SET_ITEM(__pyx_t_3, 0+1, __pyx_t_6);
          __pyx_t_6 = 0;
          __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_3, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 329, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_1);
          __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
        }
        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

        /* "volttron/platform/vip/router/routercy.pyx":324
 *                 frames.append(<void*>msg_id)
 *                 frames.append(<void*>subsystem)
 *                 if op == b'list':             # <<<<<<<<<<<<<<
 *                     listing = cymessage.Frame(b'listing')
 *                     frames.append(<void*>listing)
 */
        goto __pyx_L21;
      }

      /* "volttron/platform/vip/router/routercy.pyx":331
 *                     frames.extend(self._peers) #???
 *                 else:
 *                     error = (b'unknown' if op else b'missing') + b' operation'             # <<<<<<<<<<<<<<
 *                     err = cymessage.Frame(b'error')
 *                     frames.append(<void*>err)
 */
      /*else*/ {
        __pyx_t_9 = __Pyx_PyObject_IsTrue(__pyx_v_op); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 331, __pyx_L1_error)
        if (__pyx_t_9) {
          __Pyx_INCREF(__pyx_n_b_unknown);
          __pyx_t_1 = __pyx_n_b_unknown;
        } else {
          __Pyx_INCREF(__pyx_n_b_missing);
          __pyx_t_1 = __pyx_n_b_missing;
        }
        __pyx_t_2 = PyNumber_Add(__pyx_t_1, __pyx_kp_b_operation); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 331, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
        __pyx_v_error = __pyx_t_2;
        __pyx_t_2 = 0;

        /* "volttron/platform/vip/router/routercy.pyx":332
 *                 else:
 *                     error = (b'unknown' if op else b'missing') + b' operation'
 *                     err = cymessage.Frame(b'error')             # <<<<<<<<<<<<<<
 *                     frames.append(<void*>err)
 *                     frames.append(<void*>error)
 */
        __pyx_t_2 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_8volttron_8platform_3vip_6router_9cymessage_Frame), __pyx_tuple__13, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 332, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        __pyx_v_err = ((struct __pyx_obj_8volttron_8platform_3vip_6router_9cymessage_Frame *)__pyx_t_2);
        __pyx_t_2 = 0;

        /* "volttron/platform/vip/router/routercy.pyx":333
 *                     error = (b'unknown' if op else b'missing') + b' operation'
 *                     err = cymessage.Frame(b'error')
 *                     frames.append(<void*>err)             # <<<<<<<<<<<<<<
 *                     frames.append(<void*>error)
 *             elif name == b'error':
 */
        __pyx_t_2 = ((struct __pyx_vtabstruct_8volttron_8platform_3vip_6router_5queue_Queue *)__pyx_v_frames->__pyx_vtab)->append(__pyx_v_frames, ((void *)__pyx_v_err)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 333, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

        /* "volttron/platform/vip/router/routercy.pyx":334
 *                     err = cymessage.Frame(b'error')
 *                     frames.append(<void*>err)
 *                     frames.append(<void*>error)             # <<<<<<<<<<<<<<
 *             elif name == b'error':
 *                 return
 */
        __pyx_t_2 = ((struct __pyx_vtabstruct_8volttron_8platform_3vip_6router_5queue_Queue *)__pyx_v_frames->__pyx_vtab)->append(__pyx_v_frames, ((void *)__pyx_v_error)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 334, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      }
      __pyx_L21:;

      /* "volttron/platform/vip/router/routercy.pyx":309
 *                 frames.append(<void*>ping)
 *                 frames.append(<void*>pong)
 *             elif name == b'peerlist':             # <<<<<<<<<<<<<<
 *                 try:
 *                     opr = <cymessage.Frame> frames.pop()
 */
      goto __pyx_L10;
    }

    /* "volttron/platform/vip/router/routercy.pyx":335
 *                     frames.append(<void*>err)
 *                     frames.append(<void*>error)
 *             elif name == b'error':             # <<<<<<<<<<<<<<
 *                 return
 *             else:
 */
    __pyx_t_9 = (__Pyx_PyBytes_Equals(((PyObject *)__pyx_v_name), __pyx_n_b_error, Py_EQ)); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 335, __pyx_L1_error)
    if (__pyx_t_9) {

      /* "volttron/platform/vip/router/routercy.pyx":336
 *                     frames.append(<void*>error)
 *             elif name == b'error':
 *                 return             # <<<<<<<<<<<<<<
 *             else:
 *                 response = self.handle_subsystem(frames, user_id)
 */
      __Pyx_XDECREF(__pyx_r);
      __pyx_r = Py_None; __Pyx_INCREF(Py_None);
      goto __pyx_L0;

      /* "volttron/platform/vip/router/routercy.pyx":335
 *                     frames.append(<void*>err)
 *                     frames.append(<void*>error)
 *             elif name == b'error':             # <<<<<<<<<<<<<<
 *                 return
 *             else:
 */
    }

    /* "volttron/platform/vip/router/routercy.pyx":338
 *                 return
 *             else:
 *                 response = self.handle_subsystem(frames, user_id)             # <<<<<<<<<<<<<<
 *                 if response is None:
 *                     # Handler does not know of the subsystem
 */
    /*else*/ {
      __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_user_id); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 338, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_t_1 = ((struct __pyx_vtabstruct_8volttron_8platform_3vip_6router_8routercy_BaseRouter *)__pyx_v_self->__pyx_vtab)->handle_subsystem(__pyx_v_self, ((PyObject *)__pyx_v_frames), __pyx_t_2, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 338, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_v_response = __pyx_t_1;
      __pyx_t_1 = 0;

      /* "volttron/platform/vip/router/routercy.pyx":339
 *             else:
 *                 response = self.handle_subsystem(frames, user_id)
 *                 if response is None:             # <<<<<<<<<<<<<<
 *                     # Handler does not know of the subsystem
 *                     errnum, errmsg = error = _INVALID_SUBSYSTEM
 */
      __pyx_t_9 = (__pyx_v_response == Py_None);
      __pyx_t_7 = (__pyx_t_9 != 0);
      if (__pyx_t_7) {

        /* "volttron/platform/vip/router/routercy.pyx":341
 *                 if response is None:
 *                     # Handler does not know of the subsystem
 *                     errnum, errmsg = error = _INVALID_SUBSYSTEM             # <<<<<<<<<<<<<<
 *                     issue(self.ERROR, frames, error)
 *                     frames.clear()
 */
        __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_INVALID_SUBSYSTEM); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 341, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        if ((likely(PyTuple_CheckExact(__pyx_t_1))) || (PyList_CheckExact(__pyx_t_1))) {
          PyObject* sequence = __pyx_t_1;
          #if CYTHON_COMPILING_IN_CPYTHON
          Py_ssize_t size = Py_SIZE(sequence);
          #else
          Py_ssize_t size = PySequence_Size(sequence);
          #endif
          if (unlikely(size != 2)) {
            if (size > 2) __Pyx_RaiseTooManyValuesError(2);
            else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
            __PYX_ERR(0, 341, __pyx_L1_error)
          }
          #if CYTHON_COMPILING_IN_CPYTHON
          if (likely(PyTuple_CheckExact(sequence))) {
            __pyx_t_2 = PyTuple_GET_ITEM(sequence, 0); 
            __pyx_t_3 = PyTuple_GET_ITEM(sequence, 1); 
          } else {
            __pyx_t_2 = PyList_GET_ITEM(sequence, 0); 
            __pyx_t_3 = PyList_GET_ITEM(sequence, 1); 
          }
          __Pyx_INCREF(__pyx_t_2);
          __Pyx_INCREF(__pyx_t_3);
          #else
          __pyx_t_2 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 341, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_2);
          __pyx_t_3 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 341, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_3);
          #endif
        } else {
          Py_ssize_t index = -1;
          __pyx_t_6 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 341, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_6);
          __pyx_t_16 = Py_TYPE(__pyx_t_6)->tp_iternext;
          index = 0; __pyx_t_2 = __pyx_t_16(__pyx_t_6); if (unlikely(!__pyx_t_2)) goto __pyx_L23_unpacking_failed;
          __Pyx_GOTREF(__pyx_t_2);
          index = 1; __pyx_t_3 = __pyx_t_16(__pyx_t_6); if (unlikely(!__pyx_t_3)) goto __pyx_L23_unpacking_failed;
          __Pyx_GOTREF(__pyx_t_3);
          if (__Pyx_IternextUnpackEndCheck(__pyx_t_16(__pyx_t_6), 2) < 0) __PYX_ERR(0, 341, __pyx_L1_error)
          __pyx_t_16 = NULL;
          __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
          goto __pyx_L24_unpacking_done;
          __pyx_L23_unpacking_failed:;
          __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
          __pyx_t_16 = NULL;
          if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
          __PYX_ERR(0, 341, __pyx_L1_error)
          __pyx_L24_unpacking_done:;
        }
        if (!(likely(((__pyx_t_2) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_2, __pyx_ptype_8volttron_8platform_3vip_6router_9cymessage_Frame))))) __PYX_ERR(0, 341, __pyx_L1_error)
        if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_8volttron_8platform_3vip_6router_9cymessage_Frame))))) __PYX_ERR(0, 341, __pyx_L1_error)
        __pyx_v_errnum = ((struct __pyx_obj_8volttron_8platform_3vip_6router_9cymessage_Frame *)__pyx_t_2);
        __pyx_t_2 = 0;
        __pyx_v_errmsg = ((struct __pyx_obj_8volttron_8platform_3vip_6router_9cymessage_Frame *)__pyx_t_3);
        __pyx_t_3 = 0;
        __Pyx_INCREF(__pyx_t_1);
        __pyx_v_error = __pyx_t_1;
        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

        /* "volttron/platform/vip/router/routercy.pyx":342
 *                     # Handler does not know of the subsystem
 *                     errnum, errmsg = error = _INVALID_SUBSYSTEM
 *                     issue(self.ERROR, frames, error)             # <<<<<<<<<<<<<<
 *                     frames.clear()
 *                     frames.append(<void*>sender)
 */
        __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_self->ERROR); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 342, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        __Pyx_INCREF(__pyx_v_issue);
        __pyx_t_2 = __pyx_v_issue; __pyx_t_6 = NULL;
        __pyx_t_5 = 0;
        if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_2))) {
          __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_2);
          if (likely(__pyx_t_6)) {
            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
            __Pyx_INCREF(__pyx_t_6);
            __Pyx_INCREF(function);
            __Pyx_DECREF_SET(__pyx_t_2, function);
            __pyx_t_5 = 1;
          }
        }
        __pyx_t_4 = PyTuple_New(3+__pyx_t_5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 342, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_4);
        if (__pyx_t_6) {
          __Pyx_GIVEREF(__pyx_t_6); PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_6); __pyx_t_6 = NULL;
        }
        __Pyx_GIVEREF(__pyx_t_3);
        PyTuple_SET_ITEM(__pyx_t_4, 0+__pyx_t_5, __pyx_t_3);
        __Pyx_INCREF(((PyObject *)__pyx_v_frames));
        __Pyx_GIVEREF(((PyObject *)__pyx_v_frames));
        PyTuple_SET_ITEM(__pyx_t_4, 1+__pyx_t_5, ((PyObject *)__pyx_v_frames));
        __Pyx_INCREF(__pyx_v_error);
        __Pyx_GIVEREF(__pyx_v_error);
        PyTuple_SET_ITEM(__pyx_t_4, 2+__pyx_t_5, __pyx_v_error);
        __pyx_t_3 = 0;
        __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_4, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 342, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

        /* "volttron/platform/vip/router/routercy.pyx":343
 *                     errnum, errmsg = error = _INVALID_SUBSYSTEM
 *                     issue(self.ERROR, frames, error)
 *                     frames.clear()             # <<<<<<<<<<<<<<
 *                     frames.append(<void*>sender)
 *                     frames.append(<void*>recipient)
 */
        __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_frames), __pyx_n_s_clear); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 343, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        __pyx_t_4 = NULL;
        if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_2))) {
          __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
          if (likely(__pyx_t_4)) {
            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
            __Pyx_INCREF(__pyx_t_4);
            __Pyx_INCREF(function);
            __Pyx_DECREF_SET(__pyx_t_2, function);
          }
        }
        if (__pyx_t_4) {
          __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 343, __pyx_L1_error)
          __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
        } else {
          __pyx_t_1 = __Pyx_PyObject_CallNoArg(__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 343, __pyx_L1_error)
        }
        __Pyx_GOTREF(__pyx_t_1);
        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

        /* "volttron/platform/vip/router/routercy.pyx":344
 *                     issue(self.ERROR, frames, error)
 *                     frames.clear()
 *                     frames.append(<void*>sender)             # <<<<<<<<<<<<<<
 *                     frames.append(<void*>recipient)
 *                     frames.append(<void*>proto)
 */
        __pyx_t_1 = ((struct __pyx_vtabstruct_8volttron_8platform_3vip_6router_5queue_Queue *)__pyx_v_frames->__pyx_vtab)->append(__pyx_v_frames, ((void *)__pyx_v_sender)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 344, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

        /* "volttron/platform/vip/router/routercy.pyx":345
 *                     frames.clear()
 *                     frames.append(<void*>sender)
 *                     frames.append(<void*>recipient)             # <<<<<<<<<<<<<<
 *                     frames.append(<void*>proto)
 *                     temp = cymessage.Frame(b'')
 */
        __pyx_t_1 = ((struct __pyx_vtabstruct_8volttron_8platform_3vip_6router_5queue_Queue *)__pyx_v_frames->__pyx_vtab)->append(__pyx_v_frames, ((void *)__pyx_v_recipient)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 345, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

        /* "volttron/platform/vip/router/routercy.pyx":346
 *                     frames.append(<void*>sender)
 *                     frames.append(<void*>recipient)
 *                     frames.append(<void*>proto)             # <<<<<<<<<<<<<<
 *                     temp = cymessage.Frame(b'')
 *                     frames.append(<void*>temp)
 */
        __pyx_t_1 = ((struct __pyx_vtabstruct_8volttron_8platform_3vip_6router_5queue_Queue *)__pyx_v_frames->__pyx_vtab)->append(__pyx_v_frames, ((void *)__pyx_v_proto)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 346, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

        /* "volttron/platform/vip/router/routercy.pyx":347
 *                     frames.append(<void*>recipient)
 *                     frames.append(<void*>proto)
 *                     temp = cymessage.Frame(b'')             # <<<<<<<<<<<<<<
 *                     frames.append(<void*>temp)
 *                     frames.append(<void*>msg_id)
 */
        __pyx_t_1 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_8volttron_8platform_3vip_6router_9cymessage_Frame), __pyx_tuple__14, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 347, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        __pyx_v_temp = ((struct __pyx_obj_8volttron_8platform_3vip_6router_9cymessage_Frame *)__pyx_t_1);
        __pyx_t_1 = 0;

        /* "volttron/platform/vip/router/routercy.pyx":348
 *                     frames.append(<void*>proto)
 *                     temp = cymessage.Frame(b'')
 *                     frames.append(<void*>temp)             # <<<<<<<<<<<<<<
 *                     frames.append(<void*>msg_id)
 *                     err = cymessage.Frame(b'error')
 */
        __pyx_t_1 = ((struct __pyx_vtabstruct_8volttron_8platform_3vip_6router_5queue_Queue *)__pyx_v_frames->__pyx_vtab)->append(__pyx_v_frames, ((void *)__pyx_v_temp)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 348, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

        /* "volttron/platform/vip/router/routercy.pyx":349
 *                     temp = cymessage.Frame(b'')
 *                     frames.append(<void*>temp)
 *                     frames.append(<void*>msg_id)             # <<<<<<<<<<<<<<
 *                     err = cymessage.Frame(b'error')
 *                     frames.append(<void*>err)
 */
        __pyx_t_1 = ((struct __pyx_vtabstruct_8volttron_8platform_3vip_6router_5queue_Queue *)__pyx_v_frames->__pyx_vtab)->append(__pyx_v_frames, ((void *)__pyx_v_msg_id)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 349, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

        /* "volttron/platform/vip/router/routercy.pyx":350
 *                     frames.append(<void*>temp)
 *                     frames.append(<void*>msg_id)
 *                     err = cymessage.Frame(b'error')             # <<<<<<<<<<<<<<
 *                     frames.append(<void*>err)
 *                     frames.append(<void*>errnum)
 */
        __pyx_t_1 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_8volttron_8platform_3vip_6router_9cymessage_Frame), __pyx_tuple__15, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 350, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        __pyx_v_err = ((struct __pyx_obj_8volttron_8platform_3vip_6router_9cymessage_Frame *)__pyx_t_1);
        __pyx_t_1 = 0;

        /* "volttron/platform/vip/router/routercy.pyx":351
 *                     frames.append(<void*>msg_id)
 *                     err = cymessage.Frame(b'error')
 *                     frames.append(<void*>err)             # <<<<<<<<<<<<<<
 *                     frames.append(<void*>errnum)
 *                     frames.append(<void*>errmsg)
 */
        __pyx_t_1 = ((struct __pyx_vtabstruct_8volttron_8platform_3vip_6router_5queue_Queue *)__pyx_v_frames->__pyx_vtab)->append(__pyx_v_frames, ((void *)__pyx_v_err)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 351, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

        /* "volttron/platform/vip/router/routercy.pyx":352
 *                     err = cymessage.Frame(b'error')
 *                     frames.append(<void*>err)
 *                     frames.append(<void*>errnum)             # <<<<<<<<<<<<<<
 *                     frames.append(<void*>errmsg)
 *                     frames.append(<void*>temp)
 */
        __pyx_t_1 = ((struct __pyx_vtabstruct_8volttron_8platform_3vip_6router_5queue_Queue *)__pyx_v_frames->__pyx_vtab)->append(__pyx_v_frames, ((void *)__pyx_v_errnum)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 352, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

        /* "volttron/platform/vip/router/routercy.pyx":353
 *                     frames.append(<void*>err)
 *                     frames.append(<void*>errnum)
 *                     frames.append(<void*>errmsg)             # <<<<<<<<<<<<<<
 *                     frames.append(<void*>temp)
 *                     frames.append(<void*>subsystem)
 */
        __pyx_t_1 = ((struct __pyx_vtabstruct_8volttron_8platform_3vip_6router_5queue_Queue *)__pyx_v_frames->__pyx_vtab)->append(__pyx_v_frames, ((void *)__pyx_v_errmsg)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 353, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

        /* "volttron/platform/vip/router/routercy.pyx":354
 *                     frames.append(<void*>errnum)
 *                     frames.append(<void*>errmsg)
 *                     frames.append(<void*>temp)             # <<<<<<<<<<<<<<
 *                     frames.append(<void*>subsystem)
 *                 elif not response:
 */
        __pyx_t_1 = ((struct __pyx_vtabstruct_8volttron_8platform_3vip_6router_5queue_Queue *)__pyx_v_frames->__pyx_vtab)->append(__pyx_v_frames, ((void *)__pyx_v_temp)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 354, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

        /* "volttron/platform/vip/router/routercy.pyx":355
 *                     frames.append(<void*>errmsg)
 *                     frames.append(<void*>temp)
 *                     frames.append(<void*>subsystem)             # <<<<<<<<<<<<<<
 *                 elif not response:
 *                     # Subsystem does not require a response
 */
        __pyx_t_1 = ((struct __pyx_vtabstruct_8volttron_8platform_3vip_6router_5queue_Queue *)__pyx_v_frames->__pyx_vtab)->append(__pyx_v_frames, ((void *)__pyx_v_subsystem)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 355, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

        /* "volttron/platform/vip/router/routercy.pyx":339
 *             else:
 *                 response = self.handle_subsystem(frames, user_id)
 *                 if response is None:             # <<<<<<<<<<<<<<
 *                     # Handler does not know of the subsystem
 *                     errnum, errmsg = error = _INVALID_SUBSYSTEM
 */
        goto __pyx_L22;
      }

      /* "volttron/platform/vip/router/routercy.pyx":356
 *                     frames.append(<void*>temp)
 *                     frames.append(<void*>subsystem)
 *                 elif not response:             # <<<<<<<<<<<<<<
 *                     # Subsystem does not require a response
 *                     return
 */
      __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_v_response); if (unlikely(__pyx_t_7 < 0)) __PYX_ERR(0, 356, __pyx_L1_error)
      __pyx_t_9 = ((!__pyx_t_7) != 0);
      if (__pyx_t_9) {

        /* "volttron/platform/vip/router/routercy.pyx":358
 *                 elif not response:
 *                     # Subsystem does not require a response
 *                     return             # <<<<<<<<<<<<<<
 *                 else:
 *                     frames = response
 */
        __Pyx_XDECREF(__pyx_r);
        __pyx_r = Py_None; __Pyx_INCREF(Py_None);
        goto __pyx_L0;

        /* "volttron/platform/vip/router/routercy.pyx":356
 *                     frames.append(<void*>temp)
 *                     frames.append(<void*>subsystem)
 *                 elif not response:             # <<<<<<<<<<<<<<
 *                     # Subsystem does not require a response
 *                     return
 */
      }

      /* "volttron/platform/vip/router/routercy.pyx":360
 *                     return
 *                 else:
 *                     frames = response             # <<<<<<<<<<<<<<
 *         else:
 *             # Route all other requests to the recipient
 */
      /*else*/ {
        if (!(likely(((__pyx_v_response) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_response, __pyx_ptype_8volttron_8platform_3vip_6router_5queue_Queue))))) __PYX_ERR(0, 360, __pyx_L1_error)
        __pyx_t_1 = __pyx_v_response;
        __Pyx_INCREF(__pyx_t_1);
        __Pyx_DECREF_SET(__pyx_v_frames, ((struct __pyx_obj_8volttron_8platform_3vip_6router_5queue_Queue *)__pyx_t_1));
        __pyx_t_1 = 0;
      }
      __pyx_L22:;
    }
    __pyx_L10:;

    /* "volttron/platform/vip/router/routercy.pyx":278
 *         self._add_peer(sender.bytes())
 *         subsystem = <cymessage.Frame>frames.pop()
 *         if not recipient.bytes():             # <<<<<<<<<<<<<<
 *             # Handle requests directed at the router
 *             name = subsystem.bytes()
 */
    goto __pyx_L9;
  }

  /* "volttron/platform/vip/router/routercy.pyx":364
 *             # Route all other requests to the recipient
 *             #frames.clear()
 *             frames.append(<void*>sender)             # <<<<<<<<<<<<<<
 *             frames.append(<void*>recipient)
 *             frames.append(<void*>proto)
 */
  /*else*/ {
    __pyx_t_1 = ((struct __pyx_vtabstruct_8volttron_8platform_3vip_6router_5queue_Queue *)__pyx_v_frames->__pyx_vtab)->append(__pyx_v_frames, ((void *)__pyx_v_sender)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 364, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "volttron/platform/vip/router/routercy.pyx":365
 *             #frames.clear()
 *             frames.append(<void*>sender)
 *             frames.append(<void*>recipient)             # <<<<<<<<<<<<<<
 *             frames.append(<void*>proto)
 * 
 */
    __pyx_t_1 = ((struct __pyx_vtabstruct_8volttron_8platform_3vip_6router_5queue_Queue *)__pyx_v_frames->__pyx_vtab)->append(__pyx_v_frames, ((void *)__pyx_v_recipient)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 365, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "volttron/platform/vip/router/routercy.pyx":366
 *             frames.append(<void*>sender)
 *             frames.append(<void*>recipient)
 *             frames.append(<void*>proto)             # <<<<<<<<<<<<<<
 * 
 *         peerlist = self._send(frames)
 */
    __pyx_t_1 = ((struct __pyx_vtabstruct_8volttron_8platform_3vip_6router_5queue_Queue *)__pyx_v_frames->__pyx_vtab)->append(__pyx_v_frames, ((void *)__pyx_v_proto)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 366, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  }
  __pyx_L9:;

  /* "volttron/platform/vip/router/routercy.pyx":368
 *             frames.append(<void*>proto)
 * 
 *         peerlist = self._send(frames)             # <<<<<<<<<<<<<<
 * 
 *         it = peerlist.begin()
 */
  __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_8volttron_8platform_3vip_6router_8routercy_BaseRouter *)__pyx_v_self->__pyx_vtab)->_send(__pyx_v_self, __pyx_v_frames, 0)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 368, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_17 = __pyx_convert_vector_from_py_std_3a__3a_string(__pyx_t_1); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 368, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_peerlist = __pyx_t_17;

  /* "volttron/platform/vip/router/routercy.pyx":370
 *         peerlist = self._send(frames)
 * 
 *         it = peerlist.begin()             # <<<<<<<<<<<<<<
 *         while(it != peerlist.end()):
 *             peer = dereference(it)
 */
  __pyx_v_it = __pyx_v_peerlist.begin();

  /* "volttron/platform/vip/router/routercy.pyx":371
 * 
 *         it = peerlist.begin()
 *         while(it != peerlist.end()):             # <<<<<<<<<<<<<<
 *             peer = dereference(it)
 *             self._drop_peer(peer)
 */
  while (1) {
    __pyx_t_9 = ((__pyx_v_it != __pyx_v_peerlist.end()) != 0);
    if (!__pyx_t_9) break;

    /* "volttron/platform/vip/router/routercy.pyx":372
 *         it = peerlist.begin()
 *         while(it != peerlist.end()):
 *             peer = dereference(it)             # <<<<<<<<<<<<<<
 *             self._drop_peer(peer)
 *             preincrement(it)
 */
    __pyx_v_peer = (*__pyx_v_it);

    /* "volttron/platform/vip/router/routercy.pyx":373
 *         while(it != peerlist.end()):
 *             peer = dereference(it)
 *             self._drop_peer(peer)             # <<<<<<<<<<<<<<
 *             preincrement(it)
 * 
 */
    __pyx_t_1 = ((struct __pyx_vtabstruct_8volttron_8platform_3vip_6router_8routercy_BaseRouter *)__pyx_v_self->__pyx_vtab)->_drop_peer(__pyx_v_self, __pyx_v_peer, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 373, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "volttron/platform/vip/router/routercy.pyx":374
 *             peer = dereference(it)
 *             self._drop_peer(peer)
 *             preincrement(it)             # <<<<<<<<<<<<<<
 * 
 *     cpdef Queue _send(self, Queue frames):
 */
    (++__pyx_v_it);
  }

  /* "volttron/platform/vip/router/routercy.pyx":228
 *         self._distribute(b'peerlist', b'drop', peer)
 * 
 *     cpdef route(self):             # <<<<<<<<<<<<<<
 *         '''Route one message and return.
 * 
 */

  /* function exit code */
  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_AddTraceback("volttron.platform.vip.router.routercy.BaseRouter.route", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __Pyx_XDECREF((PyObject *)__pyx_v_socket);
  __Pyx_XDECREF(__pyx_v_issue);
  __Pyx_XDECREF((PyObject *)__pyx_v_frames);
  __Pyx_XDECREF((PyObject *)__pyx_v_sender);
  __Pyx_XDECREF((PyObject *)__pyx_v_recipient);
  __Pyx_XDECREF((PyObject *)__pyx_v_proto);
  __Pyx_XDECREF((PyObject *)__pyx_v_auth_token);
  __Pyx_XDECREF((PyObject *)__pyx_v_msg_id);
  __Pyx_XDECREF((PyObject *)__pyx_v_name);
  __Pyx_XDECREF((PyObject *)__pyx_v_hello);
  __Pyx_XDECREF((PyObject *)__pyx_v_welcome);
  __Pyx_XDECREF((PyObject *)__pyx_v_ping);
  __Pyx_XDECREF((PyObject *)__pyx_v_pong);
  __Pyx_XDECREF((PyObject *)__pyx_v_temp);
  __Pyx_XDECREF((PyObject *)__pyx_v_ver);
  __Pyx_XDECREF((PyObject *)__pyx_v_err);
  __Pyx_XDECREF((PyObject *)__pyx_v_errnum);
  __Pyx_XDECREF((PyObject *)__pyx_v_errmsg);
  __Pyx_XDECREF((PyObject *)__pyx_v_subsystem);
  __Pyx_XDECREF((PyObject *)__pyx_v_opr);
  __Pyx_XDECREF(__pyx_v_op);
  __Pyx_XDECREF(__pyx_v_listing);
  __Pyx_XDECREF(__pyx_v_error);
  __Pyx_XDECREF(__pyx_v_response);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_25route(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_24route[] = "Route one message and return.\n\n        One message is read from the socket and processed. If the\n        recipient is the router (empty recipient), the standard hello\n        and ping subsystems are handled. Other subsystems are sent to\n        handle_subsystem() for processing. Messages destined for other\n        entities are routed appropriately.\n        ";
static PyObject *__pyx_pw_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_25route(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("route (wrapper)", 0);
  __pyx_r = __pyx_pf_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_24route(((struct __pyx_obj_8volttron_8platform_3vip_6router_8routercy_BaseRouter *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_24route(struct __pyx_obj_8volttron_8platform_3vip_6router_8routercy_BaseRouter *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  __Pyx_RefNannySetupContext("route", 0);
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = __pyx_f_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_route(__pyx_v_self, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 228, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("volttron.platform.vip.router.routercy.BaseRouter.route", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "volttron/platform/vip/router/routercy.pyx":376
 *             preincrement(it)
 * 
 *     cpdef Queue _send(self, Queue frames):             # <<<<<<<<<<<<<<
 *         cdef:
 *             object issue
 */

static PyObject *__pyx_pw_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_27_send(PyObject *__pyx_v_self, PyObject *__pyx_v_frames); /*proto*/
static struct __pyx_obj_8volttron_8platform_3vip_6router_5queue_Queue *__pyx_f_8volttron_8platform_3vip_6router_8routercy_10BaseRouter__send(struct __pyx_obj_8volttron_8platform_3vip_6router_8routercy_BaseRouter *__pyx_v_self, struct __pyx_obj_8volttron_8platform_3vip_6router_5queue_Queue *__pyx_v_frames, int __pyx_skip_dispatch) {
  PyObject *__pyx_v_issue = 0;
  struct __pyx_obj_8volttron_8platform_3vip_6router_8cysocket_Socket *__pyx_v_socket = 0;
  struct __pyx_obj_8volttron_8platform_3vip_6router_9cymessage_Frame *__pyx_v_recipient = 0;
  struct __pyx_obj_8volttron_8platform_3vip_6router_9cymessage_Frame *__pyx_v_sender = 0;
  struct __pyx_obj_8volttron_8platform_3vip_6router_9cymessage_Frame *__pyx_v_proto = 0;
  struct __pyx_obj_8volttron_8platform_3vip_6router_9cymessage_Frame *__pyx_v_user_id = 0;
  struct __pyx_obj_8volttron_8platform_3vip_6router_9cymessage_Frame *__pyx_v_msg_id = 0;
  struct __pyx_obj_8volttron_8platform_3vip_6router_9cymessage_Frame *__pyx_v_subsystem = 0;
  struct __pyx_obj_8volttron_8platform_3vip_6router_9cymessage_Frame *__pyx_v_erno = 0;
  struct __pyx_obj_8volttron_8platform_3vip_6router_9cymessage_Frame *__pyx_v_ermsg = 0;
  struct __pyx_obj_8volttron_8platform_3vip_6router_9cymessage_Frame *__pyx_v_err = 0;
  std::string __pyx_v_errmsg;
  std::string __pyx_v_errnum;
  struct __pyx_obj_8volttron_8platform_3vip_6router_5queue_Queue *__pyx_v_drop = 0;
  CYTHON_UNUSED struct __pyx_obj_8volttron_8platform_3vip_6router_5queue_Queue *__pyx_v_send_frames = 0;
  PyObject *__pyx_v_sendr = 0;
  PyObject *__pyx_v_rec = 0;
  PyObject *__pyx_v_exc = NULL;
  PyObject *__pyx_v_error = NULL;
  struct __pyx_obj_8volttron_8platform_3vip_6router_5queue_Queue *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  PyObject *__pyx_t_6 = NULL;
  PyObject *__pyx_t_7 = NULL;
  PyObject *__pyx_t_8 = NULL;
  Py_ssize_t __pyx_t_9;
  int __pyx_t_10;
  PyObject *__pyx_t_11 = NULL;
  PyObject *__pyx_t_12 = NULL;
  PyObject *__pyx_t_13 = NULL;
  PyObject *__pyx_t_14 = NULL;
  PyObject *__pyx_t_15 = NULL;
  PyObject *(*__pyx_t_16)(PyObject *);
  std::string __pyx_t_17;
  std::string __pyx_t_18;
  int __pyx_t_19;
  int __pyx_t_20;
  PyObject *__pyx_t_21 = NULL;
  int __pyx_t_22;
  PyObject *__pyx_t_23 = NULL;
  PyObject *__pyx_t_24 = NULL;
  PyObject *__pyx_t_25 = NULL;
  PyObject *__pyx_t_26 = NULL;
  PyObject *__pyx_t_27 = NULL;
  PyObject *__pyx_t_28 = NULL;
  __Pyx_RefNannySetupContext("_send", 0);
  /* Check if called by wrapper */
  if (unlikely(__pyx_skip_dispatch)) ;
  /* Check if overridden in Python */
  else if (unlikely(Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0)) {
    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_send); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 376, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)__pyx_pw_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_27_send)) {
      __Pyx_XDECREF(((PyObject *)__pyx_r));
      __Pyx_INCREF(__pyx_t_1);
      __pyx_t_3 = __pyx_t_1; __pyx_t_4 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_3))) {
        __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
        if (likely(__pyx_t_4)) {
          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
          __Pyx_INCREF(__pyx_t_4);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_3, function);
        }
      }
      if (!__pyx_t_4) {
        __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_t_3, ((PyObject *)__pyx_v_frames)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 376, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
      } else {
        __pyx_t_5 = PyTuple_New(1+1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 376, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_5);
        __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_4); __pyx_t_4 = NULL;
        __Pyx_INCREF(((PyObject *)__pyx_v_frames));
        __Pyx_GIVEREF(((PyObject *)__pyx_v_frames));
        PyTuple_SET_ITEM(__pyx_t_5, 0+1, ((PyObject *)__pyx_v_frames));
        __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_5, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 376, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
      }
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      if (!(likely(((__pyx_t_2) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_2, __pyx_ptype_8volttron_8platform_3vip_6router_5queue_Queue))))) __PYX_ERR(0, 376, __pyx_L1_error)
      __pyx_r = ((struct __pyx_obj_8volttron_8platform_3vip_6router_5queue_Queue *)__pyx_t_2);
      __pyx_t_2 = 0;
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      goto __pyx_L0;
    }
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  }

  /* "volttron/platform/vip/router/routercy.pyx":383
 *             cymessage.Frame erno, ermsg, err
 *             string errmsg, errnum
 *             Queue drop = Queue()             # <<<<<<<<<<<<<<
 *             Queue send_frames = Queue()
 *             bytes sendr, rec
 */
  __pyx_t_1 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_8volttron_8platform_3vip_6router_5queue_Queue), __pyx_empty_tuple, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 383, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_drop = ((struct __pyx_obj_8volttron_8platform_3vip_6router_5queue_Queue *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "volttron/platform/vip/router/routercy.pyx":384
 *             string errmsg, errnum
 *             Queue drop = Queue()
 *             Queue send_frames = Queue()             # <<<<<<<<<<<<<<
 *             bytes sendr, rec
 *         issue = self.issue
 */
  __pyx_t_1 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_8volttron_8platform_3vip_6router_5queue_Queue), __pyx_empty_tuple, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 384, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_send_frames = ((struct __pyx_obj_8volttron_8platform_3vip_6router_5queue_Queue *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "volttron/platform/vip/router/routercy.pyx":386
 *             Queue send_frames = Queue()
 *             bytes sendr, rec
 *         issue = self.issue             # <<<<<<<<<<<<<<
 *         socket = self.socket
 * 
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_issue); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 386, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_issue = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "volttron/platform/vip/router/routercy.pyx":387
 *             bytes sendr, rec
 *         issue = self.issue
 *         socket = self.socket             # <<<<<<<<<<<<<<
 * 
 *         #recipient, sender = frames[:2]
 */
  __pyx_t_1 = ((PyObject *)__pyx_v_self->socket);
  __Pyx_INCREF(__pyx_t_1);
  __pyx_v_socket = ((struct __pyx_obj_8volttron_8platform_3vip_6router_8cysocket_Socket *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "volttron/platform/vip/router/routercy.pyx":390
 * 
 *         #recipient, sender = frames[:2]
 *         recipient = frames.at(0)             # <<<<<<<<<<<<<<
 *         sender = frames.at(1)
 *         # Expecting outgoing frames:
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_frames), __pyx_n_s_at); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 390, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_tuple__16, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 390, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (!(likely(((__pyx_t_2) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_2, __pyx_ptype_8volttron_8platform_3vip_6router_9cymessage_Frame))))) __PYX_ERR(0, 390, __pyx_L1_error)
  __pyx_v_recipient = ((struct __pyx_obj_8volttron_8platform_3vip_6router_9cymessage_Frame *)__pyx_t_2);
  __pyx_t_2 = 0;

  /* "volttron/platform/vip/router/routercy.pyx":391
 *         #recipient, sender = frames[:2]
 *         recipient = frames.at(0)
 *         sender = frames.at(1)             # <<<<<<<<<<<<<<
 *         # Expecting outgoing frames:
 *         #   [RECIPIENT, SENDER, PROTO, USER_ID, MSG_ID, SUBSYS, ...]
 */
  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_frames), __pyx_n_s_at); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 391, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_tuple__17, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 391, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_8volttron_8platform_3vip_6router_9cymessage_Frame))))) __PYX_ERR(0, 391, __pyx_L1_error)
  __pyx_v_sender = ((struct __pyx_obj_8volttron_8platform_3vip_6router_9cymessage_Frame *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "volttron/platform/vip/router/routercy.pyx":394
 *         # Expecting outgoing frames:
 *         #   [RECIPIENT, SENDER, PROTO, USER_ID, MSG_ID, SUBSYS, ...]
 *         try:             # <<<<<<<<<<<<<<
 *             # Try sending the message to its recipient
 *             socket.send_multipart(frames, flags=NOBLOCK, copy=False)
 */
  {
    __Pyx_PyThreadState_declare
    __Pyx_PyThreadState_assign
    __Pyx_ExceptionSave(&__pyx_t_6, &__pyx_t_7, &__pyx_t_8);
    __Pyx_XGOTREF(__pyx_t_6);
    __Pyx_XGOTREF(__pyx_t_7);
    __Pyx_XGOTREF(__pyx_t_8);
    /*try:*/ {

      /* "volttron/platform/vip/router/routercy.pyx":396
 *         try:
 *             # Try sending the message to its recipient
 *             socket.send_multipart(frames, flags=NOBLOCK, copy=False)             # <<<<<<<<<<<<<<
 *             issue(self.OUTGOING, frames)
 *         except ZMQError as exc:
 */
      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_socket), __pyx_n_s_send_multipart); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 396, __pyx_L3_error)
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 396, __pyx_L3_error)
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_INCREF(((PyObject *)__pyx_v_frames));
      __Pyx_GIVEREF(((PyObject *)__pyx_v_frames));
      PyTuple_SET_ITEM(__pyx_t_2, 0, ((PyObject *)__pyx_v_frames));
      __pyx_t_3 = PyDict_New(); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 396, __pyx_L3_error)
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_NOBLOCK); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 396, __pyx_L3_error)
      __Pyx_GOTREF(__pyx_t_5);
      if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_flags, __pyx_t_5) < 0) __PYX_ERR(0, 396, __pyx_L3_error)
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
      if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_copy, Py_False) < 0) __PYX_ERR(0, 396, __pyx_L3_error)
      __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 396, __pyx_L3_error)
      __Pyx_GOTREF(__pyx_t_5);
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;

      /* "volttron/platform/vip/router/routercy.pyx":397
 *             # Try sending the message to its recipient
 *             socket.send_multipart(frames, flags=NOBLOCK, copy=False)
 *             issue(self.OUTGOING, frames)             # <<<<<<<<<<<<<<
 *         except ZMQError as exc:
 *             try:
 */
      __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_self->OUTGOING); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 397, __pyx_L3_error)
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_INCREF(__pyx_v_issue);
      __pyx_t_2 = __pyx_v_issue; __pyx_t_1 = NULL;
      __pyx_t_9 = 0;
      if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_2))) {
        __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_2);
        if (likely(__pyx_t_1)) {
          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
          __Pyx_INCREF(__pyx_t_1);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_2, function);
          __pyx_t_9 = 1;
        }
      }
      __pyx_t_4 = PyTuple_New(2+__pyx_t_9); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 397, __pyx_L3_error)
      __Pyx_GOTREF(__pyx_t_4);
      if (__pyx_t_1) {
        __Pyx_GIVEREF(__pyx_t_1); PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_1); __pyx_t_1 = NULL;
      }
      __Pyx_GIVEREF(__pyx_t_3);
      PyTuple_SET_ITEM(__pyx_t_4, 0+__pyx_t_9, __pyx_t_3);
      __Pyx_INCREF(((PyObject *)__pyx_v_frames));
      __Pyx_GIVEREF(((PyObject *)__pyx_v_frames));
      PyTuple_SET_ITEM(__pyx_t_4, 1+__pyx_t_9, ((PyObject *)__pyx_v_frames));
      __pyx_t_3 = 0;
      __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_4, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 397, __pyx_L3_error)
      __Pyx_GOTREF(__pyx_t_5);
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;

      /* "volttron/platform/vip/router/routercy.pyx":394
 *         # Expecting outgoing frames:
 *         #   [RECIPIENT, SENDER, PROTO, USER_ID, MSG_ID, SUBSYS, ...]
 *         try:             # <<<<<<<<<<<<<<
 *             # Try sending the message to its recipient
 *             socket.send_multipart(frames, flags=NOBLOCK, copy=False)
 */
    }
    __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
    __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
    __Pyx_XDECREF(__pyx_t_8); __pyx_t_8 = 0;
    goto __pyx_L10_try_end;
    __pyx_L3_error:;
    __Pyx_PyThreadState_assign
    __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
    __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
    __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
    __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;

    /* "volttron/platform/vip/router/routercy.pyx":398
 *             socket.send_multipart(frames, flags=NOBLOCK, copy=False)
 *             issue(self.OUTGOING, frames)
 *         except ZMQError as exc:             # <<<<<<<<<<<<<<
 *             try:
 *                 errnum, errmsg = error = _ROUTE_ERRORS[exc.errno]
 */
    __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_ZMQError); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 398, __pyx_L5_except_error)
    __Pyx_GOTREF(__pyx_t_5);
    __pyx_t_10 = __Pyx_PyErr_ExceptionMatches(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    if (__pyx_t_10) {
      __Pyx_AddTraceback("volttron.platform.vip.router.routercy.BaseRouter._send", __pyx_clineno, __pyx_lineno, __pyx_filename);
      if (__Pyx_GetException(&__pyx_t_5, &__pyx_t_2, &__pyx_t_4) < 0) __PYX_ERR(0, 398, __pyx_L5_except_error)
      __Pyx_GOTREF(__pyx_t_5);
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_GOTREF(__pyx_t_4);
      __Pyx_INCREF(__pyx_t_2);
      __pyx_v_exc = __pyx_t_2;

      /* "volttron/platform/vip/router/routercy.pyx":399
 *             issue(self.OUTGOING, frames)
 *         except ZMQError as exc:
 *             try:             # <<<<<<<<<<<<<<
 *                 errnum, errmsg = error = _ROUTE_ERRORS[exc.errno]
 *             except KeyError:
 */
      {
        __Pyx_PyThreadState_declare
        __Pyx_PyThreadState_assign
        __Pyx_ExceptionSave(&__pyx_t_11, &__pyx_t_12, &__pyx_t_13);
        __Pyx_XGOTREF(__pyx_t_11);
        __Pyx_XGOTREF(__pyx_t_12);
        __Pyx_XGOTREF(__pyx_t_13);
        /*try:*/ {

          /* "volttron/platform/vip/router/routercy.pyx":400
 *         except ZMQError as exc:
 *             try:
 *                 errnum, errmsg = error = _ROUTE_ERRORS[exc.errno]             # <<<<<<<<<<<<<<
 *             except KeyError:
 *                 error = None
 */
          __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_ROUTE_ERRORS); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 400, __pyx_L13_error)
          __Pyx_GOTREF(__pyx_t_3);
          __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_exc, __pyx_n_s_errno); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 400, __pyx_L13_error)
          __Pyx_GOTREF(__pyx_t_1);
          __pyx_t_14 = PyObject_GetItem(__pyx_t_3, __pyx_t_1); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 400, __pyx_L13_error)
          __Pyx_GOTREF(__pyx_t_14);
          __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
          __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
          if ((likely(PyTuple_CheckExact(__pyx_t_14))) || (PyList_CheckExact(__pyx_t_14))) {
            PyObject* sequence = __pyx_t_14;
            #if CYTHON_COMPILING_IN_CPYTHON
            Py_ssize_t size = Py_SIZE(sequence);
            #else
            Py_ssize_t size = PySequence_Size(sequence);
            #endif
            if (unlikely(size != 2)) {
              if (size > 2) __Pyx_RaiseTooManyValuesError(2);
              else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
              __PYX_ERR(0, 400, __pyx_L13_error)
            }
            #if CYTHON_COMPILING_IN_CPYTHON
            if (likely(PyTuple_CheckExact(sequence))) {
              __pyx_t_1 = PyTuple_GET_ITEM(sequence, 0); 
              __pyx_t_3 = PyTuple_GET_ITEM(sequence, 1); 
            } else {
              __pyx_t_1 = PyList_GET_ITEM(sequence, 0); 
              __pyx_t_3 = PyList_GET_ITEM(sequence, 1); 
            }
            __Pyx_INCREF(__pyx_t_1);
            __Pyx_INCREF(__pyx_t_3);
            #else
            __pyx_t_1 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 400, __pyx_L13_error)
            __Pyx_GOTREF(__pyx_t_1);
            __pyx_t_3 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 400, __pyx_L13_error)
            __Pyx_GOTREF(__pyx_t_3);
            #endif
          } else {
            Py_ssize_t index = -1;
            __pyx_t_15 = PyObject_GetIter(__pyx_t_14); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 400, __pyx_L13_error)
            __Pyx_GOTREF(__pyx_t_15);
            __pyx_t_16 = Py_TYPE(__pyx_t_15)->tp_iternext;
            index = 0; __pyx_t_1 = __pyx_t_16(__pyx_t_15); if (unlikely(!__pyx_t_1)) goto __pyx_L21_unpacking_failed;
            __Pyx_GOTREF(__pyx_t_1);
            index = 1; __pyx_t_3 = __pyx_t_16(__pyx_t_15); if (unlikely(!__pyx_t_3)) goto __pyx_L21_unpacking_failed;
            __Pyx_GOTREF(__pyx_t_3);
            if (__Pyx_IternextUnpackEndCheck(__pyx_t_16(__pyx_t_15), 2) < 0) __PYX_ERR(0, 400, __pyx_L13_error)
            __pyx_t_16 = NULL;
            __Pyx_DECREF(__pyx_t_15); __pyx_t_15 = 0;
            goto __pyx_L22_unpacking_done;
            __pyx_L21_unpacking_failed:;
            __Pyx_DECREF(__pyx_t_15); __pyx_t_15 = 0;
            __pyx_t_16 = NULL;
            if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
            __PYX_ERR(0, 400, __pyx_L13_error)
            __pyx_L22_unpacking_done:;
          }
          __pyx_t_17 = __pyx_convert_string_from_py_std__in_string(__pyx_t_1); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 400, __pyx_L13_error)
          __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
          __pyx_t_18 = __pyx_convert_string_from_py_std__in_string(__pyx_t_3); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 400, __pyx_L13_error)
          __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
          __pyx_v_errnum = __pyx_t_17;
          __pyx_v_errmsg = __pyx_t_18;
          __Pyx_INCREF(__pyx_t_14);
          __pyx_v_error = __pyx_t_14;
          __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;

          /* "volttron/platform/vip/router/routercy.pyx":399
 *             issue(self.OUTGOING, frames)
 *         except ZMQError as exc:
 *             try:             # <<<<<<<<<<<<<<
 *                 errnum, errmsg = error = _ROUTE_ERRORS[exc.errno]
 *             except KeyError:
 */
        }
        __Pyx_XDECREF(__pyx_t_11); __pyx_t_11 = 0;
        __Pyx_XDECREF(__pyx_t_12); __pyx_t_12 = 0;
        __Pyx_XDECREF(__pyx_t_13); __pyx_t_13 = 0;
        goto __pyx_L20_try_end;
        __pyx_L13_error:;
        __Pyx_PyThreadState_assign
        __Pyx_XDECREF(__pyx_t_15); __pyx_t_15 = 0;
        __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
        __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
        __Pyx_XDECREF(__pyx_t_14); __pyx_t_14 = 0;

        /* "volttron/platform/vip/router/routercy.pyx":401
 *             try:
 *                 errnum, errmsg = error = _ROUTE_ERRORS[exc.errno]
 *             except KeyError:             # <<<<<<<<<<<<<<
 *                 error = None
 *             if error is None:
 */
        __pyx_t_10 = __Pyx_PyErr_ExceptionMatches(__pyx_builtin_KeyError);
        if (__pyx_t_10) {
          __Pyx_AddTraceback("volttron.platform.vip.router.routercy.BaseRouter._send", __pyx_clineno, __pyx_lineno, __pyx_filename);
          if (__Pyx_GetException(&__pyx_t_14, &__pyx_t_3, &__pyx_t_1) < 0) __PYX_ERR(0, 401, __pyx_L15_except_error)
          __Pyx_GOTREF(__pyx_t_14);
          __Pyx_GOTREF(__pyx_t_3);
          __Pyx_GOTREF(__pyx_t_1);

          /* "volttron/platform/vip/router/routercy.pyx":402
 *                 errnum, errmsg = error = _ROUTE_ERRORS[exc.errno]
 *             except KeyError:
 *                 error = None             # <<<<<<<<<<<<<<
 *             if error is None:
 *                 raise
 */
          __Pyx_INCREF(Py_None);
          __Pyx_XDECREF_SET(__pyx_v_error, Py_None);
          __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
          __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
          __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
          goto __pyx_L14_exception_handled;
        }
        goto __pyx_L15_except_error;
        __pyx_L15_except_error:;

        /* "volttron/platform/vip/router/routercy.pyx":399
 *             issue(self.OUTGOING, frames)
 *         except ZMQError as exc:
 *             try:             # <<<<<<<<<<<<<<
 *                 errnum, errmsg = error = _ROUTE_ERRORS[exc.errno]
 *             except KeyError:
 */
        __Pyx_PyThreadState_assign
        __Pyx_XGIVEREF(__pyx_t_11);
        __Pyx_XGIVEREF(__pyx_t_12);
        __Pyx_XGIVEREF(__pyx_t_13);
        __Pyx_ExceptionReset(__pyx_t_11, __pyx_t_12, __pyx_t_13);
        goto __pyx_L5_except_error;
        __pyx_L14_exception_handled:;
        __Pyx_PyThreadState_assign
        __Pyx_XGIVEREF(__pyx_t_11);
        __Pyx_XGIVEREF(__pyx_t_12);
        __Pyx_XGIVEREF(__pyx_t_13);
        __Pyx_ExceptionReset(__pyx_t_11, __pyx_t_12, __pyx_t_13);
        __pyx_L20_try_end:;
      }

      /* "volttron/platform/vip/router/routercy.pyx":403
 *             except KeyError:
 *                 error = None
 *             if error is None:             # <<<<<<<<<<<<<<
 *                 raise
 *             issue(ERROR, frames, error)
 */
      __pyx_t_19 = (__pyx_v_error == Py_None);
      __pyx_t_20 = (__pyx_t_19 != 0);
      if (__pyx_t_20) {

        /* "volttron/platform/vip/router/routercy.pyx":404
 *                 error = None
 *             if error is None:
 *                 raise             # <<<<<<<<<<<<<<
 *             issue(ERROR, frames, error)
 *             if exc.errno == EHOSTUNREACH:
 */
        __Pyx_GIVEREF(__pyx_t_5);
        __Pyx_GIVEREF(__pyx_t_2);
        __Pyx_XGIVEREF(__pyx_t_4);
        __Pyx_ErrRestoreWithState(__pyx_t_5, __pyx_t_2, __pyx_t_4);
        __pyx_t_5 = 0; __pyx_t_2 = 0; __pyx_t_4 = 0; 
        __PYX_ERR(0, 404, __pyx_L5_except_error)

        /* "volttron/platform/vip/router/routercy.pyx":403
 *             except KeyError:
 *                 error = None
 *             if error is None:             # <<<<<<<<<<<<<<
 *                 raise
 *             issue(ERROR, frames, error)
 */
      }

      /* "volttron/platform/vip/router/routercy.pyx":405
 *             if error is None:
 *                 raise
 *             issue(ERROR, frames, error)             # <<<<<<<<<<<<<<
 *             if exc.errno == EHOSTUNREACH:
 *                 rec = recipient.bytes()
 */
      __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_ERROR); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 405, __pyx_L5_except_error)
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_INCREF(__pyx_v_issue);
      __pyx_t_14 = __pyx_v_issue; __pyx_t_15 = NULL;
      __pyx_t_9 = 0;
      if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_14))) {
        __pyx_t_15 = PyMethod_GET_SELF(__pyx_t_14);
        if (likely(__pyx_t_15)) {
          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_14);
          __Pyx_INCREF(__pyx_t_15);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_14, function);
          __pyx_t_9 = 1;
        }
      }
      __pyx_t_21 = PyTuple_New(3+__pyx_t_9); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 405, __pyx_L5_except_error)
      __Pyx_GOTREF(__pyx_t_21);
      if (__pyx_t_15) {
        __Pyx_GIVEREF(__pyx_t_15); PyTuple_SET_ITEM(__pyx_t_21, 0, __pyx_t_15); __pyx_t_15 = NULL;
      }
      __Pyx_GIVEREF(__pyx_t_3);
      PyTuple_SET_ITEM(__pyx_t_21, 0+__pyx_t_9, __pyx_t_3);
      __Pyx_INCREF(((PyObject *)__pyx_v_frames));
      __Pyx_GIVEREF(((PyObject *)__pyx_v_frames));
      PyTuple_SET_ITEM(__pyx_t_21, 1+__pyx_t_9, ((PyObject *)__pyx_v_frames));
      __Pyx_INCREF(__pyx_v_error);
      __Pyx_GIVEREF(__pyx_v_error);
      PyTuple_SET_ITEM(__pyx_t_21, 2+__pyx_t_9, __pyx_v_error);
      __pyx_t_3 = 0;
      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_14, __pyx_t_21, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 405, __pyx_L5_except_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_21); __pyx_t_21 = 0;
      __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

      /* "volttron/platform/vip/router/routercy.pyx":406
 *                 raise
 *             issue(ERROR, frames, error)
 *             if exc.errno == EHOSTUNREACH:             # <<<<<<<<<<<<<<
 *                 rec = recipient.bytes()
 *                 drop.append(<void*>rec)
 */
      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_exc, __pyx_n_s_errno); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 406, __pyx_L5_except_error)
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_t_14 = __Pyx_GetModuleGlobalName(__pyx_n_s_EHOSTUNREACH); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 406, __pyx_L5_except_error)
      __Pyx_GOTREF(__pyx_t_14);
      __pyx_t_21 = PyObject_RichCompare(__pyx_t_1, __pyx_t_14, Py_EQ); __Pyx_XGOTREF(__pyx_t_21); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 406, __pyx_L5_except_error)
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
      __pyx_t_20 = __Pyx_PyObject_IsTrue(__pyx_t_21); if (unlikely(__pyx_t_20 < 0)) __PYX_ERR(0, 406, __pyx_L5_except_error)
      __Pyx_DECREF(__pyx_t_21); __pyx_t_21 = 0;
      if (__pyx_t_20) {

        /* "volttron/platform/vip/router/routercy.pyx":407
 *             issue(ERROR, frames, error)
 *             if exc.errno == EHOSTUNREACH:
 *                 rec = recipient.bytes()             # <<<<<<<<<<<<<<
 *                 drop.append(<void*>rec)
 * 
 */
        __pyx_t_21 = ((struct __pyx_vtabstruct_8volttron_8platform_3vip_6router_9cymessage_Frame *)__pyx_v_recipient->__pyx_vtab)->bytes(__pyx_v_recipient); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 407, __pyx_L5_except_error)
        __Pyx_GOTREF(__pyx_t_21);
        if (!(likely(PyBytes_CheckExact(__pyx_t_21))||((__pyx_t_21) == Py_None)||(PyErr_Format(PyExc_TypeError, "Expected %.16s, got %.200s", "bytes", Py_TYPE(__pyx_t_21)->tp_name), 0))) __PYX_ERR(0, 407, __pyx_L5_except_error)
        __pyx_v_rec = ((PyObject*)__pyx_t_21);
        __pyx_t_21 = 0;

        /* "volttron/platform/vip/router/routercy.pyx":408
 *             if exc.errno == EHOSTUNREACH:
 *                 rec = recipient.bytes()
 *                 drop.append(<void*>rec)             # <<<<<<<<<<<<<<
 * 
 *             if exc.errno != EHOSTUNREACH or sender is not frames[0]:
 */
        __pyx_t_21 = ((struct __pyx_vtabstruct_8volttron_8platform_3vip_6router_5queue_Queue *)__pyx_v_drop->__pyx_vtab)->append(__pyx_v_drop, ((void *)__pyx_v_rec)); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 408, __pyx_L5_except_error)
        __Pyx_GOTREF(__pyx_t_21);
        __Pyx_DECREF(__pyx_t_21); __pyx_t_21 = 0;

        /* "volttron/platform/vip/router/routercy.pyx":406
 *                 raise
 *             issue(ERROR, frames, error)
 *             if exc.errno == EHOSTUNREACH:             # <<<<<<<<<<<<<<
 *                 rec = recipient.bytes()
 *                 drop.append(<void*>rec)
 */
      }

      /* "volttron/platform/vip/router/routercy.pyx":410
 *                 drop.append(<void*>rec)
 * 
 *             if exc.errno != EHOSTUNREACH or sender is not frames[0]:             # <<<<<<<<<<<<<<
 *                 # Only send errors if the sender and recipient differ
 *                 proto, user_id, msg_id, subsystem = frames[2:6]
 */
      __pyx_t_21 = __Pyx_PyObject_GetAttrStr(__pyx_v_exc, __pyx_n_s_errno); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 410, __pyx_L5_except_error)
      __Pyx_GOTREF(__pyx_t_21);
      __pyx_t_14 = __Pyx_GetModuleGlobalName(__pyx_n_s_EHOSTUNREACH); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 410, __pyx_L5_except_error)
      __Pyx_GOTREF(__pyx_t_14);
      __pyx_t_1 = PyObject_RichCompare(__pyx_t_21, __pyx_t_14, Py_NE); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 410, __pyx_L5_except_error)
      __Pyx_DECREF(__pyx_t_21); __pyx_t_21 = 0;
      __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
      __pyx_t_19 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_19 < 0)) __PYX_ERR(0, 410, __pyx_L5_except_error)
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      if (!__pyx_t_19) {
      } else {
        __pyx_t_20 = __pyx_t_19;
        goto __pyx_L28_bool_binop_done;
      }
      __pyx_t_1 = __Pyx_GetItemInt(((PyObject *)__pyx_v_frames), 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 410, __pyx_L5_except_error)
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_t_19 = (((PyObject *)__pyx_v_sender) != __pyx_t_1);
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_22 = (__pyx_t_19 != 0);
      __pyx_t_20 = __pyx_t_22;
      __pyx_L28_bool_binop_done:;
      if (__pyx_t_20) {

        /* "volttron/platform/vip/router/routercy.pyx":412
 *             if exc.errno != EHOSTUNREACH or sender is not frames[0]:
 *                 # Only send errors if the sender and recipient differ
 *                 proto, user_id, msg_id, subsystem = frames[2:6]             # <<<<<<<<<<<<<<
 *                 #frames = [sender, b'', proto, user_id, msg_id,
 *                 #          b'error', errnum, errmsg, recipient, subsystem]
 */
        __pyx_t_1 = __Pyx_PyObject_GetSlice(((PyObject *)__pyx_v_frames), 2, 6, NULL, NULL, &__pyx_slice__18, 1, 1, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 412, __pyx_L5_except_error)
        __Pyx_GOTREF(__pyx_t_1);
        if ((likely(PyTuple_CheckExact(__pyx_t_1))) || (PyList_CheckExact(__pyx_t_1))) {
          PyObject* sequence = __pyx_t_1;
          #if CYTHON_COMPILING_IN_CPYTHON
          Py_ssize_t size = Py_SIZE(sequence);
          #else
          Py_ssize_t size = PySequence_Size(sequence);
          #endif
          if (unlikely(size != 4)) {
            if (size > 4) __Pyx_RaiseTooManyValuesError(4);
            else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
            __PYX_ERR(0, 412, __pyx_L5_except_error)
          }
          #if CYTHON_COMPILING_IN_CPYTHON
          if (likely(PyTuple_CheckExact(sequence))) {
            __pyx_t_14 = PyTuple_GET_ITEM(sequence, 0); 
            __pyx_t_21 = PyTuple_GET_ITEM(sequence, 1); 
            __pyx_t_3 = PyTuple_GET_ITEM(sequence, 2); 
            __pyx_t_15 = PyTuple_GET_ITEM(sequence, 3); 
          } else {
            __pyx_t_14 = PyList_GET_ITEM(sequence, 0); 
            __pyx_t_21 = PyList_GET_ITEM(sequence, 1); 
            __pyx_t_3 = PyList_GET_ITEM(sequence, 2); 
            __pyx_t_15 = PyList_GET_ITEM(sequence, 3); 
          }
          __Pyx_INCREF(__pyx_t_14);
          __Pyx_INCREF(__pyx_t_21);
          __Pyx_INCREF(__pyx_t_3);
          __Pyx_INCREF(__pyx_t_15);
          #else
          {
            Py_ssize_t i;
            PyObject** temps[4] = {&__pyx_t_14,&__pyx_t_21,&__pyx_t_3,&__pyx_t_15};
            for (i=0; i < 4; i++) {
              PyObject* item = PySequence_ITEM(sequence, i); if (unlikely(!item)) __PYX_ERR(0, 412, __pyx_L5_except_error)
              __Pyx_GOTREF(item);
              *(temps[i]) = item;
            }
          }
          #endif
          __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
        } else {
          Py_ssize_t index = -1;
          PyObject** temps[4] = {&__pyx_t_14,&__pyx_t_21,&__pyx_t_3,&__pyx_t_15};
          __pyx_t_23 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 412, __pyx_L5_except_error)
          __Pyx_GOTREF(__pyx_t_23);
          __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
          __pyx_t_16 = Py_TYPE(__pyx_t_23)->tp_iternext;
          for (index=0; index < 4; index++) {
            PyObject* item = __pyx_t_16(__pyx_t_23); if (unlikely(!item)) goto __pyx_L30_unpacking_failed;
            __Pyx_GOTREF(item);
            *(temps[index]) = item;
          }
          if (__Pyx_IternextUnpackEndCheck(__pyx_t_16(__pyx_t_23), 4) < 0) __PYX_ERR(0, 412, __pyx_L5_except_error)
          __pyx_t_16 = NULL;
          __Pyx_DECREF(__pyx_t_23); __pyx_t_23 = 0;
          goto __pyx_L31_unpacking_done;
          __pyx_L30_unpacking_failed:;
          __Pyx_DECREF(__pyx_t_23); __pyx_t_23 = 0;
          __pyx_t_16 = NULL;
          if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
          __PYX_ERR(0, 412, __pyx_L5_except_error)
          __pyx_L31_unpacking_done:;
        }
        if (!(likely(((__pyx_t_14) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_14, __pyx_ptype_8volttron_8platform_3vip_6router_9cymessage_Frame))))) __PYX_ERR(0, 412, __pyx_L5_except_error)
        if (!(likely(((__pyx_t_21) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_21, __pyx_ptype_8volttron_8platform_3vip_6router_9cymessage_Frame))))) __PYX_ERR(0, 412, __pyx_L5_except_error)
        if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_8volttron_8platform_3vip_6router_9cymessage_Frame))))) __PYX_ERR(0, 412, __pyx_L5_except_error)
        if (!(likely(((__pyx_t_15) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_15, __pyx_ptype_8volttron_8platform_3vip_6router_9cymessage_Frame))))) __PYX_ERR(0, 412, __pyx_L5_except_error)
        __pyx_v_proto = ((struct __pyx_obj_8volttron_8platform_3vip_6router_9cymessage_Frame *)__pyx_t_14);
        __pyx_t_14 = 0;
        __pyx_v_user_id = ((struct __pyx_obj_8volttron_8platform_3vip_6router_9cymessage_Frame *)__pyx_t_21);
        __pyx_t_21 = 0;
        __pyx_v_msg_id = ((struct __pyx_obj_8volttron_8platform_3vip_6router_9cymessage_Frame *)__pyx_t_3);
        __pyx_t_3 = 0;
        __pyx_v_subsystem = ((struct __pyx_obj_8volttron_8platform_3vip_6router_9cymessage_Frame *)__pyx_t_15);
        __pyx_t_15 = 0;

        /* "volttron/platform/vip/router/routercy.pyx":415
 *                 #frames = [sender, b'', proto, user_id, msg_id,
 *                 #          b'error', errnum, errmsg, recipient, subsystem]
 *                 frames.append(<void*>sender)             # <<<<<<<<<<<<<<
 *                 frames.append(<void*>empty)
 *                 frames.append(<void*>proto)
 */
        __pyx_t_1 = ((struct __pyx_vtabstruct_8volttron_8platform_3vip_6router_5queue_Queue *)__pyx_v_frames->__pyx_vtab)->append(__pyx_v_frames, ((void *)__pyx_v_sender)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 415, __pyx_L5_except_error)
        __Pyx_GOTREF(__pyx_t_1);
        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

        /* "volttron/platform/vip/router/routercy.pyx":416
 *                 #          b'error', errnum, errmsg, recipient, subsystem]
 *                 frames.append(<void*>sender)
 *                 frames.append(<void*>empty)             # <<<<<<<<<<<<<<
 *                 frames.append(<void*>proto)
 *                 frames.append(<void*>user_id)
 */
        __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_empty); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 416, __pyx_L5_except_error)
        __Pyx_GOTREF(__pyx_t_1);
        __pyx_t_15 = ((struct __pyx_vtabstruct_8volttron_8platform_3vip_6router_5queue_Queue *)__pyx_v_frames->__pyx_vtab)->append(__pyx_v_frames, ((void *)__pyx_t_1)); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 416, __pyx_L5_except_error)
        __Pyx_GOTREF(__pyx_t_15);
        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
        __Pyx_DECREF(__pyx_t_15); __pyx_t_15 = 0;

        /* "volttron/platform/vip/router/routercy.pyx":417
 *                 frames.append(<void*>sender)
 *                 frames.append(<void*>empty)
 *                 frames.append(<void*>proto)             # <<<<<<<<<<<<<<
 *                 frames.append(<void*>user_id)
 *                 frames.append(<void*>msg_id)
 */
        __pyx_t_15 = ((struct __pyx_vtabstruct_8volttron_8platform_3vip_6router_5queue_Queue *)__pyx_v_frames->__pyx_vtab)->append(__pyx_v_frames, ((void *)__pyx_v_proto)); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 417, __pyx_L5_except_error)
        __Pyx_GOTREF(__pyx_t_15);
        __Pyx_DECREF(__pyx_t_15); __pyx_t_15 = 0;

        /* "volttron/platform/vip/router/routercy.pyx":418
 *                 frames.append(<void*>empty)
 *                 frames.append(<void*>proto)
 *                 frames.append(<void*>user_id)             # <<<<<<<<<<<<<<
 *                 frames.append(<void*>msg_id)
 *                 err = cymessage.Frame(b'error')
 */
        __pyx_t_15 = ((struct __pyx_vtabstruct_8volttron_8platform_3vip_6router_5queue_Queue *)__pyx_v_frames->__pyx_vtab)->append(__pyx_v_frames, ((void *)__pyx_v_user_id)); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 418, __pyx_L5_except_error)
        __Pyx_GOTREF(__pyx_t_15);
        __Pyx_DECREF(__pyx_t_15); __pyx_t_15 = 0;

        /* "volttron/platform/vip/router/routercy.pyx":419
 *                 frames.append(<void*>proto)
 *                 frames.append(<void*>user_id)
 *                 frames.append(<void*>msg_id)             # <<<<<<<<<<<<<<
 *                 err = cymessage.Frame(b'error')
 *                 frames.append(<void*>err)
 */
        __pyx_t_15 = ((struct __pyx_vtabstruct_8volttron_8platform_3vip_6router_5queue_Queue *)__pyx_v_frames->__pyx_vtab)->append(__pyx_v_frames, ((void *)__pyx_v_msg_id)); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 419, __pyx_L5_except_error)
        __Pyx_GOTREF(__pyx_t_15);
        __Pyx_DECREF(__pyx_t_15); __pyx_t_15 = 0;

        /* "volttron/platform/vip/router/routercy.pyx":420
 *                 frames.append(<void*>user_id)
 *                 frames.append(<void*>msg_id)
 *                 err = cymessage.Frame(b'error')             # <<<<<<<<<<<<<<
 *                 frames.append(<void*>err)
 *                 erno = cymessage.Frame(errnum)
 */
        __pyx_t_15 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_8volttron_8platform_3vip_6router_9cymessage_Frame), __pyx_tuple__19, NULL); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 420, __pyx_L5_except_error)
        __Pyx_GOTREF(__pyx_t_15);
        __pyx_v_err = ((struct __pyx_obj_8volttron_8platform_3vip_6router_9cymessage_Frame *)__pyx_t_15);
        __pyx_t_15 = 0;

        /* "volttron/platform/vip/router/routercy.pyx":421
 *                 frames.append(<void*>msg_id)
 *                 err = cymessage.Frame(b'error')
 *                 frames.append(<void*>err)             # <<<<<<<<<<<<<<
 *                 erno = cymessage.Frame(errnum)
 *                 ermsg = cymessage.Frame(errmsg)
 */
        __pyx_t_15 = ((struct __pyx_vtabstruct_8volttron_8platform_3vip_6router_5queue_Queue *)__pyx_v_frames->__pyx_vtab)->append(__pyx_v_frames, ((void *)__pyx_v_err)); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 421, __pyx_L5_except_error)
        __Pyx_GOTREF(__pyx_t_15);
        __Pyx_DECREF(__pyx_t_15); __pyx_t_15 = 0;

        /* "volttron/platform/vip/router/routercy.pyx":422
 *                 err = cymessage.Frame(b'error')
 *                 frames.append(<void*>err)
 *                 erno = cymessage.Frame(errnum)             # <<<<<<<<<<<<<<
 *                 ermsg = cymessage.Frame(errmsg)
 *                 frames.append(<void*>erno)
 */
        __pyx_t_15 = __pyx_convert_PyBytes_string_to_py_std__in_string(__pyx_v_errnum); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 422, __pyx_L5_except_error)
        __Pyx_GOTREF(__pyx_t_15);
        __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 422, __pyx_L5_except_error)
        __Pyx_GOTREF(__pyx_t_1);
        __Pyx_GIVEREF(__pyx_t_15);
        PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_15);
        __pyx_t_15 = 0;
        __pyx_t_15 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_8volttron_8platform_3vip_6router_9cymessage_Frame), __pyx_t_1, NULL); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 422, __pyx_L5_except_error)
        __Pyx_GOTREF(__pyx_t_15);
        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
        __pyx_v_erno = ((struct __pyx_obj_8volttron_8platform_3vip_6router_9cymessage_Frame *)__pyx_t_15);
        __pyx_t_15 = 0;

        /* "volttron/platform/vip/router/routercy.pyx":423
 *                 frames.append(<void*>err)
 *                 erno = cymessage.Frame(errnum)
 *                 ermsg = cymessage.Frame(errmsg)             # <<<<<<<<<<<<<<
 *                 frames.append(<void*>erno)
 *                 frames.append(<void*>ermsg)
 */
        __pyx_t_15 = __pyx_convert_PyBytes_string_to_py_std__in_string(__pyx_v_errmsg); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 423, __pyx_L5_except_error)
        __Pyx_GOTREF(__pyx_t_15);
        __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 423, __pyx_L5_except_error)
        __Pyx_GOTREF(__pyx_t_1);
        __Pyx_GIVEREF(__pyx_t_15);
        PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_15);
        __pyx_t_15 = 0;
        __pyx_t_15 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_8volttron_8platform_3vip_6router_9cymessage_Frame), __pyx_t_1, NULL); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 423, __pyx_L5_except_error)
        __Pyx_GOTREF(__pyx_t_15);
        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
        __pyx_v_ermsg = ((struct __pyx_obj_8volttron_8platform_3vip_6router_9cymessage_Frame *)__pyx_t_15);
        __pyx_t_15 = 0;

        /* "volttron/platform/vip/router/routercy.pyx":424
 *                 erno = cymessage.Frame(errnum)
 *                 ermsg = cymessage.Frame(errmsg)
 *                 frames.append(<void*>erno)             # <<<<<<<<<<<<<<
 *                 frames.append(<void*>ermsg)
 *                 frames.append(<void*>recipient)
 */
        __pyx_t_15 = ((struct __pyx_vtabstruct_8volttron_8platform_3vip_6router_5queue_Queue *)__pyx_v_frames->__pyx_vtab)->append(__pyx_v_frames, ((void *)__pyx_v_erno)); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 424, __pyx_L5_except_error)
        __Pyx_GOTREF(__pyx_t_15);
        __Pyx_DECREF(__pyx_t_15); __pyx_t_15 = 0;

        /* "volttron/platform/vip/router/routercy.pyx":425
 *                 ermsg = cymessage.Frame(errmsg)
 *                 frames.append(<void*>erno)
 *                 frames.append(<void*>ermsg)             # <<<<<<<<<<<<<<
 *                 frames.append(<void*>recipient)
 *                 frames.append(<void*>subsystem)
 */
        __pyx_t_15 = ((struct __pyx_vtabstruct_8volttron_8platform_3vip_6router_5queue_Queue *)__pyx_v_frames->__pyx_vtab)->append(__pyx_v_frames, ((void *)__pyx_v_ermsg)); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 425, __pyx_L5_except_error)
        __Pyx_GOTREF(__pyx_t_15);
        __Pyx_DECREF(__pyx_t_15); __pyx_t_15 = 0;

        /* "volttron/platform/vip/router/routercy.pyx":426
 *                 frames.append(<void*>erno)
 *                 frames.append(<void*>ermsg)
 *                 frames.append(<void*>recipient)             # <<<<<<<<<<<<<<
 *                 frames.append(<void*>subsystem)
 * 
 */
        __pyx_t_15 = ((struct __pyx_vtabstruct_8volttron_8platform_3vip_6router_5queue_Queue *)__pyx_v_frames->__pyx_vtab)->append(__pyx_v_frames, ((void *)__pyx_v_recipient)); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 426, __pyx_L5_except_error)
        __Pyx_GOTREF(__pyx_t_15);
        __Pyx_DECREF(__pyx_t_15); __pyx_t_15 = 0;

        /* "volttron/platform/vip/router/routercy.pyx":427
 *                 frames.append(<void*>ermsg)
 *                 frames.append(<void*>recipient)
 *                 frames.append(<void*>subsystem)             # <<<<<<<<<<<<<<
 * 
 *                 try:
 */
        __pyx_t_15 = ((struct __pyx_vtabstruct_8volttron_8platform_3vip_6router_5queue_Queue *)__pyx_v_frames->__pyx_vtab)->append(__pyx_v_frames, ((void *)__pyx_v_subsystem)); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 427, __pyx_L5_except_error)
        __Pyx_GOTREF(__pyx_t_15);
        __Pyx_DECREF(__pyx_t_15); __pyx_t_15 = 0;

        /* "volttron/platform/vip/router/routercy.pyx":429
 *                 frames.append(<void*>subsystem)
 * 
 *                 try:             # <<<<<<<<<<<<<<
 *                     socket.send_multipart(frames, flags=NOBLOCK, copy=False)
 *                     issue(self.OUTGOING, frames)
 */
        {
          __Pyx_PyThreadState_declare
          __Pyx_PyThreadState_assign
          __Pyx_ExceptionSave(&__pyx_t_13, &__pyx_t_12, &__pyx_t_11);
          __Pyx_XGOTREF(__pyx_t_13);
          __Pyx_XGOTREF(__pyx_t_12);
          __Pyx_XGOTREF(__pyx_t_11);
          /*try:*/ {

            /* "volttron/platform/vip/router/routercy.pyx":430
 * 
 *                 try:
 *                     socket.send_multipart(frames, flags=NOBLOCK, copy=False)             # <<<<<<<<<<<<<<
 *                     issue(self.OUTGOING, frames)
 *                 except ZMQError as exc:
 */
            __pyx_t_15 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_socket), __pyx_n_s_send_multipart); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 430, __pyx_L32_error)
            __Pyx_GOTREF(__pyx_t_15);
            __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 430, __pyx_L32_error)
            __Pyx_GOTREF(__pyx_t_1);
            __Pyx_INCREF(((PyObject *)__pyx_v_frames));
            __Pyx_GIVEREF(((PyObject *)__pyx_v_frames));
            PyTuple_SET_ITEM(__pyx_t_1, 0, ((PyObject *)__pyx_v_frames));
            __pyx_t_3 = PyDict_New(); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 430, __pyx_L32_error)
            __Pyx_GOTREF(__pyx_t_3);
            __pyx_t_21 = __Pyx_GetModuleGlobalName(__pyx_n_s_NOBLOCK); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 430, __pyx_L32_error)
            __Pyx_GOTREF(__pyx_t_21);
            if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_flags, __pyx_t_21) < 0) __PYX_ERR(0, 430, __pyx_L32_error)
            __Pyx_DECREF(__pyx_t_21); __pyx_t_21 = 0;
            if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_copy, Py_False) < 0) __PYX_ERR(0, 430, __pyx_L32_error)
            __pyx_t_21 = __Pyx_PyObject_Call(__pyx_t_15, __pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 430, __pyx_L32_error)
            __Pyx_GOTREF(__pyx_t_21);
            __Pyx_DECREF(__pyx_t_15); __pyx_t_15 = 0;
            __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
            __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
            __Pyx_DECREF(__pyx_t_21); __pyx_t_21 = 0;

            /* "volttron/platform/vip/router/routercy.pyx":431
 *                 try:
 *                     socket.send_multipart(frames, flags=NOBLOCK, copy=False)
 *                     issue(self.OUTGOING, frames)             # <<<<<<<<<<<<<<
 *                 except ZMQError as exc:
 *                     try:
 */
            __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_self->OUTGOING); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 431, __pyx_L32_error)
            __Pyx_GOTREF(__pyx_t_3);
            __Pyx_INCREF(__pyx_v_issue);
            __pyx_t_1 = __pyx_v_issue; __pyx_t_15 = NULL;
            __pyx_t_9 = 0;
            if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_1))) {
              __pyx_t_15 = PyMethod_GET_SELF(__pyx_t_1);
              if (likely(__pyx_t_15)) {
                PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
                __Pyx_INCREF(__pyx_t_15);
                __Pyx_INCREF(function);
                __Pyx_DECREF_SET(__pyx_t_1, function);
                __pyx_t_9 = 1;
              }
            }
            __pyx_t_14 = PyTuple_New(2+__pyx_t_9); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 431, __pyx_L32_error)
            __Pyx_GOTREF(__pyx_t_14);
            if (__pyx_t_15) {
              __Pyx_GIVEREF(__pyx_t_15); PyTuple_SET_ITEM(__pyx_t_14, 0, __pyx_t_15); __pyx_t_15 = NULL;
            }
            __Pyx_GIVEREF(__pyx_t_3);
            PyTuple_SET_ITEM(__pyx_t_14, 0+__pyx_t_9, __pyx_t_3);
            __Pyx_INCREF(((PyObject *)__pyx_v_frames));
            __Pyx_GIVEREF(((PyObject *)__pyx_v_frames));
            PyTuple_SET_ITEM(__pyx_t_14, 1+__pyx_t_9, ((PyObject *)__pyx_v_frames));
            __pyx_t_3 = 0;
            __pyx_t_21 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_14, NULL); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 431, __pyx_L32_error)
            __Pyx_GOTREF(__pyx_t_21);
            __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
            __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
            __Pyx_DECREF(__pyx_t_21); __pyx_t_21 = 0;

            /* "volttron/platform/vip/router/routercy.pyx":429
 *                 frames.append(<void*>subsystem)
 * 
 *                 try:             # <<<<<<<<<<<<<<
 *                     socket.send_multipart(frames, flags=NOBLOCK, copy=False)
 *                     issue(self.OUTGOING, frames)
 */
          }
          __Pyx_XDECREF(__pyx_t_13); __pyx_t_13 = 0;
          __Pyx_XDECREF(__pyx_t_12); __pyx_t_12 = 0;
          __Pyx_XDECREF(__pyx_t_11); __pyx_t_11 = 0;
          goto __pyx_L39_try_end;
          __pyx_L32_error:;
          __Pyx_PyThreadState_assign
          __Pyx_XDECREF(__pyx_t_23); __pyx_t_23 = 0;
          __Pyx_XDECREF(__pyx_t_15); __pyx_t_15 = 0;
          __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
          __Pyx_XDECREF(__pyx_t_14); __pyx_t_14 = 0;
          __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
          __Pyx_XDECREF(__pyx_t_21); __pyx_t_21 = 0;

          /* "volttron/platform/vip/router/routercy.pyx":432
 *                     socket.send_multipart(frames, flags=NOBLOCK, copy=False)
 *                     issue(self.OUTGOING, frames)
 *                 except ZMQError as exc:             # <<<<<<<<<<<<<<
 *                     try:
 *                         errnum, errmsg = error = _ROUTE_ERRORS[exc.errno]
 */
          __pyx_t_21 = __Pyx_GetModuleGlobalName(__pyx_n_s_ZMQError); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 432, __pyx_L34_except_error)
          __Pyx_GOTREF(__pyx_t_21);
          __pyx_t_10 = __Pyx_PyErr_ExceptionMatches(__pyx_t_21);
          __Pyx_DECREF(__pyx_t_21); __pyx_t_21 = 0;
          if (__pyx_t_10) {
            __Pyx_AddTraceback("volttron.platform.vip.router.routercy.BaseRouter._send", __pyx_clineno, __pyx_lineno, __pyx_filename);
            if (__Pyx_GetException(&__pyx_t_21, &__pyx_t_1, &__pyx_t_14) < 0) __PYX_ERR(0, 432, __pyx_L34_except_error)
            __Pyx_GOTREF(__pyx_t_21);
            __Pyx_GOTREF(__pyx_t_1);
            __Pyx_GOTREF(__pyx_t_14);
            __Pyx_INCREF(__pyx_t_1);
            __Pyx_DECREF_SET(__pyx_v_exc, __pyx_t_1);

            /* "volttron/platform/vip/router/routercy.pyx":433
 *                     issue(self.OUTGOING, frames)
 *                 except ZMQError as exc:
 *                     try:             # <<<<<<<<<<<<<<
 *                         errnum, errmsg = error = _ROUTE_ERRORS[exc.errno]
 *                     except KeyError:
 */
            {
              __Pyx_PyThreadState_declare
              __Pyx_PyThreadState_assign
              __Pyx_ExceptionSave(&__pyx_t_24, &__pyx_t_25, &__pyx_t_26);
              __Pyx_XGOTREF(__pyx_t_24);
              __Pyx_XGOTREF(__pyx_t_25);
              __Pyx_XGOTREF(__pyx_t_26);
              /*try:*/ {

                /* "volttron/platform/vip/router/routercy.pyx":434
 *                 except ZMQError as exc:
 *                     try:
 *                         errnum, errmsg = error = _ROUTE_ERRORS[exc.errno]             # <<<<<<<<<<<<<<
 *                     except KeyError:
 *                         error = None
 */
                __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_ROUTE_ERRORS); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 434, __pyx_L42_error)
                __Pyx_GOTREF(__pyx_t_3);
                __pyx_t_15 = __Pyx_PyObject_GetAttrStr(__pyx_v_exc, __pyx_n_s_errno); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 434, __pyx_L42_error)
                __Pyx_GOTREF(__pyx_t_15);
                __pyx_t_23 = PyObject_GetItem(__pyx_t_3, __pyx_t_15); if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 434, __pyx_L42_error)
                __Pyx_GOTREF(__pyx_t_23);
                __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
                __Pyx_DECREF(__pyx_t_15); __pyx_t_15 = 0;
                if ((likely(PyTuple_CheckExact(__pyx_t_23))) || (PyList_CheckExact(__pyx_t_23))) {
                  PyObject* sequence = __pyx_t_23;
                  #if CYTHON_COMPILING_IN_CPYTHON
                  Py_ssize_t size = Py_SIZE(sequence);
                  #else
                  Py_ssize_t size = PySequence_Size(sequence);
                  #endif
                  if (unlikely(size != 2)) {
                    if (size > 2) __Pyx_RaiseTooManyValuesError(2);
                    else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
                    __PYX_ERR(0, 434, __pyx_L42_error)
                  }
                  #if CYTHON_COMPILING_IN_CPYTHON
                  if (likely(PyTuple_CheckExact(sequence))) {
                    __pyx_t_15 = PyTuple_GET_ITEM(sequence, 0); 
                    __pyx_t_3 = PyTuple_GET_ITEM(sequence, 1); 
                  } else {
                    __pyx_t_15 = PyList_GET_ITEM(sequence, 0); 
                    __pyx_t_3 = PyList_GET_ITEM(sequence, 1); 
                  }
                  __Pyx_INCREF(__pyx_t_15);
                  __Pyx_INCREF(__pyx_t_3);
                  #else
                  __pyx_t_15 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 434, __pyx_L42_error)
                  __Pyx_GOTREF(__pyx_t_15);
                  __pyx_t_3 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 434, __pyx_L42_error)
                  __Pyx_GOTREF(__pyx_t_3);
                  #endif
                } else {
                  Py_ssize_t index = -1;
                  __pyx_t_27 = PyObject_GetIter(__pyx_t_23); if (unlikely(!__pyx_t_27)) __PYX_ERR(0, 434, __pyx_L42_error)
                  __Pyx_GOTREF(__pyx_t_27);
                  __pyx_t_16 = Py_TYPE(__pyx_t_27)->tp_iternext;
                  index = 0; __pyx_t_15 = __pyx_t_16(__pyx_t_27); if (unlikely(!__pyx_t_15)) goto __pyx_L50_unpacking_failed;
                  __Pyx_GOTREF(__pyx_t_15);
                  index = 1; __pyx_t_3 = __pyx_t_16(__pyx_t_27); if (unlikely(!__pyx_t_3)) goto __pyx_L50_unpacking_failed;
                  __Pyx_GOTREF(__pyx_t_3);
                  if (__Pyx_IternextUnpackEndCheck(__pyx_t_16(__pyx_t_27), 2) < 0) __PYX_ERR(0, 434, __pyx_L42_error)
                  __pyx_t_16 = NULL;
                  __Pyx_DECREF(__pyx_t_27); __pyx_t_27 = 0;
                  goto __pyx_L51_unpacking_done;
                  __pyx_L50_unpacking_failed:;
                  __Pyx_DECREF(__pyx_t_27); __pyx_t_27 = 0;
                  __pyx_t_16 = NULL;
                  if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
                  __PYX_ERR(0, 434, __pyx_L42_error)
                  __pyx_L51_unpacking_done:;
                }
                __pyx_t_18 = __pyx_convert_string_from_py_std__in_string(__pyx_t_15); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 434, __pyx_L42_error)
                __Pyx_DECREF(__pyx_t_15); __pyx_t_15 = 0;
                __pyx_t_17 = __pyx_convert_string_from_py_std__in_string(__pyx_t_3); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 434, __pyx_L42_error)
                __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
                __pyx_v_errnum = __pyx_t_18;
                __pyx_v_errmsg = __pyx_t_17;
                __Pyx_INCREF(__pyx_t_23);
                __Pyx_DECREF_SET(__pyx_v_error, __pyx_t_23);
                __Pyx_DECREF(__pyx_t_23); __pyx_t_23 = 0;

                /* "volttron/platform/vip/router/routercy.pyx":433
 *                     issue(self.OUTGOING, frames)
 *                 except ZMQError as exc:
 *                     try:             # <<<<<<<<<<<<<<
 *                         errnum, errmsg = error = _ROUTE_ERRORS[exc.errno]
 *                     except KeyError:
 */
              }
              __Pyx_XDECREF(__pyx_t_24); __pyx_t_24 = 0;
              __Pyx_XDECREF(__pyx_t_25); __pyx_t_25 = 0;
              __Pyx_XDECREF(__pyx_t_26); __pyx_t_26 = 0;
              goto __pyx_L49_try_end;
              __pyx_L42_error:;
              __Pyx_PyThreadState_assign
              __Pyx_XDECREF(__pyx_t_27); __pyx_t_27 = 0;
              __Pyx_XDECREF(__pyx_t_15); __pyx_t_15 = 0;
              __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
              __Pyx_XDECREF(__pyx_t_23); __pyx_t_23 = 0;

              /* "volttron/platform/vip/router/routercy.pyx":435
 *                     try:
 *                         errnum, errmsg = error = _ROUTE_ERRORS[exc.errno]
 *                     except KeyError:             # <<<<<<<<<<<<<<
 *                         error = None
 *                     if error is None:
 */
              __pyx_t_10 = __Pyx_PyErr_ExceptionMatches(__pyx_builtin_KeyError);
              if (__pyx_t_10) {
                __Pyx_AddTraceback("volttron.platform.vip.router.routercy.BaseRouter._send", __pyx_clineno, __pyx_lineno, __pyx_filename);
                if (__Pyx_GetException(&__pyx_t_23, &__pyx_t_3, &__pyx_t_15) < 0) __PYX_ERR(0, 435, __pyx_L44_except_error)
                __Pyx_GOTREF(__pyx_t_23);
                __Pyx_GOTREF(__pyx_t_3);
                __Pyx_GOTREF(__pyx_t_15);

                /* "volttron/platform/vip/router/routercy.pyx":436
 *                         errnum, errmsg = error = _ROUTE_ERRORS[exc.errno]
 *                     except KeyError:
 *                         error = None             # <<<<<<<<<<<<<<
 *                     if error is None:
 *                         raise
 */
                __Pyx_INCREF(Py_None);
                __Pyx_DECREF_SET(__pyx_v_error, Py_None);
                __Pyx_DECREF(__pyx_t_23); __pyx_t_23 = 0;
                __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
                __Pyx_DECREF(__pyx_t_15); __pyx_t_15 = 0;
                goto __pyx_L43_exception_handled;
              }
              goto __pyx_L44_except_error;
              __pyx_L44_except_error:;

              /* "volttron/platform/vip/router/routercy.pyx":433
 *                     issue(self.OUTGOING, frames)
 *                 except ZMQError as exc:
 *                     try:             # <<<<<<<<<<<<<<
 *                         errnum, errmsg = error = _ROUTE_ERRORS[exc.errno]
 *                     except KeyError:
 */
              __Pyx_PyThreadState_assign
              __Pyx_XGIVEREF(__pyx_t_24);
              __Pyx_XGIVEREF(__pyx_t_25);
              __Pyx_XGIVEREF(__pyx_t_26);
              __Pyx_ExceptionReset(__pyx_t_24, __pyx_t_25, __pyx_t_26);
              goto __pyx_L34_except_error;
              __pyx_L43_exception_handled:;
              __Pyx_PyThreadState_assign
              __Pyx_XGIVEREF(__pyx_t_24);
              __Pyx_XGIVEREF(__pyx_t_25);
              __Pyx_XGIVEREF(__pyx_t_26);
              __Pyx_ExceptionReset(__pyx_t_24, __pyx_t_25, __pyx_t_26);
              __pyx_L49_try_end:;
            }

            /* "volttron/platform/vip/router/routercy.pyx":437
 *                     except KeyError:
 *                         error = None
 *                     if error is None:             # <<<<<<<<<<<<<<
 *                         raise
 *                     issue(ERROR, frames, error)
 */
            __pyx_t_20 = (__pyx_v_error == Py_None);
            __pyx_t_22 = (__pyx_t_20 != 0);
            if (__pyx_t_22) {

              /* "volttron/platform/vip/router/routercy.pyx":438
 *                         error = None
 *                     if error is None:
 *                         raise             # <<<<<<<<<<<<<<
 *                     issue(ERROR, frames, error)
 *                     if exc.errno == EHOSTUNREACH:
 */
              __Pyx_GIVEREF(__pyx_t_21);
              __Pyx_GIVEREF(__pyx_t_1);
              __Pyx_XGIVEREF(__pyx_t_14);
              __Pyx_ErrRestoreWithState(__pyx_t_21, __pyx_t_1, __pyx_t_14);
              __pyx_t_21 = 0; __pyx_t_1 = 0; __pyx_t_14 = 0; 
              __PYX_ERR(0, 438, __pyx_L34_except_error)

              /* "volttron/platform/vip/router/routercy.pyx":437
 *                     except KeyError:
 *                         error = None
 *                     if error is None:             # <<<<<<<<<<<<<<
 *                         raise
 *                     issue(ERROR, frames, error)
 */
            }

            /* "volttron/platform/vip/router/routercy.pyx":439
 *                     if error is None:
 *                         raise
 *                     issue(ERROR, frames, error)             # <<<<<<<<<<<<<<
 *                     if exc.errno == EHOSTUNREACH:
 *                         sendr = sender.bytes()
 */
            __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_ERROR); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 439, __pyx_L34_except_error)
            __Pyx_GOTREF(__pyx_t_3);
            __Pyx_INCREF(__pyx_v_issue);
            __pyx_t_23 = __pyx_v_issue; __pyx_t_27 = NULL;
            __pyx_t_9 = 0;
            if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_23))) {
              __pyx_t_27 = PyMethod_GET_SELF(__pyx_t_23);
              if (likely(__pyx_t_27)) {
                PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_23);
                __Pyx_INCREF(__pyx_t_27);
                __Pyx_INCREF(function);
                __Pyx_DECREF_SET(__pyx_t_23, function);
                __pyx_t_9 = 1;
              }
            }
            __pyx_t_28 = PyTuple_New(3+__pyx_t_9); if (unlikely(!__pyx_t_28)) __PYX_ERR(0, 439, __pyx_L34_except_error)
            __Pyx_GOTREF(__pyx_t_28);
            if (__pyx_t_27) {
              __Pyx_GIVEREF(__pyx_t_27); PyTuple_SET_ITEM(__pyx_t_28, 0, __pyx_t_27); __pyx_t_27 = NULL;
            }
            __Pyx_GIVEREF(__pyx_t_3);
            PyTuple_SET_ITEM(__pyx_t_28, 0+__pyx_t_9, __pyx_t_3);
            __Pyx_INCREF(((PyObject *)__pyx_v_frames));
            __Pyx_GIVEREF(((PyObject *)__pyx_v_frames));
            PyTuple_SET_ITEM(__pyx_t_28, 1+__pyx_t_9, ((PyObject *)__pyx_v_frames));
            __Pyx_INCREF(__pyx_v_error);
            __Pyx_GIVEREF(__pyx_v_error);
            PyTuple_SET_ITEM(__pyx_t_28, 2+__pyx_t_9, __pyx_v_error);
            __pyx_t_3 = 0;
            __pyx_t_15 = __Pyx_PyObject_Call(__pyx_t_23, __pyx_t_28, NULL); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 439, __pyx_L34_except_error)
            __Pyx_GOTREF(__pyx_t_15);
            __Pyx_DECREF(__pyx_t_28); __pyx_t_28 = 0;
            __Pyx_DECREF(__pyx_t_23); __pyx_t_23 = 0;
            __Pyx_DECREF(__pyx_t_15); __pyx_t_15 = 0;

            /* "volttron/platform/vip/router/routercy.pyx":440
 *                         raise
 *                     issue(ERROR, frames, error)
 *                     if exc.errno == EHOSTUNREACH:             # <<<<<<<<<<<<<<
 *                         sendr = sender.bytes()
 *                         drop.append(<void*>sendr)
 */
            __pyx_t_15 = __Pyx_PyObject_GetAttrStr(__pyx_v_exc, __pyx_n_s_errno); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 440, __pyx_L34_except_error)
            __Pyx_GOTREF(__pyx_t_15);
            __pyx_t_23 = __Pyx_GetModuleGlobalName(__pyx_n_s_EHOSTUNREACH); if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 440, __pyx_L34_except_error)
            __Pyx_GOTREF(__pyx_t_23);
            __pyx_t_28 = PyObject_RichCompare(__pyx_t_15, __pyx_t_23, Py_EQ); __Pyx_XGOTREF(__pyx_t_28); if (unlikely(!__pyx_t_28)) __PYX_ERR(0, 440, __pyx_L34_except_error)
            __Pyx_DECREF(__pyx_t_15); __pyx_t_15 = 0;
            __Pyx_DECREF(__pyx_t_23); __pyx_t_23 = 0;
            __pyx_t_22 = __Pyx_PyObject_IsTrue(__pyx_t_28); if (unlikely(__pyx_t_22 < 0)) __PYX_ERR(0, 440, __pyx_L34_except_error)
            __Pyx_DECREF(__pyx_t_28); __pyx_t_28 = 0;
            if (__pyx_t_22) {

              /* "volttron/platform/vip/router/routercy.pyx":441
 *                     issue(ERROR, frames, error)
 *                     if exc.errno == EHOSTUNREACH:
 *                         sendr = sender.bytes()             # <<<<<<<<<<<<<<
 *                         drop.append(<void*>sendr)
 *         return drop
 */
              __pyx_t_28 = ((struct __pyx_vtabstruct_8volttron_8platform_3vip_6router_9cymessage_Frame *)__pyx_v_sender->__pyx_vtab)->bytes(__pyx_v_sender); if (unlikely(!__pyx_t_28)) __PYX_ERR(0, 441, __pyx_L34_except_error)
              __Pyx_GOTREF(__pyx_t_28);
              if (!(likely(PyBytes_CheckExact(__pyx_t_28))||((__pyx_t_28) == Py_None)||(PyErr_Format(PyExc_TypeError, "Expected %.16s, got %.200s", "bytes", Py_TYPE(__pyx_t_28)->tp_name), 0))) __PYX_ERR(0, 441, __pyx_L34_except_error)
              __pyx_v_sendr = ((PyObject*)__pyx_t_28);
              __pyx_t_28 = 0;

              /* "volttron/platform/vip/router/routercy.pyx":442
 *                     if exc.errno == EHOSTUNREACH:
 *                         sendr = sender.bytes()
 *                         drop.append(<void*>sendr)             # <<<<<<<<<<<<<<
 *         return drop
 */
              __pyx_t_28 = ((struct __pyx_vtabstruct_8volttron_8platform_3vip_6router_5queue_Queue *)__pyx_v_drop->__pyx_vtab)->append(__pyx_v_drop, ((void *)__pyx_v_sendr)); if (unlikely(!__pyx_t_28)) __PYX_ERR(0, 442, __pyx_L34_except_error)
              __Pyx_GOTREF(__pyx_t_28);
              __Pyx_DECREF(__pyx_t_28); __pyx_t_28 = 0;

              /* "volttron/platform/vip/router/routercy.pyx":440
 *                         raise
 *                     issue(ERROR, frames, error)
 *                     if exc.errno == EHOSTUNREACH:             # <<<<<<<<<<<<<<
 *                         sendr = sender.bytes()
 *                         drop.append(<void*>sendr)
 */
            }
            __Pyx_DECREF(__pyx_t_21); __pyx_t_21 = 0;
            __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
            __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
            goto __pyx_L33_exception_handled;
          }
          goto __pyx_L34_except_error;
          __pyx_L34_except_error:;

          /* "volttron/platform/vip/router/routercy.pyx":429
 *                 frames.append(<void*>subsystem)
 * 
 *                 try:             # <<<<<<<<<<<<<<
 *                     socket.send_multipart(frames, flags=NOBLOCK, copy=False)
 *                     issue(self.OUTGOING, frames)
 */
          __Pyx_PyThreadState_assign
          __Pyx_XGIVEREF(__pyx_t_13);
          __Pyx_XGIVEREF(__pyx_t_12);
          __Pyx_XGIVEREF(__pyx_t_11);
          __Pyx_ExceptionReset(__pyx_t_13, __pyx_t_12, __pyx_t_11);
          goto __pyx_L5_except_error;
          __pyx_L33_exception_handled:;
          __Pyx_PyThreadState_assign
          __Pyx_XGIVEREF(__pyx_t_13);
          __Pyx_XGIVEREF(__pyx_t_12);
          __Pyx_XGIVEREF(__pyx_t_11);
          __Pyx_ExceptionReset(__pyx_t_13, __pyx_t_12, __pyx_t_11);
          __pyx_L39_try_end:;
        }

        /* "volttron/platform/vip/router/routercy.pyx":410
 *                 drop.append(<void*>rec)
 * 
 *             if exc.errno != EHOSTUNREACH or sender is not frames[0]:             # <<<<<<<<<<<<<<
 *                 # Only send errors if the sender and recipient differ
 *                 proto, user_id, msg_id, subsystem = frames[2:6]
 */
      }
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      goto __pyx_L4_exception_handled;
    }
    goto __pyx_L5_except_error;
    __pyx_L5_except_error:;

    /* "volttron/platform/vip/router/routercy.pyx":394
 *         # Expecting outgoing frames:
 *         #   [RECIPIENT, SENDER, PROTO, USER_ID, MSG_ID, SUBSYS, ...]
 *         try:             # <<<<<<<<<<<<<<
 *             # Try sending the message to its recipient
 *             socket.send_multipart(frames, flags=NOBLOCK, copy=False)
 */
    __Pyx_PyThreadState_assign
    __Pyx_XGIVEREF(__pyx_t_6);
    __Pyx_XGIVEREF(__pyx_t_7);
    __Pyx_XGIVEREF(__pyx_t_8);
    __Pyx_ExceptionReset(__pyx_t_6, __pyx_t_7, __pyx_t_8);
    goto __pyx_L1_error;
    __pyx_L4_exception_handled:;
    __Pyx_PyThreadState_assign
    __Pyx_XGIVEREF(__pyx_t_6);
    __Pyx_XGIVEREF(__pyx_t_7);
    __Pyx_XGIVEREF(__pyx_t_8);
    __Pyx_ExceptionReset(__pyx_t_6, __pyx_t_7, __pyx_t_8);
    __pyx_L10_try_end:;
  }

  /* "volttron/platform/vip/router/routercy.pyx":443
 *                         sendr = sender.bytes()
 *                         drop.append(<void*>sendr)
 *         return drop             # <<<<<<<<<<<<<<
 */
  __Pyx_XDECREF(((PyObject *)__pyx_r));
  __Pyx_INCREF(((PyObject *)__pyx_v_drop));
  __pyx_r = __pyx_v_drop;
  goto __pyx_L0;

  /* "volttron/platform/vip/router/routercy.pyx":376
 *             preincrement(it)
 * 
 *     cpdef Queue _send(self, Queue frames):             # <<<<<<<<<<<<<<
 *         cdef:
 *             object issue
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_14);
  __Pyx_XDECREF(__pyx_t_15);
  __Pyx_XDECREF(__pyx_t_21);
  __Pyx_XDECREF(__pyx_t_23);
  __Pyx_XDECREF(__pyx_t_27);
  __Pyx_XDECREF(__pyx_t_28);
  __Pyx_AddTraceback("volttron.platform.vip.router.routercy.BaseRouter._send", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_issue);
  __Pyx_XDECREF((PyObject *)__pyx_v_socket);
  __Pyx_XDECREF((PyObject *)__pyx_v_recipient);
  __Pyx_XDECREF((PyObject *)__pyx_v_sender);
  __Pyx_XDECREF((PyObject *)__pyx_v_proto);
  __Pyx_XDECREF((PyObject *)__pyx_v_user_id);
  __Pyx_XDECREF((PyObject *)__pyx_v_msg_id);
  __Pyx_XDECREF((PyObject *)__pyx_v_subsystem);
  __Pyx_XDECREF((PyObject *)__pyx_v_erno);
  __Pyx_XDECREF((PyObject *)__pyx_v_ermsg);
  __Pyx_XDECREF((PyObject *)__pyx_v_err);
  __Pyx_XDECREF((PyObject *)__pyx_v_drop);
  __Pyx_XDECREF((PyObject *)__pyx_v_send_frames);
  __Pyx_XDECREF(__pyx_v_sendr);
  __Pyx_XDECREF(__pyx_v_rec);
  __Pyx_XDECREF(__pyx_v_exc);
  __Pyx_XDECREF(__pyx_v_error);
  __Pyx_XGIVEREF((PyObject *)__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_27_send(PyObject *__pyx_v_self, PyObject *__pyx_v_frames); /*proto*/
static PyObject *__pyx_pw_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_27_send(PyObject *__pyx_v_self, PyObject *__pyx_v_frames) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("_send (wrapper)", 0);
  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_frames), __pyx_ptype_8volttron_8platform_3vip_6router_5queue_Queue, 1, "frames", 0))) __PYX_ERR(0, 376, __pyx_L1_error)
  __pyx_r = __pyx_pf_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_26_send(((struct __pyx_obj_8volttron_8platform_3vip_6router_8routercy_BaseRouter *)__pyx_v_self), ((struct __pyx_obj_8volttron_8platform_3vip_6router_5queue_Queue *)__pyx_v_frames));

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_26_send(struct __pyx_obj_8volttron_8platform_3vip_6router_8routercy_BaseRouter *__pyx_v_self, struct __pyx_obj_8volttron_8platform_3vip_6router_5queue_Queue *__pyx_v_frames) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  __Pyx_RefNannySetupContext("_send", 0);
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = ((PyObject *)__pyx_f_8volttron_8platform_3vip_6router_8routercy_10BaseRouter__send(__pyx_v_self, __pyx_v_frames, 1)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 376, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("volttron.platform.vip.router.routercy.BaseRouter._send", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "zmq/utils/buffers.pxd":88
 * 
 * 
 * cdef inline int memoryview_available():             # <<<<<<<<<<<<<<
 *     return PY_MAJOR_VERSION >= 3 or (PY_MAJOR_VERSION >=2 and PY_MINOR_VERSION >= 7)
 * 
 */

static CYTHON_INLINE int __pyx_f_3zmq_5utils_7buffers_memoryview_available(void) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  int __pyx_t_2;
  __Pyx_RefNannySetupContext("memoryview_available", 0);

  /* "zmq/utils/buffers.pxd":89
 * 
 * cdef inline int memoryview_available():
 *     return PY_MAJOR_VERSION >= 3 or (PY_MAJOR_VERSION >=2 and PY_MINOR_VERSION >= 7)             # <<<<<<<<<<<<<<
 * 
 * cdef inline int oldstyle_available():
 */
  __pyx_t_2 = (PY_MAJOR_VERSION >= 3);
  if (!__pyx_t_2) {
  } else {
    __pyx_t_1 = __pyx_t_2;
    goto __pyx_L3_bool_binop_done;
  }
  __pyx_t_2 = (PY_MAJOR_VERSION >= 2);
  if (__pyx_t_2) {
  } else {
    __pyx_t_1 = __pyx_t_2;
    goto __pyx_L3_bool_binop_done;
  }
  __pyx_t_2 = (PY_MINOR_VERSION >= 7);
  __pyx_t_1 = __pyx_t_2;
  __pyx_L3_bool_binop_done:;
  __pyx_r = __pyx_t_1;
  goto __pyx_L0;

  /* "zmq/utils/buffers.pxd":88
 * 
 * 
 * cdef inline int memoryview_available():             # <<<<<<<<<<<<<<
 *     return PY_MAJOR_VERSION >= 3 or (PY_MAJOR_VERSION >=2 and PY_MINOR_VERSION >= 7)
 * 
 */

  /* function exit code */
  __pyx_L0:;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "zmq/utils/buffers.pxd":91
 *     return PY_MAJOR_VERSION >= 3 or (PY_MAJOR_VERSION >=2 and PY_MINOR_VERSION >= 7)
 * 
 * cdef inline int oldstyle_available():             # <<<<<<<<<<<<<<
 *     return PY_MAJOR_VERSION < 3
 * 
 */

static CYTHON_INLINE int __pyx_f_3zmq_5utils_7buffers_oldstyle_available(void) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("oldstyle_available", 0);

  /* "zmq/utils/buffers.pxd":92
 * 
 * cdef inline int oldstyle_available():
 *     return PY_MAJOR_VERSION < 3             # <<<<<<<<<<<<<<
 * 
 * 
 */
  __pyx_r = (PY_MAJOR_VERSION < 3);
  goto __pyx_L0;

  /* "zmq/utils/buffers.pxd":91
 *     return PY_MAJOR_VERSION >= 3 or (PY_MAJOR_VERSION >=2 and PY_MINOR_VERSION >= 7)
 * 
 * cdef inline int oldstyle_available():             # <<<<<<<<<<<<<<
 *     return PY_MAJOR_VERSION < 3
 * 
 */

  /* function exit code */
  __pyx_L0:;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "zmq/utils/buffers.pxd":95
 * 
 * 
 * cdef inline int check_buffer(object ob):             # <<<<<<<<<<<<<<
 *     """Version independent check for whether an object is a buffer.
 * 
 */

static CYTHON_INLINE int __pyx_f_3zmq_5utils_7buffers_check_buffer(PyObject *__pyx_v_ob) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  int __pyx_t_2;
  int __pyx_t_3;
  __Pyx_RefNannySetupContext("check_buffer", 0);

  /* "zmq/utils/buffers.pxd":107
 *     int : 0 if no buffer interface, 3 if newstyle buffer interface, 2 if oldstyle.
 *     """
 *     if PyObject_CheckBuffer(ob):             # <<<<<<<<<<<<<<
 *         return 3
 *     if oldstyle_available():
 */
  __pyx_t_1 = (PyObject_CheckBuffer(__pyx_v_ob) != 0);
  if (__pyx_t_1) {

    /* "zmq/utils/buffers.pxd":108
 *     """
 *     if PyObject_CheckBuffer(ob):
 *         return 3             # <<<<<<<<<<<<<<
 *     if oldstyle_available():
 *         return PyObject_CheckReadBuffer(ob) and 2
 */
    __pyx_r = 3;
    goto __pyx_L0;

    /* "zmq/utils/buffers.pxd":107
 *     int : 0 if no buffer interface, 3 if newstyle buffer interface, 2 if oldstyle.
 *     """
 *     if PyObject_CheckBuffer(ob):             # <<<<<<<<<<<<<<
 *         return 3
 *     if oldstyle_available():
 */
  }

  /* "zmq/utils/buffers.pxd":109
 *     if PyObject_CheckBuffer(ob):
 *         return 3
 *     if oldstyle_available():             # <<<<<<<<<<<<<<
 *         return PyObject_CheckReadBuffer(ob) and 2
 *     return 0
 */
  __pyx_t_1 = (__pyx_f_3zmq_5utils_7buffers_oldstyle_available() != 0);
  if (__pyx_t_1) {

    /* "zmq/utils/buffers.pxd":110
 *         return 3
 *     if oldstyle_available():
 *         return PyObject_CheckReadBuffer(ob) and 2             # <<<<<<<<<<<<<<
 *     return 0
 * 
 */
    __pyx_t_3 = PyObject_CheckReadBuffer(__pyx_v_ob);
    if (__pyx_t_3) {
    } else {
      __pyx_t_2 = __pyx_t_3;
      goto __pyx_L5_bool_binop_done;
    }
    __pyx_t_2 = 2;
    __pyx_L5_bool_binop_done:;
    __pyx_r = __pyx_t_2;
    goto __pyx_L0;

    /* "zmq/utils/buffers.pxd":109
 *     if PyObject_CheckBuffer(ob):
 *         return 3
 *     if oldstyle_available():             # <<<<<<<<<<<<<<
 *         return PyObject_CheckReadBuffer(ob) and 2
 *     return 0
 */
  }

  /* "zmq/utils/buffers.pxd":111
 *     if oldstyle_available():
 *         return PyObject_CheckReadBuffer(ob) and 2
 *     return 0             # <<<<<<<<<<<<<<
 * 
 * 
 */
  __pyx_r = 0;
  goto __pyx_L0;

  /* "zmq/utils/buffers.pxd":95
 * 
 * 
 * cdef inline int check_buffer(object ob):             # <<<<<<<<<<<<<<
 *     """Version independent check for whether an object is a buffer.
 * 
 */

  /* function exit code */
  __pyx_L0:;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "zmq/utils/buffers.pxd":114
 * 
 * 
 * cdef inline object asbuffer(object ob, int writable, int format,             # <<<<<<<<<<<<<<
 *                             void **base, Py_ssize_t *size,
 *                             Py_ssize_t *itemsize):
 */

static CYTHON_INLINE PyObject *__pyx_f_3zmq_5utils_7buffers_asbuffer(PyObject *__pyx_v_ob, int __pyx_v_writable, int __pyx_v_format, void **__pyx_v_base, Py_ssize_t *__pyx_v_size, Py_ssize_t *__pyx_v_itemsize) {
  void *__pyx_v_bptr;
  Py_ssize_t __pyx_v_blen;
  Py_ssize_t __pyx_v_bitemlen;
  Py_buffer __pyx_v_view;
  int __pyx_v_flags;
  int __pyx_v_mode;
  PyObject *__pyx_v_bfmt = NULL;
  PyObject *__pyx_v_dtype = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  int __pyx_t_4;
  void *__pyx_t_5;
  Py_ssize_t __pyx_t_6;
  PyObject *__pyx_t_7 = NULL;
  PyObject *__pyx_t_8 = NULL;
  PyObject *__pyx_t_9 = NULL;
  PyObject *__pyx_t_10 = NULL;
  PyObject *__pyx_t_11 = NULL;
  PyObject *__pyx_t_12 = NULL;
  PyObject *__pyx_t_13 = NULL;
  PyObject *__pyx_t_14 = NULL;
  PyObject *__pyx_t_15 = NULL;
  PyObject *__pyx_t_16 = NULL;
  int __pyx_t_17;
  int __pyx_t_18;
  __Pyx_RefNannySetupContext("asbuffer", 0);

  /* "zmq/utils/buffers.pxd":141
 *     """
 * 
 *     cdef void *bptr = NULL             # <<<<<<<<<<<<<<
 *     cdef Py_ssize_t blen = 0, bitemlen = 0
 *     cdef Py_buffer view
 */
  __pyx_v_bptr = NULL;

  /* "zmq/utils/buffers.pxd":142
 * 
 *     cdef void *bptr = NULL
 *     cdef Py_ssize_t blen = 0, bitemlen = 0             # <<<<<<<<<<<<<<
 *     cdef Py_buffer view
 *     cdef int flags = PyBUF_SIMPLE
 */
  __pyx_v_blen = 0;
  __pyx_v_bitemlen = 0;

  /* "zmq/utils/buffers.pxd":144
 *     cdef Py_ssize_t blen = 0, bitemlen = 0
 *     cdef Py_buffer view
 *     cdef int flags = PyBUF_SIMPLE             # <<<<<<<<<<<<<<
 *     cdef int mode = 0
 * 
 */
  __pyx_v_flags = PyBUF_SIMPLE;

  /* "zmq/utils/buffers.pxd":145
 *     cdef Py_buffer view
 *     cdef int flags = PyBUF_SIMPLE
 *     cdef int mode = 0             # <<<<<<<<<<<<<<
 * 
 *     bfmt = None
 */
  __pyx_v_mode = 0;

  /* "zmq/utils/buffers.pxd":147
 *     cdef int mode = 0
 * 
 *     bfmt = None             # <<<<<<<<<<<<<<
 * 
 *     mode = check_buffer(ob)
 */
  __Pyx_INCREF(Py_None);
  __pyx_v_bfmt = Py_None;

  /* "zmq/utils/buffers.pxd":149
 *     bfmt = None
 * 
 *     mode = check_buffer(ob)             # <<<<<<<<<<<<<<
 *     if mode == 0:
 *         raise TypeError("%r does not provide a buffer interface."%ob)
 */
  __pyx_v_mode = __pyx_f_3zmq_5utils_7buffers_check_buffer(__pyx_v_ob);

  /* "zmq/utils/buffers.pxd":150
 * 
 *     mode = check_buffer(ob)
 *     if mode == 0:             # <<<<<<<<<<<<<<
 *         raise TypeError("%r does not provide a buffer interface."%ob)
 * 
 */
  __pyx_t_1 = ((__pyx_v_mode == 0) != 0);
  if (__pyx_t_1) {

    /* "zmq/utils/buffers.pxd":151
 *     mode = check_buffer(ob)
 *     if mode == 0:
 *         raise TypeError("%r does not provide a buffer interface."%ob)             # <<<<<<<<<<<<<<
 * 
 *     if mode == 3:
 */
    __pyx_t_2 = __Pyx_PyString_Format(__pyx_kp_s_r_does_not_provide_a_buffer_int, __pyx_v_ob); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 151, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 151, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_GIVEREF(__pyx_t_2);
    PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_2);
    __pyx_t_2 = 0;
    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_t_3, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 151, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __Pyx_Raise(__pyx_t_2, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __PYX_ERR(1, 151, __pyx_L1_error)

    /* "zmq/utils/buffers.pxd":150
 * 
 *     mode = check_buffer(ob)
 *     if mode == 0:             # <<<<<<<<<<<<<<
 *         raise TypeError("%r does not provide a buffer interface."%ob)
 * 
 */
  }

  /* "zmq/utils/buffers.pxd":153
 *         raise TypeError("%r does not provide a buffer interface."%ob)
 * 
 *     if mode == 3:             # <<<<<<<<<<<<<<
 *         flags = PyBUF_ANY_CONTIGUOUS
 *         if writable:
 */
  __pyx_t_1 = ((__pyx_v_mode == 3) != 0);
  if (__pyx_t_1) {

    /* "zmq/utils/buffers.pxd":154
 * 
 *     if mode == 3:
 *         flags = PyBUF_ANY_CONTIGUOUS             # <<<<<<<<<<<<<<
 *         if writable:
 *             flags |= PyBUF_WRITABLE
 */
    __pyx_v_flags = PyBUF_ANY_CONTIGUOUS;

    /* "zmq/utils/buffers.pxd":155
 *     if mode == 3:
 *         flags = PyBUF_ANY_CONTIGUOUS
 *         if writable:             # <<<<<<<<<<<<<<
 *             flags |= PyBUF_WRITABLE
 *         if format:
 */
    __pyx_t_1 = (__pyx_v_writable != 0);
    if (__pyx_t_1) {

      /* "zmq/utils/buffers.pxd":156
 *         flags = PyBUF_ANY_CONTIGUOUS
 *         if writable:
 *             flags |= PyBUF_WRITABLE             # <<<<<<<<<<<<<<
 *         if format:
 *             flags |= PyBUF_FORMAT
 */
      __pyx_v_flags = (__pyx_v_flags | PyBUF_WRITABLE);

      /* "zmq/utils/buffers.pxd":155
 *     if mode == 3:
 *         flags = PyBUF_ANY_CONTIGUOUS
 *         if writable:             # <<<<<<<<<<<<<<
 *             flags |= PyBUF_WRITABLE
 *         if format:
 */
    }

    /* "zmq/utils/buffers.pxd":157
 *         if writable:
 *             flags |= PyBUF_WRITABLE
 *         if format:             # <<<<<<<<<<<<<<
 *             flags |= PyBUF_FORMAT
 *         PyObject_GetBuffer(ob, &view, flags)
 */
    __pyx_t_1 = (__pyx_v_format != 0);
    if (__pyx_t_1) {

      /* "zmq/utils/buffers.pxd":158
 *             flags |= PyBUF_WRITABLE
 *         if format:
 *             flags |= PyBUF_FORMAT             # <<<<<<<<<<<<<<
 *         PyObject_GetBuffer(ob, &view, flags)
 *         bptr = view.buf
 */
      __pyx_v_flags = (__pyx_v_flags | PyBUF_FORMAT);

      /* "zmq/utils/buffers.pxd":157
 *         if writable:
 *             flags |= PyBUF_WRITABLE
 *         if format:             # <<<<<<<<<<<<<<
 *             flags |= PyBUF_FORMAT
 *         PyObject_GetBuffer(ob, &view, flags)
 */
    }

    /* "zmq/utils/buffers.pxd":159
 *         if format:
 *             flags |= PyBUF_FORMAT
 *         PyObject_GetBuffer(ob, &view, flags)             # <<<<<<<<<<<<<<
 *         bptr = view.buf
 *         blen = view.len
 */
    __pyx_t_4 = PyObject_GetBuffer(__pyx_v_ob, (&__pyx_v_view), __pyx_v_flags); if (unlikely(__pyx_t_4 == -1)) __PYX_ERR(1, 159, __pyx_L1_error)

    /* "zmq/utils/buffers.pxd":160
 *             flags |= PyBUF_FORMAT
 *         PyObject_GetBuffer(ob, &view, flags)
 *         bptr = view.buf             # <<<<<<<<<<<<<<
 *         blen = view.len
 *         if format:
 */
    __pyx_t_5 = __pyx_v_view.buf;
    __pyx_v_bptr = __pyx_t_5;

    /* "zmq/utils/buffers.pxd":161
 *         PyObject_GetBuffer(ob, &view, flags)
 *         bptr = view.buf
 *         blen = view.len             # <<<<<<<<<<<<<<
 *         if format:
 *             if view.format != NULL:
 */
    __pyx_t_6 = __pyx_v_view.len;
    __pyx_v_blen = __pyx_t_6;

    /* "zmq/utils/buffers.pxd":162
 *         bptr = view.buf
 *         blen = view.len
 *         if format:             # <<<<<<<<<<<<<<
 *             if view.format != NULL:
 *                 bfmt = view.format
 */
    __pyx_t_1 = (__pyx_v_format != 0);
    if (__pyx_t_1) {

      /* "zmq/utils/buffers.pxd":163
 *         blen = view.len
 *         if format:
 *             if view.format != NULL:             # <<<<<<<<<<<<<<
 *                 bfmt = view.format
 *                 bitemlen = view.itemsize
 */
      __pyx_t_1 = ((__pyx_v_view.format != NULL) != 0);
      if (__pyx_t_1) {

        /* "zmq/utils/buffers.pxd":164
 *         if format:
 *             if view.format != NULL:
 *                 bfmt = view.format             # <<<<<<<<<<<<<<
 *                 bitemlen = view.itemsize
 *         PyBuffer_Release(&view)
 */
        __pyx_t_2 = __Pyx_PyBytes_FromString(__pyx_v_view.format); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 164, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        __Pyx_DECREF_SET(__pyx_v_bfmt, __pyx_t_2);
        __pyx_t_2 = 0;

        /* "zmq/utils/buffers.pxd":165
 *             if view.format != NULL:
 *                 bfmt = view.format
 *                 bitemlen = view.itemsize             # <<<<<<<<<<<<<<
 *         PyBuffer_Release(&view)
 *     else: # oldstyle
 */
        __pyx_t_6 = __pyx_v_view.itemsize;
        __pyx_v_bitemlen = __pyx_t_6;

        /* "zmq/utils/buffers.pxd":163
 *         blen = view.len
 *         if format:
 *             if view.format != NULL:             # <<<<<<<<<<<<<<
 *                 bfmt = view.format
 *                 bitemlen = view.itemsize
 */
      }

      /* "zmq/utils/buffers.pxd":162
 *         bptr = view.buf
 *         blen = view.len
 *         if format:             # <<<<<<<<<<<<<<
 *             if view.format != NULL:
 *                 bfmt = view.format
 */
    }

    /* "zmq/utils/buffers.pxd":166
 *                 bfmt = view.format
 *                 bitemlen = view.itemsize
 *         PyBuffer_Release(&view)             # <<<<<<<<<<<<<<
 *     else: # oldstyle
 *         if writable:
 */
    PyBuffer_Release((&__pyx_v_view));

    /* "zmq/utils/buffers.pxd":153
 *         raise TypeError("%r does not provide a buffer interface."%ob)
 * 
 *     if mode == 3:             # <<<<<<<<<<<<<<
 *         flags = PyBUF_ANY_CONTIGUOUS
 *         if writable:
 */
    goto __pyx_L4;
  }

  /* "zmq/utils/buffers.pxd":168
 *         PyBuffer_Release(&view)
 *     else: # oldstyle
 *         if writable:             # <<<<<<<<<<<<<<
 *             PyObject_AsWriteBuffer(ob, &bptr, &blen)
 *         else:
 */
  /*else*/ {
    __pyx_t_1 = (__pyx_v_writable != 0);
    if (__pyx_t_1) {

      /* "zmq/utils/buffers.pxd":169
 *     else: # oldstyle
 *         if writable:
 *             PyObject_AsWriteBuffer(ob, &bptr, &blen)             # <<<<<<<<<<<<<<
 *         else:
 *             PyObject_AsReadBuffer(ob, <const_void **>&bptr, &blen)
 */
      __pyx_t_4 = PyObject_AsWriteBuffer(__pyx_v_ob, (&__pyx_v_bptr), (&__pyx_v_blen)); if (unlikely(__pyx_t_4 == -1)) __PYX_ERR(1, 169, __pyx_L1_error)

      /* "zmq/utils/buffers.pxd":168
 *         PyBuffer_Release(&view)
 *     else: # oldstyle
 *         if writable:             # <<<<<<<<<<<<<<
 *             PyObject_AsWriteBuffer(ob, &bptr, &blen)
 *         else:
 */
      goto __pyx_L9;
    }

    /* "zmq/utils/buffers.pxd":171
 *             PyObject_AsWriteBuffer(ob, &bptr, &blen)
 *         else:
 *             PyObject_AsReadBuffer(ob, <const_void **>&bptr, &blen)             # <<<<<<<<<<<<<<
 *         if format:
 *             try: # numpy.ndarray
 */
    /*else*/ {
      __pyx_t_4 = PyObject_AsReadBuffer(__pyx_v_ob, ((const void **)(&__pyx_v_bptr)), (&__pyx_v_blen)); if (unlikely(__pyx_t_4 == -1)) __PYX_ERR(1, 171, __pyx_L1_error)
    }
    __pyx_L9:;

    /* "zmq/utils/buffers.pxd":172
 *         else:
 *             PyObject_AsReadBuffer(ob, <const_void **>&bptr, &blen)
 *         if format:             # <<<<<<<<<<<<<<
 *             try: # numpy.ndarray
 *                 dtype = ob.dtype
 */
    __pyx_t_1 = (__pyx_v_format != 0);
    if (__pyx_t_1) {

      /* "zmq/utils/buffers.pxd":173
 *             PyObject_AsReadBuffer(ob, <const_void **>&bptr, &blen)
 *         if format:
 *             try: # numpy.ndarray             # <<<<<<<<<<<<<<
 *                 dtype = ob.dtype
 *                 bfmt = dtype.char
 */
      {
        __Pyx_PyThreadState_declare
        __Pyx_PyThreadState_assign
        __Pyx_ExceptionSave(&__pyx_t_7, &__pyx_t_8, &__pyx_t_9);
        __Pyx_XGOTREF(__pyx_t_7);
        __Pyx_XGOTREF(__pyx_t_8);
        __Pyx_XGOTREF(__pyx_t_9);
        /*try:*/ {

          /* "zmq/utils/buffers.pxd":174
 *         if format:
 *             try: # numpy.ndarray
 *                 dtype = ob.dtype             # <<<<<<<<<<<<<<
 *                 bfmt = dtype.char
 *                 bitemlen = dtype.itemsize
 */
          __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_ob, __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 174, __pyx_L11_error)
          __Pyx_GOTREF(__pyx_t_2);
          __pyx_v_dtype = __pyx_t_2;
          __pyx_t_2 = 0;

          /* "zmq/utils/buffers.pxd":175
 *             try: # numpy.ndarray
 *                 dtype = ob.dtype
 *                 bfmt = dtype.char             # <<<<<<<<<<<<<<
 *                 bitemlen = dtype.itemsize
 *             except AttributeError:
 */
          __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_dtype, __pyx_n_s_char); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 175, __pyx_L11_error)
          __Pyx_GOTREF(__pyx_t_2);
          __Pyx_DECREF_SET(__pyx_v_bfmt, __pyx_t_2);
          __pyx_t_2 = 0;

          /* "zmq/utils/buffers.pxd":176
 *                 dtype = ob.dtype
 *                 bfmt = dtype.char
 *                 bitemlen = dtype.itemsize             # <<<<<<<<<<<<<<
 *             except AttributeError:
 *                 try: # array.array
 */
          __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_dtype, __pyx_n_s_itemsize); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 176, __pyx_L11_error)
          __Pyx_GOTREF(__pyx_t_2);
          __pyx_t_6 = __Pyx_PyIndex_AsSsize_t(__pyx_t_2); if (unlikely((__pyx_t_6 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(1, 176, __pyx_L11_error)
          __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
          __pyx_v_bitemlen = __pyx_t_6;

          /* "zmq/utils/buffers.pxd":173
 *             PyObject_AsReadBuffer(ob, <const_void **>&bptr, &blen)
 *         if format:
 *             try: # numpy.ndarray             # <<<<<<<<<<<<<<
 *                 dtype = ob.dtype
 *                 bfmt = dtype.char
 */
        }
        __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
        __Pyx_XDECREF(__pyx_t_8); __pyx_t_8 = 0;
        __Pyx_XDECREF(__pyx_t_9); __pyx_t_9 = 0;
        goto __pyx_L18_try_end;
        __pyx_L11_error:;
        __Pyx_PyThreadState_assign
        __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
        __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;

        /* "zmq/utils/buffers.pxd":177
 *                 bfmt = dtype.char
 *                 bitemlen = dtype.itemsize
 *             except AttributeError:             # <<<<<<<<<<<<<<
 *                 try: # array.array
 *                     bfmt = ob.typecode
 */
        __pyx_t_4 = __Pyx_PyErr_ExceptionMatches(__pyx_builtin_AttributeError);
        if (__pyx_t_4) {
          __Pyx_AddTraceback("zmq.utils.buffers.asbuffer", __pyx_clineno, __pyx_lineno, __pyx_filename);
          if (__Pyx_GetException(&__pyx_t_2, &__pyx_t_3, &__pyx_t_10) < 0) __PYX_ERR(1, 177, __pyx_L13_except_error)
          __Pyx_GOTREF(__pyx_t_2);
          __Pyx_GOTREF(__pyx_t_3);
          __Pyx_GOTREF(__pyx_t_10);

          /* "zmq/utils/buffers.pxd":178
 *                 bitemlen = dtype.itemsize
 *             except AttributeError:
 *                 try: # array.array             # <<<<<<<<<<<<<<
 *                     bfmt = ob.typecode
 *                     bitemlen = ob.itemsize
 */
          {
            __Pyx_PyThreadState_declare
            __Pyx_PyThreadState_assign
            __Pyx_ExceptionSave(&__pyx_t_11, &__pyx_t_12, &__pyx_t_13);
            __Pyx_XGOTREF(__pyx_t_11);
            __Pyx_XGOTREF(__pyx_t_12);
            __Pyx_XGOTREF(__pyx_t_13);
            /*try:*/ {

              /* "zmq/utils/buffers.pxd":179
 *             except AttributeError:
 *                 try: # array.array
 *                     bfmt = ob.typecode             # <<<<<<<<<<<<<<
 *                     bitemlen = ob.itemsize
 *                 except AttributeError:
 */
              __pyx_t_14 = __Pyx_PyObject_GetAttrStr(__pyx_v_ob, __pyx_n_s_typecode); if (unlikely(!__pyx_t_14)) __PYX_ERR(1, 179, __pyx_L21_error)
              __Pyx_GOTREF(__pyx_t_14);
              __Pyx_DECREF_SET(__pyx_v_bfmt, __pyx_t_14);
              __pyx_t_14 = 0;

              /* "zmq/utils/buffers.pxd":180
 *                 try: # array.array
 *                     bfmt = ob.typecode
 *                     bitemlen = ob.itemsize             # <<<<<<<<<<<<<<
 *                 except AttributeError:
 *                     if isinstance(ob, bytes):
 */
              __pyx_t_14 = __Pyx_PyObject_GetAttrStr(__pyx_v_ob, __pyx_n_s_itemsize); if (unlikely(!__pyx_t_14)) __PYX_ERR(1, 180, __pyx_L21_error)
              __Pyx_GOTREF(__pyx_t_14);
              __pyx_t_6 = __Pyx_PyIndex_AsSsize_t(__pyx_t_14); if (unlikely((__pyx_t_6 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(1, 180, __pyx_L21_error)
              __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
              __pyx_v_bitemlen = __pyx_t_6;

              /* "zmq/utils/buffers.pxd":178
 *                 bitemlen = dtype.itemsize
 *             except AttributeError:
 *                 try: # array.array             # <<<<<<<<<<<<<<
 *                     bfmt = ob.typecode
 *                     bitemlen = ob.itemsize
 */
            }
            __Pyx_XDECREF(__pyx_t_11); __pyx_t_11 = 0;
            __Pyx_XDECREF(__pyx_t_12); __pyx_t_12 = 0;
            __Pyx_XDECREF(__pyx_t_13); __pyx_t_13 = 0;
            goto __pyx_L28_try_end;
            __pyx_L21_error:;
            __Pyx_PyThreadState_assign
            __Pyx_XDECREF(__pyx_t_14); __pyx_t_14 = 0;

            /* "zmq/utils/buffers.pxd":181
 *                     bfmt = ob.typecode
 *                     bitemlen = ob.itemsize
 *                 except AttributeError:             # <<<<<<<<<<<<<<
 *                     if isinstance(ob, bytes):
 *                         bfmt = b"B"
 */
            __pyx_t_4 = __Pyx_PyErr_ExceptionMatches(__pyx_builtin_AttributeError);
            if (__pyx_t_4) {
              __Pyx_AddTraceback("zmq.utils.buffers.asbuffer", __pyx_clineno, __pyx_lineno, __pyx_filename);
              if (__Pyx_GetException(&__pyx_t_14, &__pyx_t_15, &__pyx_t_16) < 0) __PYX_ERR(1, 181, __pyx_L23_except_error)
              __Pyx_GOTREF(__pyx_t_14);
              __Pyx_GOTREF(__pyx_t_15);
              __Pyx_GOTREF(__pyx_t_16);

              /* "zmq/utils/buffers.pxd":182
 *                     bitemlen = ob.itemsize
 *                 except AttributeError:
 *                     if isinstance(ob, bytes):             # <<<<<<<<<<<<<<
 *                         bfmt = b"B"
 *                         bitemlen = 1
 */
              __pyx_t_1 = PyBytes_Check(__pyx_v_ob); 
              __pyx_t_17 = (__pyx_t_1 != 0);
              if (__pyx_t_17) {

                /* "zmq/utils/buffers.pxd":183
 *                 except AttributeError:
 *                     if isinstance(ob, bytes):
 *                         bfmt = b"B"             # <<<<<<<<<<<<<<
 *                         bitemlen = 1
 *                     else:
 */
                __Pyx_INCREF(__pyx_n_b_B);
                __Pyx_DECREF_SET(__pyx_v_bfmt, __pyx_n_b_B);

                /* "zmq/utils/buffers.pxd":184
 *                     if isinstance(ob, bytes):
 *                         bfmt = b"B"
 *                         bitemlen = 1             # <<<<<<<<<<<<<<
 *                     else:
 *                         # nothing found
 */
                __pyx_v_bitemlen = 1;

                /* "zmq/utils/buffers.pxd":182
 *                     bitemlen = ob.itemsize
 *                 except AttributeError:
 *                     if isinstance(ob, bytes):             # <<<<<<<<<<<<<<
 *                         bfmt = b"B"
 *                         bitemlen = 1
 */
                goto __pyx_L31;
              }

              /* "zmq/utils/buffers.pxd":187
 *                     else:
 *                         # nothing found
 *                         bfmt = None             # <<<<<<<<<<<<<<
 *                         bitemlen = 0
 *     if base: base[0] = <void *>bptr
 */
              /*else*/ {
                __Pyx_INCREF(Py_None);
                __Pyx_DECREF_SET(__pyx_v_bfmt, Py_None);

                /* "zmq/utils/buffers.pxd":188
 *                         # nothing found
 *                         bfmt = None
 *                         bitemlen = 0             # <<<<<<<<<<<<<<
 *     if base: base[0] = <void *>bptr
 *     if size: size[0] = <Py_ssize_t>blen
 */
                __pyx_v_bitemlen = 0;
              }
              __pyx_L31:;
              __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
              __Pyx_DECREF(__pyx_t_15); __pyx_t_15 = 0;
              __Pyx_DECREF(__pyx_t_16); __pyx_t_16 = 0;
              goto __pyx_L22_exception_handled;
            }
            goto __pyx_L23_except_error;
            __pyx_L23_except_error:;

            /* "zmq/utils/buffers.pxd":178
 *                 bitemlen = dtype.itemsize
 *             except AttributeError:
 *                 try: # array.array             # <<<<<<<<<<<<<<
 *                     bfmt = ob.typecode
 *                     bitemlen = ob.itemsize
 */
            __Pyx_PyThreadState_assign
            __Pyx_XGIVEREF(__pyx_t_11);
            __Pyx_XGIVEREF(__pyx_t_12);
            __Pyx_XGIVEREF(__pyx_t_13);
            __Pyx_ExceptionReset(__pyx_t_11, __pyx_t_12, __pyx_t_13);
            goto __pyx_L13_except_error;
            __pyx_L22_exception_handled:;
            __Pyx_PyThreadState_assign
            __Pyx_XGIVEREF(__pyx_t_11);
            __Pyx_XGIVEREF(__pyx_t_12);
            __Pyx_XGIVEREF(__pyx_t_13);
            __Pyx_ExceptionReset(__pyx_t_11, __pyx_t_12, __pyx_t_13);
            __pyx_L28_try_end:;
          }
          __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
          __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
          __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
          goto __pyx_L12_exception_handled;
        }
        goto __pyx_L13_except_error;
        __pyx_L13_except_error:;

        /* "zmq/utils/buffers.pxd":173
 *             PyObject_AsReadBuffer(ob, <const_void **>&bptr, &blen)
 *         if format:
 *             try: # numpy.ndarray             # <<<<<<<<<<<<<<
 *                 dtype = ob.dtype
 *                 bfmt = dtype.char
 */
        __Pyx_PyThreadState_assign
        __Pyx_XGIVEREF(__pyx_t_7);
        __Pyx_XGIVEREF(__pyx_t_8);
        __Pyx_XGIVEREF(__pyx_t_9);
        __Pyx_ExceptionReset(__pyx_t_7, __pyx_t_8, __pyx_t_9);
        goto __pyx_L1_error;
        __pyx_L12_exception_handled:;
        __Pyx_PyThreadState_assign
        __Pyx_XGIVEREF(__pyx_t_7);
        __Pyx_XGIVEREF(__pyx_t_8);
        __Pyx_XGIVEREF(__pyx_t_9);
        __Pyx_ExceptionReset(__pyx_t_7, __pyx_t_8, __pyx_t_9);
        __pyx_L18_try_end:;
      }

      /* "zmq/utils/buffers.pxd":172
 *         else:
 *             PyObject_AsReadBuffer(ob, <const_void **>&bptr, &blen)
 *         if format:             # <<<<<<<<<<<<<<
 *             try: # numpy.ndarray
 *                 dtype = ob.dtype
 */
    }
  }
  __pyx_L4:;

  /* "zmq/utils/buffers.pxd":189
 *                         bfmt = None
 *                         bitemlen = 0
 *     if base: base[0] = <void *>bptr             # <<<<<<<<<<<<<<
 *     if size: size[0] = <Py_ssize_t>blen
 *     if itemsize: itemsize[0] = <Py_ssize_t>bitemlen
 */
  __pyx_t_17 = (__pyx_v_base != 0);
  if (__pyx_t_17) {
    (__pyx_v_base[0]) = ((void *)__pyx_v_bptr);
  }

  /* "zmq/utils/buffers.pxd":190
 *                         bitemlen = 0
 *     if base: base[0] = <void *>bptr
 *     if size: size[0] = <Py_ssize_t>blen             # <<<<<<<<<<<<<<
 *     if itemsize: itemsize[0] = <Py_ssize_t>bitemlen
 * 
 */
  __pyx_t_17 = (__pyx_v_size != 0);
  if (__pyx_t_17) {
    (__pyx_v_size[0]) = ((Py_ssize_t)__pyx_v_blen);
  }

  /* "zmq/utils/buffers.pxd":191
 *     if base: base[0] = <void *>bptr
 *     if size: size[0] = <Py_ssize_t>blen
 *     if itemsize: itemsize[0] = <Py_ssize_t>bitemlen             # <<<<<<<<<<<<<<
 * 
 *     if PY_MAJOR_VERSION >= 3 and bfmt is not None:
 */
  __pyx_t_17 = (__pyx_v_itemsize != 0);
  if (__pyx_t_17) {
    (__pyx_v_itemsize[0]) = ((Py_ssize_t)__pyx_v_bitemlen);
  }

  /* "zmq/utils/buffers.pxd":193
 *     if itemsize: itemsize[0] = <Py_ssize_t>bitemlen
 * 
 *     if PY_MAJOR_VERSION >= 3 and bfmt is not None:             # <<<<<<<<<<<<<<
 *         return bfmt.decode('ascii')
 *     return bfmt
 */
  __pyx_t_1 = ((PY_MAJOR_VERSION >= 3) != 0);
  if (__pyx_t_1) {
  } else {
    __pyx_t_17 = __pyx_t_1;
    goto __pyx_L36_bool_binop_done;
  }
  __pyx_t_1 = (__pyx_v_bfmt != Py_None);
  __pyx_t_18 = (__pyx_t_1 != 0);
  __pyx_t_17 = __pyx_t_18;
  __pyx_L36_bool_binop_done:;
  if (__pyx_t_17) {

    /* "zmq/utils/buffers.pxd":194
 * 
 *     if PY_MAJOR_VERSION >= 3 and bfmt is not None:
 *         return bfmt.decode('ascii')             # <<<<<<<<<<<<<<
 *     return bfmt
 * 
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_v_bfmt, __pyx_n_s_decode); if (unlikely(!__pyx_t_10)) __PYX_ERR(1, 194, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_10);
    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_10, __pyx_tuple__20, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 194, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
    __pyx_r = __pyx_t_3;
    __pyx_t_3 = 0;
    goto __pyx_L0;

    /* "zmq/utils/buffers.pxd":193
 *     if itemsize: itemsize[0] = <Py_ssize_t>bitemlen
 * 
 *     if PY_MAJOR_VERSION >= 3 and bfmt is not None:             # <<<<<<<<<<<<<<
 *         return bfmt.decode('ascii')
 *     return bfmt
 */
  }

  /* "zmq/utils/buffers.pxd":195
 *     if PY_MAJOR_VERSION >= 3 and bfmt is not None:
 *         return bfmt.decode('ascii')
 *     return bfmt             # <<<<<<<<<<<<<<
 * 
 * 
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_bfmt);
  __pyx_r = __pyx_v_bfmt;
  goto __pyx_L0;

  /* "zmq/utils/buffers.pxd":114
 * 
 * 
 * cdef inline object asbuffer(object ob, int writable, int format,             # <<<<<<<<<<<<<<
 *                             void **base, Py_ssize_t *size,
 *                             Py_ssize_t *itemsize):
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_10);
  __Pyx_XDECREF(__pyx_t_14);
  __Pyx_XDECREF(__pyx_t_15);
  __Pyx_XDECREF(__pyx_t_16);
  __Pyx_AddTraceback("zmq.utils.buffers.asbuffer", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_bfmt);
  __Pyx_XDECREF(__pyx_v_dtype);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "zmq/utils/buffers.pxd":198
 * 
 * 
 * cdef inline object asbuffer_r(object ob, void **base, Py_ssize_t *size):             # <<<<<<<<<<<<<<
 *     """Wrapper for standard calls to asbuffer with a readonly buffer."""
 *     asbuffer(ob, 0, 0, base, size, NULL)
 */

static CYTHON_INLINE PyObject *__pyx_f_3zmq_5utils_7buffers_asbuffer_r(PyObject *__pyx_v_ob, void **__pyx_v_base, Py_ssize_t *__pyx_v_size) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  __Pyx_RefNannySetupContext("asbuffer_r", 0);

  /* "zmq/utils/buffers.pxd":200
 * cdef inline object asbuffer_r(object ob, void **base, Py_ssize_t *size):
 *     """Wrapper for standard calls to asbuffer with a readonly buffer."""
 *     asbuffer(ob, 0, 0, base, size, NULL)             # <<<<<<<<<<<<<<
 *     return ob
 * 
 */
  __pyx_t_1 = __pyx_f_3zmq_5utils_7buffers_asbuffer(__pyx_v_ob, 0, 0, __pyx_v_base, __pyx_v_size, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 200, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "zmq/utils/buffers.pxd":201
 *     """Wrapper for standard calls to asbuffer with a readonly buffer."""
 *     asbuffer(ob, 0, 0, base, size, NULL)
 *     return ob             # <<<<<<<<<<<<<<
 * 
 * 
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_ob);
  __pyx_r = __pyx_v_ob;
  goto __pyx_L0;

  /* "zmq/utils/buffers.pxd":198
 * 
 * 
 * cdef inline object asbuffer_r(object ob, void **base, Py_ssize_t *size):             # <<<<<<<<<<<<<<
 *     """Wrapper for standard calls to asbuffer with a readonly buffer."""
 *     asbuffer(ob, 0, 0, base, size, NULL)
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("zmq.utils.buffers.asbuffer_r", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "zmq/utils/buffers.pxd":204
 * 
 * 
 * cdef inline object asbuffer_w(object ob, void **base, Py_ssize_t *size):             # <<<<<<<<<<<<<<
 *     """Wrapper for standard calls to asbuffer with a writable buffer."""
 *     asbuffer(ob, 1, 0, base, size, NULL)
 */

static CYTHON_INLINE PyObject *__pyx_f_3zmq_5utils_7buffers_asbuffer_w(PyObject *__pyx_v_ob, void **__pyx_v_base, Py_ssize_t *__pyx_v_size) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  __Pyx_RefNannySetupContext("asbuffer_w", 0);

  /* "zmq/utils/buffers.pxd":206
 * cdef inline object asbuffer_w(object ob, void **base, Py_ssize_t *size):
 *     """Wrapper for standard calls to asbuffer with a writable buffer."""
 *     asbuffer(ob, 1, 0, base, size, NULL)             # <<<<<<<<<<<<<<
 *     return ob
 * 
 */
  __pyx_t_1 = __pyx_f_3zmq_5utils_7buffers_asbuffer(__pyx_v_ob, 1, 0, __pyx_v_base, __pyx_v_size, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 206, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "zmq/utils/buffers.pxd":207
 *     """Wrapper for standard calls to asbuffer with a writable buffer."""
 *     asbuffer(ob, 1, 0, base, size, NULL)
 *     return ob             # <<<<<<<<<<<<<<
 * 
 * #------------------------------------------------------------------------------
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_ob);
  __pyx_r = __pyx_v_ob;
  goto __pyx_L0;

  /* "zmq/utils/buffers.pxd":204
 * 
 * 
 * cdef inline object asbuffer_w(object ob, void **base, Py_ssize_t *size):             # <<<<<<<<<<<<<<
 *     """Wrapper for standard calls to asbuffer with a writable buffer."""
 *     asbuffer(ob, 1, 0, base, size, NULL)
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("zmq.utils.buffers.asbuffer_w", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "zmq/utils/buffers.pxd":214
 * 
 * 
 * cdef inline object frombuffer_3(void *ptr, Py_ssize_t s, int readonly):             # <<<<<<<<<<<<<<
 *     """Python 3 version of frombuffer.
 * 
 */

static CYTHON_INLINE PyObject *__pyx_f_3zmq_5utils_7buffers_frombuffer_3(void *__pyx_v_ptr, Py_ssize_t __pyx_v_s, int __pyx_v_readonly) {
  Py_buffer __pyx_v_pybuf;
  Py_ssize_t *__pyx_v_shape;
  PyObject *__pyx_v_astr = 0;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  Py_ssize_t __pyx_t_1[1];
  int __pyx_t_2;
  PyObject *__pyx_t_3 = NULL;
  __Pyx_RefNannySetupContext("frombuffer_3", 0);

  /* "zmq/utils/buffers.pxd":221
 *     """
 *     cdef Py_buffer pybuf
 *     cdef Py_ssize_t *shape = [s]             # <<<<<<<<<<<<<<
 *     cdef str astr=""
 *     PyBuffer_FillInfo(&pybuf, astr, ptr, s, readonly, PyBUF_SIMPLE)
 */
  __pyx_t_1[0] = __pyx_v_s;
  __pyx_v_shape = __pyx_t_1;

  /* "zmq/utils/buffers.pxd":222
 *     cdef Py_buffer pybuf
 *     cdef Py_ssize_t *shape = [s]
 *     cdef str astr=""             # <<<<<<<<<<<<<<
 *     PyBuffer_FillInfo(&pybuf, astr, ptr, s, readonly, PyBUF_SIMPLE)
 *     pybuf.format = "B"
 */
  __Pyx_INCREF(__pyx_kp_s__10);
  __pyx_v_astr = __pyx_kp_s__10;

  /* "zmq/utils/buffers.pxd":223
 *     cdef Py_ssize_t *shape = [s]
 *     cdef str astr=""
 *     PyBuffer_FillInfo(&pybuf, astr, ptr, s, readonly, PyBUF_SIMPLE)             # <<<<<<<<<<<<<<
 *     pybuf.format = "B"
 *     pybuf.shape = shape
 */
  __pyx_t_2 = PyBuffer_FillInfo((&__pyx_v_pybuf), __pyx_v_astr, __pyx_v_ptr, __pyx_v_s, __pyx_v_readonly, PyBUF_SIMPLE); if (unlikely(__pyx_t_2 == -1)) __PYX_ERR(1, 223, __pyx_L1_error)

  /* "zmq/utils/buffers.pxd":224
 *     cdef str astr=""
 *     PyBuffer_FillInfo(&pybuf, astr, ptr, s, readonly, PyBUF_SIMPLE)
 *     pybuf.format = "B"             # <<<<<<<<<<<<<<
 *     pybuf.shape = shape
 *     pybuf.ndim = 1
 */
  __pyx_v_pybuf.format = ((char *)"B");

  /* "zmq/utils/buffers.pxd":225
 *     PyBuffer_FillInfo(&pybuf, astr, ptr, s, readonly, PyBUF_SIMPLE)
 *     pybuf.format = "B"
 *     pybuf.shape = shape             # <<<<<<<<<<<<<<
 *     pybuf.ndim = 1
 *     return PyMemoryView_FromBuffer(&pybuf)
 */
  __pyx_v_pybuf.shape = __pyx_v_shape;

  /* "zmq/utils/buffers.pxd":226
 *     pybuf.format = "B"
 *     pybuf.shape = shape
 *     pybuf.ndim = 1             # <<<<<<<<<<<<<<
 *     return PyMemoryView_FromBuffer(&pybuf)
 * 
 */
  __pyx_v_pybuf.ndim = 1;

  /* "zmq/utils/buffers.pxd":227
 *     pybuf.shape = shape
 *     pybuf.ndim = 1
 *     return PyMemoryView_FromBuffer(&pybuf)             # <<<<<<<<<<<<<<
 * 
 * 
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_3 = PyMemoryView_FromBuffer((&__pyx_v_pybuf)); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 227, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_r = __pyx_t_3;
  __pyx_t_3 = 0;
  goto __pyx_L0;

  /* "zmq/utils/buffers.pxd":214
 * 
 * 
 * cdef inline object frombuffer_3(void *ptr, Py_ssize_t s, int readonly):             # <<<<<<<<<<<<<<
 *     """Python 3 version of frombuffer.
 * 
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_AddTraceback("zmq.utils.buffers.frombuffer_3", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_astr);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "zmq/utils/buffers.pxd":230
 * 
 * 
 * cdef inline object frombuffer_2(void *ptr, Py_ssize_t s, int readonly):             # <<<<<<<<<<<<<<
 *     """Python 2 version of frombuffer.
 * 
 */

static CYTHON_INLINE PyObject *__pyx_f_3zmq_5utils_7buffers_frombuffer_2(void *__pyx_v_ptr, Py_ssize_t __pyx_v_s, int __pyx_v_readonly) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  __Pyx_RefNannySetupContext("frombuffer_2", 0);

  /* "zmq/utils/buffers.pxd":236
 *     """
 * 
 *     if oldstyle_available():             # <<<<<<<<<<<<<<
 *         if readonly:
 *             return PyBuffer_FromMemory(ptr, s)
 */
  __pyx_t_1 = (__pyx_f_3zmq_5utils_7buffers_oldstyle_available() != 0);
  if (__pyx_t_1) {

    /* "zmq/utils/buffers.pxd":237
 * 
 *     if oldstyle_available():
 *         if readonly:             # <<<<<<<<<<<<<<
 *             return PyBuffer_FromMemory(ptr, s)
 *         else:
 */
    __pyx_t_1 = (__pyx_v_readonly != 0);
    if (__pyx_t_1) {

      /* "zmq/utils/buffers.pxd":238
 *     if oldstyle_available():
 *         if readonly:
 *             return PyBuffer_FromMemory(ptr, s)             # <<<<<<<<<<<<<<
 *         else:
 *             return PyBuffer_FromReadWriteMemory(ptr, s)
 */
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_2 = PyBuffer_FromMemory(__pyx_v_ptr, __pyx_v_s); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 238, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_r = __pyx_t_2;
      __pyx_t_2 = 0;
      goto __pyx_L0;

      /* "zmq/utils/buffers.pxd":237
 * 
 *     if oldstyle_available():
 *         if readonly:             # <<<<<<<<<<<<<<
 *             return PyBuffer_FromMemory(ptr, s)
 *         else:
 */
    }

    /* "zmq/utils/buffers.pxd":240
 *             return PyBuffer_FromMemory(ptr, s)
 *         else:
 *             return PyBuffer_FromReadWriteMemory(ptr, s)             # <<<<<<<<<<<<<<
 *     else:
 *         raise NotImplementedError("Old style buffers not available.")
 */
    /*else*/ {
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_2 = PyBuffer_FromReadWriteMemory(__pyx_v_ptr, __pyx_v_s); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 240, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_r = __pyx_t_2;
      __pyx_t_2 = 0;
      goto __pyx_L0;
    }

    /* "zmq/utils/buffers.pxd":236
 *     """
 * 
 *     if oldstyle_available():             # <<<<<<<<<<<<<<
 *         if readonly:
 *             return PyBuffer_FromMemory(ptr, s)
 */
  }

  /* "zmq/utils/buffers.pxd":242
 *             return PyBuffer_FromReadWriteMemory(ptr, s)
 *     else:
 *         raise NotImplementedError("Old style buffers not available.")             # <<<<<<<<<<<<<<
 * 
 * 
 */
  /*else*/ {
    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_NotImplementedError, __pyx_tuple__21, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 242, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_Raise(__pyx_t_2, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __PYX_ERR(1, 242, __pyx_L1_error)
  }

  /* "zmq/utils/buffers.pxd":230
 * 
 * 
 * cdef inline object frombuffer_2(void *ptr, Py_ssize_t s, int readonly):             # <<<<<<<<<<<<<<
 *     """Python 2 version of frombuffer.
 * 
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("zmq.utils.buffers.frombuffer_2", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "zmq/utils/buffers.pxd":245
 * 
 * 
 * cdef inline object frombuffer(void *ptr, Py_ssize_t s, int readonly):             # <<<<<<<<<<<<<<
 *     """Create a Python Buffer/View of a C array.
 * 
 */

static CYTHON_INLINE PyObject *__pyx_f_3zmq_5utils_7buffers_frombuffer(void *__pyx_v_ptr, Py_ssize_t __pyx_v_s, int __pyx_v_readonly) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  __Pyx_RefNannySetupContext("frombuffer", 0);

  /* "zmq/utils/buffers.pxd":262
 *     """
 *     # oldstyle first priority for now
 *     if oldstyle_available():             # <<<<<<<<<<<<<<
 *         return frombuffer_2(ptr, s, readonly)
 *     else:
 */
  __pyx_t_1 = (__pyx_f_3zmq_5utils_7buffers_oldstyle_available() != 0);
  if (__pyx_t_1) {

    /* "zmq/utils/buffers.pxd":263
 *     # oldstyle first priority for now
 *     if oldstyle_available():
 *         return frombuffer_2(ptr, s, readonly)             # <<<<<<<<<<<<<<
 *     else:
 *         return frombuffer_3(ptr, s, readonly)
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = __pyx_f_3zmq_5utils_7buffers_frombuffer_2(__pyx_v_ptr, __pyx_v_s, __pyx_v_readonly); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 263, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "zmq/utils/buffers.pxd":262
 *     """
 *     # oldstyle first priority for now
 *     if oldstyle_available():             # <<<<<<<<<<<<<<
 *         return frombuffer_2(ptr, s, readonly)
 *     else:
 */
  }

  /* "zmq/utils/buffers.pxd":265
 *         return frombuffer_2(ptr, s, readonly)
 *     else:
 *         return frombuffer_3(ptr, s, readonly)             # <<<<<<<<<<<<<<
 * 
 * 
 */
  /*else*/ {
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = __pyx_f_3zmq_5utils_7buffers_frombuffer_3(__pyx_v_ptr, __pyx_v_s, __pyx_v_readonly); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 265, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;
  }

  /* "zmq/utils/buffers.pxd":245
 * 
 * 
 * cdef inline object frombuffer(void *ptr, Py_ssize_t s, int readonly):             # <<<<<<<<<<<<<<
 *     """Create a Python Buffer/View of a C array.
 * 
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("zmq.utils.buffers.frombuffer", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "zmq/utils/buffers.pxd":268
 * 
 * 
 * cdef inline object frombuffer_r(void *ptr, Py_ssize_t s):             # <<<<<<<<<<<<<<
 *     """Wrapper for readonly view frombuffer."""
 *     return frombuffer(ptr, s, 1)
 */

static CYTHON_INLINE PyObject *__pyx_f_3zmq_5utils_7buffers_frombuffer_r(void *__pyx_v_ptr, Py_ssize_t __pyx_v_s) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  __Pyx_RefNannySetupContext("frombuffer_r", 0);

  /* "zmq/utils/buffers.pxd":270
 * cdef inline object frombuffer_r(void *ptr, Py_ssize_t s):
 *     """Wrapper for readonly view frombuffer."""
 *     return frombuffer(ptr, s, 1)             # <<<<<<<<<<<<<<
 * 
 * 
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = __pyx_f_3zmq_5utils_7buffers_frombuffer(__pyx_v_ptr, __pyx_v_s, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 270, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* "zmq/utils/buffers.pxd":268
 * 
 * 
 * cdef inline object frombuffer_r(void *ptr, Py_ssize_t s):             # <<<<<<<<<<<<<<
 *     """Wrapper for readonly view frombuffer."""
 *     return frombuffer(ptr, s, 1)
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("zmq.utils.buffers.frombuffer_r", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "zmq/utils/buffers.pxd":273
 * 
 * 
 * cdef inline object frombuffer_w(void *ptr, Py_ssize_t s):             # <<<<<<<<<<<<<<
 *     """Wrapper for writable view frombuffer."""
 *     return frombuffer(ptr, s, 0)
 */

static CYTHON_INLINE PyObject *__pyx_f_3zmq_5utils_7buffers_frombuffer_w(void *__pyx_v_ptr, Py_ssize_t __pyx_v_s) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  __Pyx_RefNannySetupContext("frombuffer_w", 0);

  /* "zmq/utils/buffers.pxd":275
 * cdef inline object frombuffer_w(void *ptr, Py_ssize_t s):
 *     """Wrapper for writable view frombuffer."""
 *     return frombuffer(ptr, s, 0)             # <<<<<<<<<<<<<<
 * 
 * #------------------------------------------------------------------------------
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = __pyx_f_3zmq_5utils_7buffers_frombuffer(__pyx_v_ptr, __pyx_v_s, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 275, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* "zmq/utils/buffers.pxd":273
 * 
 * 
 * cdef inline object frombuffer_w(void *ptr, Py_ssize_t s):             # <<<<<<<<<<<<<<
 *     """Wrapper for writable view frombuffer."""
 *     return frombuffer(ptr, s, 0)
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("zmq.utils.buffers.frombuffer_w", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "zmq/utils/buffers.pxd":282
 * #------------------------------------------------------------------------------
 * 
 * cdef inline object viewfromobject(object obj, int readonly):             # <<<<<<<<<<<<<<
 *     """Construct a Python Buffer/View object from another Python object.
 * 
 */

static CYTHON_INLINE PyObject *__pyx_f_3zmq_5utils_7buffers_viewfromobject(PyObject *__pyx_v_obj, int __pyx_v_readonly) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  __Pyx_RefNannySetupContext("viewfromobject", 0);

  /* "zmq/utils/buffers.pxd":298
 *     Buffer/View of the original object.
 *     """
 *     if not memoryview_available():             # <<<<<<<<<<<<<<
 *         if readonly:
 *             return PyBuffer_FromObject(obj, 0, Py_END_OF_BUFFER)
 */
  __pyx_t_1 = ((!(__pyx_f_3zmq_5utils_7buffers_memoryview_available() != 0)) != 0);
  if (__pyx_t_1) {

    /* "zmq/utils/buffers.pxd":299
 *     """
 *     if not memoryview_available():
 *         if readonly:             # <<<<<<<<<<<<<<
 *             return PyBuffer_FromObject(obj, 0, Py_END_OF_BUFFER)
 *         else:
 */
    __pyx_t_1 = (__pyx_v_readonly != 0);
    if (__pyx_t_1) {

      /* "zmq/utils/buffers.pxd":300
 *     if not memoryview_available():
 *         if readonly:
 *             return PyBuffer_FromObject(obj, 0, Py_END_OF_BUFFER)             # <<<<<<<<<<<<<<
 *         else:
 *             return PyBuffer_FromReadWriteObject(obj, 0, Py_END_OF_BUFFER)
 */
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_2 = PyBuffer_FromObject(__pyx_v_obj, 0, Py_END_OF_BUFFER); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 300, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_r = __pyx_t_2;
      __pyx_t_2 = 0;
      goto __pyx_L0;

      /* "zmq/utils/buffers.pxd":299
 *     """
 *     if not memoryview_available():
 *         if readonly:             # <<<<<<<<<<<<<<
 *             return PyBuffer_FromObject(obj, 0, Py_END_OF_BUFFER)
 *         else:
 */
    }

    /* "zmq/utils/buffers.pxd":302
 *             return PyBuffer_FromObject(obj, 0, Py_END_OF_BUFFER)
 *         else:
 *             return PyBuffer_FromReadWriteObject(obj, 0, Py_END_OF_BUFFER)             # <<<<<<<<<<<<<<
 *     else:
 *         return PyMemoryView_FromObject(obj)
 */
    /*else*/ {
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_2 = PyBuffer_FromReadWriteObject(__pyx_v_obj, 0, Py_END_OF_BUFFER); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 302, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_r = __pyx_t_2;
      __pyx_t_2 = 0;
      goto __pyx_L0;
    }

    /* "zmq/utils/buffers.pxd":298
 *     Buffer/View of the original object.
 *     """
 *     if not memoryview_available():             # <<<<<<<<<<<<<<
 *         if readonly:
 *             return PyBuffer_FromObject(obj, 0, Py_END_OF_BUFFER)
 */
  }

  /* "zmq/utils/buffers.pxd":304
 *             return PyBuffer_FromReadWriteObject(obj, 0, Py_END_OF_BUFFER)
 *     else:
 *         return PyMemoryView_FromObject(obj)             # <<<<<<<<<<<<<<
 * 
 * 
 */
  /*else*/ {
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = PyMemoryView_FromObject(__pyx_v_obj); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 304, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;
  }

  /* "zmq/utils/buffers.pxd":282
 * #------------------------------------------------------------------------------
 * 
 * cdef inline object viewfromobject(object obj, int readonly):             # <<<<<<<<<<<<<<
 *     """Construct a Python Buffer/View object from another Python object.
 * 
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("zmq.utils.buffers.viewfromobject", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "zmq/utils/buffers.pxd":307
 * 
 * 
 * cdef inline object viewfromobject_r(object obj):             # <<<<<<<<<<<<<<
 *     """Wrapper for readonly viewfromobject."""
 *     return viewfromobject(obj, 1)
 */

static CYTHON_INLINE PyObject *__pyx_f_3zmq_5utils_7buffers_viewfromobject_r(PyObject *__pyx_v_obj) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  __Pyx_RefNannySetupContext("viewfromobject_r", 0);

  /* "zmq/utils/buffers.pxd":309
 * cdef inline object viewfromobject_r(object obj):
 *     """Wrapper for readonly viewfromobject."""
 *     return viewfromobject(obj, 1)             # <<<<<<<<<<<<<<
 * 
 * 
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = __pyx_f_3zmq_5utils_7buffers_viewfromobject(__pyx_v_obj, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 309, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* "zmq/utils/buffers.pxd":307
 * 
 * 
 * cdef inline object viewfromobject_r(object obj):             # <<<<<<<<<<<<<<
 *     """Wrapper for readonly viewfromobject."""
 *     return viewfromobject(obj, 1)
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("zmq.utils.buffers.viewfromobject_r", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "zmq/utils/buffers.pxd":312
 * 
 * 
 * cdef inline object viewfromobject_w(object obj):             # <<<<<<<<<<<<<<
 *     """Wrapper for writable viewfromobject."""
 *     return viewfromobject(obj, 0)
 */

static CYTHON_INLINE PyObject *__pyx_f_3zmq_5utils_7buffers_viewfromobject_w(PyObject *__pyx_v_obj) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  __Pyx_RefNannySetupContext("viewfromobject_w", 0);

  /* "zmq/utils/buffers.pxd":314
 * cdef inline object viewfromobject_w(object obj):
 *     """Wrapper for writable viewfromobject."""
 *     return viewfromobject(obj, 0)             # <<<<<<<<<<<<<<
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = __pyx_f_3zmq_5utils_7buffers_viewfromobject(__pyx_v_obj, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 314, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* "zmq/utils/buffers.pxd":312
 * 
 * 
 * cdef inline object viewfromobject_w(object obj):             # <<<<<<<<<<<<<<
 *     """Wrapper for writable viewfromobject."""
 *     return viewfromobject(obj, 0)
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("zmq.utils.buffers.viewfromobject_w", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "cymessage.pxd":45
 *     cdef gets(self, unicode option)
 * 
 * cdef inline bytes copy_zmq_msg_bytes(zmq_msg_t *zmq_msg):             # <<<<<<<<<<<<<<
 *     """ Copy the data from a zmq_msg_t """
 *     cdef char *data_c = NULL
 */

static CYTHON_INLINE PyObject *__pyx_f_8volttron_8platform_3vip_6router_9cymessage_copy_zmq_msg_bytes(zmq_msg_t *__pyx_v_zmq_msg) {
  char *__pyx_v_data_c;
  CYTHON_UNUSED Py_ssize_t __pyx_v_data_len_c;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  __Pyx_RefNannySetupContext("copy_zmq_msg_bytes", 0);

  /* "cymessage.pxd":47
 * cdef inline bytes copy_zmq_msg_bytes(zmq_msg_t *zmq_msg):
 *     """ Copy the data from a zmq_msg_t """
 *     cdef char *data_c = NULL             # <<<<<<<<<<<<<<
 *     cdef Py_ssize_t data_len_c
 *     data_c = <char *>zmq_msg_data(zmq_msg)
 */
  __pyx_v_data_c = NULL;

  /* "cymessage.pxd":49
 *     cdef char *data_c = NULL
 *     cdef Py_ssize_t data_len_c
 *     data_c = <char *>zmq_msg_data(zmq_msg)             # <<<<<<<<<<<<<<
 *     data_len_c = zmq_msg_size(zmq_msg)
 *     return data_c
 */
  __pyx_v_data_c = ((char *)zmq_msg_data(__pyx_v_zmq_msg));

  /* "cymessage.pxd":50
 *     cdef Py_ssize_t data_len_c
 *     data_c = <char *>zmq_msg_data(zmq_msg)
 *     data_len_c = zmq_msg_size(zmq_msg)             # <<<<<<<<<<<<<<
 *     return data_c
 *     #return PyBytes_FromStringAndSize(data_c, data_len_c)
 */
  __pyx_v_data_len_c = zmq_msg_size(__pyx_v_zmq_msg);

  /* "cymessage.pxd":51
 *     data_c = <char *>zmq_msg_data(zmq_msg)
 *     data_len_c = zmq_msg_size(zmq_msg)
 *     return data_c             # <<<<<<<<<<<<<<
 *     #return PyBytes_FromStringAndSize(data_c, data_len_c)
 * 
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = __Pyx_PyBytes_FromString(__pyx_v_data_c); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 51, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* "cymessage.pxd":45
 *     cdef gets(self, unicode option)
 * 
 * cdef inline bytes copy_zmq_msg_bytes(zmq_msg_t *zmq_msg):             # <<<<<<<<<<<<<<
 *     """ Copy the data from a zmq_msg_t """
 *     cdef char *data_c = NULL
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("volttron.platform.vip.router.cymessage.copy_zmq_msg_bytes", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "string.from_py":13
 * 
 * @cname("__pyx_convert_string_from_py_std__in_string")
 * cdef string __pyx_convert_string_from_py_std__in_string(object o) except *:             # <<<<<<<<<<<<<<
 *     cdef Py_ssize_t length
 *     cdef char* data = __Pyx_PyObject_AsStringAndSize(o, &length)
 */

static std::string __pyx_convert_string_from_py_std__in_string(PyObject *__pyx_v_o) {
  Py_ssize_t __pyx_v_length;
  char *__pyx_v_data;
  std::string __pyx_r;
  __Pyx_RefNannyDeclarations
  char *__pyx_t_1;
  __Pyx_RefNannySetupContext("__pyx_convert_string_from_py_std__in_string", 0);

  /* "string.from_py":15
 * cdef string __pyx_convert_string_from_py_std__in_string(object o) except *:
 *     cdef Py_ssize_t length
 *     cdef char* data = __Pyx_PyObject_AsStringAndSize(o, &length)             # <<<<<<<<<<<<<<
 *     return string(data, length)
 * 
 */
  __pyx_t_1 = __Pyx_PyObject_AsStringAndSize(__pyx_v_o, (&__pyx_v_length)); if (unlikely(__pyx_t_1 == NULL)) __PYX_ERR(3, 15, __pyx_L1_error)
  __pyx_v_data = __pyx_t_1;

  /* "string.from_py":16
 *     cdef Py_ssize_t length
 *     cdef char* data = __Pyx_PyObject_AsStringAndSize(o, &length)
 *     return string(data, length)             # <<<<<<<<<<<<<<
 * 
 * 
 */
  __pyx_r = std::string(__pyx_v_data, __pyx_v_length);
  goto __pyx_L0;

  /* "string.from_py":13
 * 
 * @cname("__pyx_convert_string_from_py_std__in_string")
 * cdef string __pyx_convert_string_from_py_std__in_string(object o) except *:             # <<<<<<<<<<<<<<
 *     cdef Py_ssize_t length
 *     cdef char* data = __Pyx_PyObject_AsStringAndSize(o, &length)
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_AddTraceback("string.from_py.__pyx_convert_string_from_py_std__in_string", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_L0:;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "string.to_py":31
 * 
 * @cname("__pyx_convert_PyObject_string_to_py_std__in_string")
 * cdef inline object __pyx_convert_PyObject_string_to_py_std__in_string(const string& s):             # <<<<<<<<<<<<<<
 *     return __Pyx_PyObject_FromStringAndSize(s.data(), s.size())
 * cdef extern from *:
 */

static CYTHON_INLINE PyObject *__pyx_convert_PyObject_string_to_py_std__in_string(std::string const &__pyx_v_s) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  __Pyx_RefNannySetupContext("__pyx_convert_PyObject_string_to_py_std__in_string", 0);

  /* "string.to_py":32
 * @cname("__pyx_convert_PyObject_string_to_py_std__in_string")
 * cdef inline object __pyx_convert_PyObject_string_to_py_std__in_string(const string& s):
 *     return __Pyx_PyObject_FromStringAndSize(s.data(), s.size())             # <<<<<<<<<<<<<<
 * cdef extern from *:
 *     cdef object __Pyx_PyUnicode_FromStringAndSize(char*, size_t)
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = __Pyx_PyObject_FromStringAndSize(__pyx_v_s.data(), __pyx_v_s.size()); if (unlikely(!__pyx_t_1)) __PYX_ERR(3, 32, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* "string.to_py":31
 * 
 * @cname("__pyx_convert_PyObject_string_to_py_std__in_string")
 * cdef inline object __pyx_convert_PyObject_string_to_py_std__in_string(const string& s):             # <<<<<<<<<<<<<<
 *     return __Pyx_PyObject_FromStringAndSize(s.data(), s.size())
 * cdef extern from *:
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("string.to_py.__pyx_convert_PyObject_string_to_py_std__in_string", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "string.to_py":37
 * 
 * @cname("__pyx_convert_PyUnicode_string_to_py_std__in_string")
 * cdef inline object __pyx_convert_PyUnicode_string_to_py_std__in_string(const string& s):             # <<<<<<<<<<<<<<
 *     return __Pyx_PyUnicode_FromStringAndSize(s.data(), s.size())
 * cdef extern from *:
 */

static CYTHON_INLINE PyObject *__pyx_convert_PyUnicode_string_to_py_std__in_string(std::string const &__pyx_v_s) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  __Pyx_RefNannySetupContext("__pyx_convert_PyUnicode_string_to_py_std__in_string", 0);

  /* "string.to_py":38
 * @cname("__pyx_convert_PyUnicode_string_to_py_std__in_string")
 * cdef inline object __pyx_convert_PyUnicode_string_to_py_std__in_string(const string& s):
 *     return __Pyx_PyUnicode_FromStringAndSize(s.data(), s.size())             # <<<<<<<<<<<<<<
 * cdef extern from *:
 *     cdef object __Pyx_PyStr_FromStringAndSize(char*, size_t)
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = __Pyx_PyUnicode_FromStringAndSize(__pyx_v_s.data(), __pyx_v_s.size()); if (unlikely(!__pyx_t_1)) __PYX_ERR(3, 38, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* "string.to_py":37
 * 
 * @cname("__pyx_convert_PyUnicode_string_to_py_std__in_string")
 * cdef inline object __pyx_convert_PyUnicode_string_to_py_std__in_string(const string& s):             # <<<<<<<<<<<<<<
 *     return __Pyx_PyUnicode_FromStringAndSize(s.data(), s.size())
 * cdef extern from *:
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("string.to_py.__pyx_convert_PyUnicode_string_to_py_std__in_string", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "string.to_py":43
 * 
 * @cname("__pyx_convert_PyStr_string_to_py_std__in_string")
 * cdef inline object __pyx_convert_PyStr_string_to_py_std__in_string(const string& s):             # <<<<<<<<<<<<<<
 *     return __Pyx_PyStr_FromStringAndSize(s.data(), s.size())
 * cdef extern from *:
 */

static CYTHON_INLINE PyObject *__pyx_convert_PyStr_string_to_py_std__in_string(std::string const &__pyx_v_s) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  __Pyx_RefNannySetupContext("__pyx_convert_PyStr_string_to_py_std__in_string", 0);

  /* "string.to_py":44
 * @cname("__pyx_convert_PyStr_string_to_py_std__in_string")
 * cdef inline object __pyx_convert_PyStr_string_to_py_std__in_string(const string& s):
 *     return __Pyx_PyStr_FromStringAndSize(s.data(), s.size())             # <<<<<<<<<<<<<<
 * cdef extern from *:
 *     cdef object __Pyx_PyBytes_FromStringAndSize(char*, size_t)
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = __Pyx_PyStr_FromStringAndSize(__pyx_v_s.data(), __pyx_v_s.size()); if (unlikely(!__pyx_t_1)) __PYX_ERR(3, 44, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* "string.to_py":43
 * 
 * @cname("__pyx_convert_PyStr_string_to_py_std__in_string")
 * cdef inline object __pyx_convert_PyStr_string_to_py_std__in_string(const string& s):             # <<<<<<<<<<<<<<
 *     return __Pyx_PyStr_FromStringAndSize(s.data(), s.size())
 * cdef extern from *:
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("string.to_py.__pyx_convert_PyStr_string_to_py_std__in_string", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "string.to_py":49
 * 
 * @cname("__pyx_convert_PyBytes_string_to_py_std__in_string")
 * cdef inline object __pyx_convert_PyBytes_string_to_py_std__in_string(const string& s):             # <<<<<<<<<<<<<<
 *     return __Pyx_PyBytes_FromStringAndSize(s.data(), s.size())
 * cdef extern from *:
 */

static CYTHON_INLINE PyObject *__pyx_convert_PyBytes_string_to_py_std__in_string(std::string const &__pyx_v_s) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  __Pyx_RefNannySetupContext("__pyx_convert_PyBytes_string_to_py_std__in_string", 0);

  /* "string.to_py":50
 * @cname("__pyx_convert_PyBytes_string_to_py_std__in_string")
 * cdef inline object __pyx_convert_PyBytes_string_to_py_std__in_string(const string& s):
 *     return __Pyx_PyBytes_FromStringAndSize(s.data(), s.size())             # <<<<<<<<<<<<<<
 * cdef extern from *:
 *     cdef object __Pyx_PyByteArray_FromStringAndSize(char*, size_t)
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = __Pyx_PyBytes_FromStringAndSize(__pyx_v_s.data(), __pyx_v_s.size()); if (unlikely(!__pyx_t_1)) __PYX_ERR(3, 50, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* "string.to_py":49
 * 
 * @cname("__pyx_convert_PyBytes_string_to_py_std__in_string")
 * cdef inline object __pyx_convert_PyBytes_string_to_py_std__in_string(const string& s):             # <<<<<<<<<<<<<<
 *     return __Pyx_PyBytes_FromStringAndSize(s.data(), s.size())
 * cdef extern from *:
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("string.to_py.__pyx_convert_PyBytes_string_to_py_std__in_string", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "string.to_py":55
 * 
 * @cname("__pyx_convert_PyByteArray_string_to_py_std__in_string")
 * cdef inline object __pyx_convert_PyByteArray_string_to_py_std__in_string(const string& s):             # <<<<<<<<<<<<<<
 *     return __Pyx_PyByteArray_FromStringAndSize(s.data(), s.size())
 * 
 */

static CYTHON_INLINE PyObject *__pyx_convert_PyByteArray_string_to_py_std__in_string(std::string const &__pyx_v_s) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  __Pyx_RefNannySetupContext("__pyx_convert_PyByteArray_string_to_py_std__in_string", 0);

  /* "string.to_py":56
 * @cname("__pyx_convert_PyByteArray_string_to_py_std__in_string")
 * cdef inline object __pyx_convert_PyByteArray_string_to_py_std__in_string(const string& s):
 *     return __Pyx_PyByteArray_FromStringAndSize(s.data(), s.size())             # <<<<<<<<<<<<<<
 * 
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = __Pyx_PyByteArray_FromStringAndSize(__pyx_v_s.data(), __pyx_v_s.size()); if (unlikely(!__pyx_t_1)) __PYX_ERR(3, 56, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* "string.to_py":55
 * 
 * @cname("__pyx_convert_PyByteArray_string_to_py_std__in_string")
 * cdef inline object __pyx_convert_PyByteArray_string_to_py_std__in_string(const string& s):             # <<<<<<<<<<<<<<
 *     return __Pyx_PyByteArray_FromStringAndSize(s.data(), s.size())
 * 
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("string.to_py.__pyx_convert_PyByteArray_string_to_py_std__in_string", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vector.from_py":50
 * 
 * @cname("__pyx_convert_vector_from_py_std_3a__3a_string")
 * cdef vector[X] __pyx_convert_vector_from_py_std_3a__3a_string(object o) except *:             # <<<<<<<<<<<<<<
 *     cdef vector[X] v
 *     for item in o:
 */

static std::vector<std::string>  __pyx_convert_vector_from_py_std_3a__3a_string(PyObject *__pyx_v_o) {
  std::vector<std::string>  __pyx_v_v;
  PyObject *__pyx_v_item = NULL;
  std::vector<std::string>  __pyx_r;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  Py_ssize_t __pyx_t_2;
  PyObject *(*__pyx_t_3)(PyObject *);
  PyObject *__pyx_t_4 = NULL;
  std::string __pyx_t_5;
  __Pyx_RefNannySetupContext("__pyx_convert_vector_from_py_std_3a__3a_string", 0);

  /* "vector.from_py":52
 * cdef vector[X] __pyx_convert_vector_from_py_std_3a__3a_string(object o) except *:
 *     cdef vector[X] v
 *     for item in o:             # <<<<<<<<<<<<<<
 *         v.push_back(X_from_py(item))
 *     return v
 */
  if (likely(PyList_CheckExact(__pyx_v_o)) || PyTuple_CheckExact(__pyx_v_o)) {
    __pyx_t_1 = __pyx_v_o; __Pyx_INCREF(__pyx_t_1); __pyx_t_2 = 0;
    __pyx_t_3 = NULL;
  } else {
    __pyx_t_2 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_v_o); if (unlikely(!__pyx_t_1)) __PYX_ERR(3, 52, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_3 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_3)) __PYX_ERR(3, 52, __pyx_L1_error)
  }
  for (;;) {
    if (likely(!__pyx_t_3)) {
      if (likely(PyList_CheckExact(__pyx_t_1))) {
        if (__pyx_t_2 >= PyList_GET_SIZE(__pyx_t_1)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_4 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_4); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(3, 52, __pyx_L1_error)
        #else
        __pyx_t_4 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_4)) __PYX_ERR(3, 52, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_4);
        #endif
      } else {
        if (__pyx_t_2 >= PyTuple_GET_SIZE(__pyx_t_1)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_4 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_4); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(3, 52, __pyx_L1_error)
        #else
        __pyx_t_4 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_4)) __PYX_ERR(3, 52, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_4);
        #endif
      }
    } else {
      __pyx_t_4 = __pyx_t_3(__pyx_t_1);
      if (unlikely(!__pyx_t_4)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(3, 52, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_4);
    }
    __Pyx_XDECREF_SET(__pyx_v_item, __pyx_t_4);
    __pyx_t_4 = 0;

    /* "vector.from_py":53
 *     cdef vector[X] v
 *     for item in o:
 *         v.push_back(X_from_py(item))             # <<<<<<<<<<<<<<
 *     return v
 * 
 */
    __pyx_t_5 = __pyx_convert_string_from_py_std__in_string(__pyx_v_item); if (unlikely(PyErr_Occurred())) __PYX_ERR(3, 53, __pyx_L1_error)
    __pyx_v_v.push_back(__pyx_t_5);

    /* "vector.from_py":52
 * cdef vector[X] __pyx_convert_vector_from_py_std_3a__3a_string(object o) except *:
 *     cdef vector[X] v
 *     for item in o:             # <<<<<<<<<<<<<<
 *         v.push_back(X_from_py(item))
 *     return v
 */
  }
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "vector.from_py":54
 *     for item in o:
 *         v.push_back(X_from_py(item))
 *     return v             # <<<<<<<<<<<<<<
 * 
 * 
 */
  __pyx_r = __pyx_v_v;
  goto __pyx_L0;

  /* "vector.from_py":50
 * 
 * @cname("__pyx_convert_vector_from_py_std_3a__3a_string")
 * cdef vector[X] __pyx_convert_vector_from_py_std_3a__3a_string(object o) except *:             # <<<<<<<<<<<<<<
 *     cdef vector[X] v
 *     for item in o:
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_AddTraceback("vector.from_py.__pyx_convert_vector_from_py_std_3a__3a_string", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_item);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "set.to_py":144
 * 
 * @cname("__pyx_convert_set_to_py_std_3a__3a_string")
 * cdef object __pyx_convert_set_to_py_std_3a__3a_string(const cpp_set[X]& s):             # <<<<<<<<<<<<<<
 *     o = set()
 *     cdef cpp_set[X].const_iterator iter = s.begin()
 */

static PyObject *__pyx_convert_set_to_py_std_3a__3a_string(std::set<std::string>  const &__pyx_v_s) {
  PyObject *__pyx_v_o = NULL;
  std::set<std::string> ::const_iterator __pyx_v_iter;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_t_2;
  int __pyx_t_3;
  __Pyx_RefNannySetupContext("__pyx_convert_set_to_py_std_3a__3a_string", 0);

  /* "set.to_py":145
 * @cname("__pyx_convert_set_to_py_std_3a__3a_string")
 * cdef object __pyx_convert_set_to_py_std_3a__3a_string(const cpp_set[X]& s):
 *     o = set()             # <<<<<<<<<<<<<<
 *     cdef cpp_set[X].const_iterator iter = s.begin()
 *     while iter != s.end():
 */
  __pyx_t_1 = PySet_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(3, 145, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_o = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "set.to_py":146
 * cdef object __pyx_convert_set_to_py_std_3a__3a_string(const cpp_set[X]& s):
 *     o = set()
 *     cdef cpp_set[X].const_iterator iter = s.begin()             # <<<<<<<<<<<<<<
 *     while iter != s.end():
 *         o.add(X_to_py(cython.operator.dereference(iter)))
 */
  __pyx_v_iter = __pyx_v_s.begin();

  /* "set.to_py":147
 *     o = set()
 *     cdef cpp_set[X].const_iterator iter = s.begin()
 *     while iter != s.end():             # <<<<<<<<<<<<<<
 *         o.add(X_to_py(cython.operator.dereference(iter)))
 *         cython.operator.preincrement(iter)
 */
  while (1) {
    __pyx_t_2 = ((__pyx_v_iter != __pyx_v_s.end()) != 0);
    if (!__pyx_t_2) break;

    /* "set.to_py":148
 *     cdef cpp_set[X].const_iterator iter = s.begin()
 *     while iter != s.end():
 *         o.add(X_to_py(cython.operator.dereference(iter)))             # <<<<<<<<<<<<<<
 *         cython.operator.preincrement(iter)
 *     return o
 */
    __pyx_t_1 = __pyx_convert_PyObject_string_to_py_std__in_string((*__pyx_v_iter)); if (unlikely(!__pyx_t_1)) __PYX_ERR(3, 148, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_3 = PySet_Add(__pyx_v_o, __pyx_t_1); if (unlikely(__pyx_t_3 == -1)) __PYX_ERR(3, 148, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "set.to_py":149
 *     while iter != s.end():
 *         o.add(X_to_py(cython.operator.dereference(iter)))
 *         cython.operator.preincrement(iter)             # <<<<<<<<<<<<<<
 *     return o
 * 
 */
    (++__pyx_v_iter);
  }

  /* "set.to_py":150
 *         o.add(X_to_py(cython.operator.dereference(iter)))
 *         cython.operator.preincrement(iter)
 *     return o             # <<<<<<<<<<<<<<
 * 
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_o);
  __pyx_r = __pyx_v_o;
  goto __pyx_L0;

  /* "set.to_py":144
 * 
 * @cname("__pyx_convert_set_to_py_std_3a__3a_string")
 * cdef object __pyx_convert_set_to_py_std_3a__3a_string(const cpp_set[X]& s):             # <<<<<<<<<<<<<<
 *     o = set()
 *     cdef cpp_set[X].const_iterator iter = s.begin()
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("set.to_py.__pyx_convert_set_to_py_std_3a__3a_string", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_o);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}
static struct __pyx_vtabstruct_8volttron_8platform_3vip_6router_8routercy_BaseRouter __pyx_vtable_8volttron_8platform_3vip_6router_8routercy_BaseRouter;

static PyObject *__pyx_tp_new_8volttron_8platform_3vip_6router_8routercy_BaseRouter(PyTypeObject *t, PyObject *a, PyObject *k) {
  struct __pyx_obj_8volttron_8platform_3vip_6router_8routercy_BaseRouter *p;
  PyObject *o;
  if (likely((t->tp_flags & Py_TPFLAGS_IS_ABSTRACT) == 0)) {
    o = (*t->tp_alloc)(t, 0);
  } else {
    o = (PyObject *) PyBaseObject_Type.tp_new(t, __pyx_empty_tuple, 0);
  }
  if (unlikely(!o)) return 0;
  p = ((struct __pyx_obj_8volttron_8platform_3vip_6router_8routercy_BaseRouter *)o);
  p->__pyx_vtab = __pyx_vtabptr_8volttron_8platform_3vip_6router_8routercy_BaseRouter;
  new((void*)&(p->_peers)) std::set<std::string> ();
  p->socket = ((struct __pyx_obj_8volttron_8platform_3vip_6router_8cysocket_Socket *)Py_None); Py_INCREF(Py_None);
  p->context = Py_None; Py_INCREF(Py_None);
  p->default_user_id = Py_None; Py_INCREF(Py_None);
  p->logger = Py_None; Py_INCREF(Py_None);
  if (unlikely(__pyx_pw_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_1__cinit__(o, a, k) < 0)) {
    Py_DECREF(o); o = 0;
  }
  return o;
}

static void __pyx_tp_dealloc_8volttron_8platform_3vip_6router_8routercy_BaseRouter(PyObject *o) {
  struct __pyx_obj_8volttron_8platform_3vip_6router_8routercy_BaseRouter *p = (struct __pyx_obj_8volttron_8platform_3vip_6router_8routercy_BaseRouter *)o;
  #if PY_VERSION_HEX >= 0x030400a1
  if (unlikely(Py_TYPE(o)->tp_finalize) && !_PyGC_FINALIZED(o)) {
    if (PyObject_CallFinalizerFromDealloc(o)) return;
  }
  #endif
  PyObject_GC_UnTrack(o);
  __Pyx_call_destructor(p->_peers);
  Py_CLEAR(p->socket);
  Py_CLEAR(p->context);
  Py_CLEAR(p->default_user_id);
  Py_CLEAR(p->logger);
  (*Py_TYPE(o)->tp_free)(o);
}

static int __pyx_tp_traverse_8volttron_8platform_3vip_6router_8routercy_BaseRouter(PyObject *o, visitproc v, void *a) {
  int e;
  struct __pyx_obj_8volttron_8platform_3vip_6router_8routercy_BaseRouter *p = (struct __pyx_obj_8volttron_8platform_3vip_6router_8routercy_BaseRouter *)o;
  if (p->socket) {
    e = (*v)(((PyObject*)p->socket), a); if (e) return e;
  }
  if (p->context) {
    e = (*v)(p->context, a); if (e) return e;
  }
  if (p->default_user_id) {
    e = (*v)(p->default_user_id, a); if (e) return e;
  }
  if (p->logger) {
    e = (*v)(p->logger, a); if (e) return e;
  }
  return 0;
}

static int __pyx_tp_clear_8volttron_8platform_3vip_6router_8routercy_BaseRouter(PyObject *o) {
  PyObject* tmp;
  struct __pyx_obj_8volttron_8platform_3vip_6router_8routercy_BaseRouter *p = (struct __pyx_obj_8volttron_8platform_3vip_6router_8routercy_BaseRouter *)o;
  tmp = ((PyObject*)p->socket);
  p->socket = ((struct __pyx_obj_8volttron_8platform_3vip_6router_8cysocket_Socket *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(tmp);
  tmp = ((PyObject*)p->context);
  p->context = Py_None; Py_INCREF(Py_None);
  Py_XDECREF(tmp);
  tmp = ((PyObject*)p->default_user_id);
  p->default_user_id = Py_None; Py_INCREF(Py_None);
  Py_XDECREF(tmp);
  tmp = ((PyObject*)p->logger);
  p->logger = Py_None; Py_INCREF(Py_None);
  Py_XDECREF(tmp);
  return 0;
}

static PyMethodDef __pyx_methods_8volttron_8platform_3vip_6router_8routercy_BaseRouter[] = {
  {"run", (PyCFunction)__pyx_pw_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_3run, METH_NOARGS, __pyx_doc_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_2run},
  {"start", (PyCFunction)__pyx_pw_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_5start, METH_NOARGS, __pyx_doc_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_4start},
  {"stop", (PyCFunction)__pyx_pw_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_7stop, METH_VARARGS|METH_KEYWORDS, __pyx_doc_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_6stop},
  {"setup", (PyCFunction)__pyx_pw_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_9setup, METH_NOARGS, __pyx_doc_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_8setup},
  {"poll", (PyCFunction)__pyx_pw_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_11poll, METH_NOARGS, __pyx_doc_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_10poll},
  {"handle_subsystem", (PyCFunction)__pyx_pw_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_13handle_subsystem, METH_VARARGS|METH_KEYWORDS, __pyx_doc_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_12handle_subsystem},
  {"issue", (PyCFunction)__pyx_pw_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_15issue, METH_VARARGS|METH_KEYWORDS, 0},
  {"lookup_user_id", (PyCFunction)__pyx_pw_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_17lookup_user_id, METH_VARARGS|METH_KEYWORDS, __pyx_doc_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_16lookup_user_id},
  {"lookup_user_id", (PyCFunction)__pyx_pw_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_19lookup_user_id, METH_VARARGS|METH_KEYWORDS, __pyx_doc_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_18lookup_user_id},
  {"_add_peer", (PyCFunction)__pyx_pw_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_21_add_peer, METH_O, 0},
  {"_drop_peer", (PyCFunction)__pyx_pw_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_23_drop_peer, METH_O, 0},
  {"route", (PyCFunction)__pyx_pw_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_25route, METH_NOARGS, __pyx_doc_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_24route},
  {"_send", (PyCFunction)__pyx_pw_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_27_send, METH_O, 0},
  {0, 0, 0, 0}
};

static PyTypeObject __pyx_type_8volttron_8platform_3vip_6router_8routercy_BaseRouter = {
  PyVarObject_HEAD_INIT(0, 0)
  "volttron.platform.vip.router.routercy.BaseRouter", /*tp_name*/
  sizeof(struct __pyx_obj_8volttron_8platform_3vip_6router_8routercy_BaseRouter), /*tp_basicsize*/
  0, /*tp_itemsize*/
  __pyx_tp_dealloc_8volttron_8platform_3vip_6router_8routercy_BaseRouter, /*tp_dealloc*/
  0, /*tp_print*/
  0, /*tp_getattr*/
  0, /*tp_setattr*/
  #if PY_MAJOR_VERSION < 3
  0, /*tp_compare*/
  #endif
  #if PY_MAJOR_VERSION >= 3
  0, /*tp_as_async*/
  #endif
  0, /*tp_repr*/
  0, /*tp_as_number*/
  0, /*tp_as_sequence*/
  0, /*tp_as_mapping*/
  0, /*tp_hash*/
  0, /*tp_call*/
  0, /*tp_str*/
  0, /*tp_getattro*/
  0, /*tp_setattro*/
  0, /*tp_as_buffer*/
  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_HAVE_VERSION_TAG|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_HAVE_NEWBUFFER|Py_TPFLAGS_BASETYPE|Py_TPFLAGS_HAVE_GC, /*tp_flags*/
  "Abstract base class of VIP router implementation.\n\n    Router implementers should inherit this class and implement the\n    setup() method to bind to appropriate addresses, set identities,\n    setup authentication, etc, etc. The socket will be created by the\n    start() method, which will then call the setup() method.  Once\n    started, the socket may be polled for incoming messages and those\n    messages are handled/routed by calling the route() method.  During\n    routing, the issue() method, which may be implemented, will be\n    called to allow for debugging and logging. Custom subsystems may be\n    implemented in the handle_subsystem() method. The socket will be\n    closed when the stop() method is called.\n    ", /*tp_doc*/
  __pyx_tp_traverse_8volttron_8platform_3vip_6router_8routercy_BaseRouter, /*tp_traverse*/
  __pyx_tp_clear_8volttron_8platform_3vip_6router_8routercy_BaseRouter, /*tp_clear*/
  0, /*tp_richcompare*/
  0, /*tp_weaklistoffset*/
  0, /*tp_iter*/
  0, /*tp_iternext*/
  __pyx_methods_8volttron_8platform_3vip_6router_8routercy_BaseRouter, /*tp_methods*/
  0, /*tp_members*/
  0, /*tp_getset*/
  0, /*tp_base*/
  0, /*tp_dict*/
  0, /*tp_descr_get*/
  0, /*tp_descr_set*/
  0, /*tp_dictoffset*/
  0, /*tp_init*/
  0, /*tp_alloc*/
  __pyx_tp_new_8volttron_8platform_3vip_6router_8routercy_BaseRouter, /*tp_new*/
  0, /*tp_free*/
  0, /*tp_is_gc*/
  0, /*tp_bases*/
  0, /*tp_mro*/
  0, /*tp_cache*/
  0, /*tp_subclasses*/
  0, /*tp_weaklist*/
  0, /*tp_del*/
  0, /*tp_version_tag*/
  #if PY_VERSION_HEX >= 0x030400a1
  0, /*tp_finalize*/
  #endif
};

static PyMethodDef __pyx_methods[] = {
  {0, 0, 0, 0}
};

static int __pyx_import_star_set(PyObject *o, PyObject* py_name, char *name) {
  static const char* internal_type_names[] = {
    "BaseRouter",
    "CySocket",
    "Queue",
    "X",
    "__pyx_ctuple_char__ptr",
    "__pyx_ctuple_char__ptr_struct",
    "__pyx_ctuple_int",
    "__pyx_ctuple_int_struct",
    "__pyx_ctuple_long",
    "__pyx_ctuple_long__and_long__and_long",
    "__pyx_ctuple_long__and_long__and_long_struct",
    "__pyx_ctuple_long_struct",
    "__pyx_ctuple_std__in_set__lAngstd__in_string__rAng",
    "__pyx_ctuple_std__in_set__lAngstd__in_string__rAng_struct",
    "__pyx_ctuple_std__in_string",
    "__pyx_ctuple_std__in_string_struct",
    "__pyx_opt_args_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_issue",
    "__pyx_opt_args_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_stop",
    "cpp_set",
    "set",
    "string",
    "vector",
    0
  };
  const char** type_name = internal_type_names;
  while (*type_name) {
    if (__Pyx_StrEq(name, *type_name)) {
      PyErr_Format(PyExc_TypeError, "Cannot overwrite C type %s", name);
      goto bad;
    }
    type_name++;
  }
  if (0);
  else {
    if (PyObject_SetAttr(__pyx_m, py_name, o) < 0) goto bad;
  }
  return 0;
  bad:
  return -1;
}

























































































































static int
__Pyx_import_all_from(PyObject *locals, PyObject *v)
{
    PyObject *all = PyObject_GetAttrString(v, "__all__");
    PyObject *dict, *name, *value;
    int skip_leading_underscores = 0;
    int pos, err;

    if (all == NULL) {
        if (!PyErr_ExceptionMatches(PyExc_AttributeError))
            return -1;
        PyErr_Clear();
        dict = PyObject_GetAttrString(v, "__dict__");
        if (dict == NULL) {
            if (!PyErr_ExceptionMatches(PyExc_AttributeError))
                return -1;
            PyErr_SetString(PyExc_ImportError,
            "from-import-* object has no __dict__ and no __all__");
            return -1;
        }
#if PY_MAJOR_VERSION < 3
        all = PyObject_CallMethod(dict, (char *)"keys", NULL);
#else
        all = PyMapping_Keys(dict);
#endif
        Py_DECREF(dict);
        if (all == NULL)
            return -1;
        skip_leading_underscores = 1;
    }

    for (pos = 0, err = 0; ; pos++) {
        name = PySequence_GetItem(all, pos);
        if (name == NULL) {
            if (!PyErr_ExceptionMatches(PyExc_IndexError))
                err = -1;
            else
                PyErr_Clear();
            break;
        }
        if (skip_leading_underscores &&
#if PY_MAJOR_VERSION < 3
            PyString_Check(name) &&
            PyString_AS_STRING(name)[0] == '_')
#else
            PyUnicode_Check(name) &&
            PyUnicode_AS_UNICODE(name)[0] == '_')
#endif
        {
            Py_DECREF(name);
            continue;
        }
        value = PyObject_GetAttr(v, name);
        if (value == NULL)
            err = -1;
        else if (PyDict_CheckExact(locals))
            err = PyDict_SetItem(locals, name, value);
        else
            err = PyObject_SetItem(locals, name, value);
        Py_DECREF(name);
        Py_XDECREF(value);
        if (err != 0)
            break;
    }
    Py_DECREF(all);
    return err;
}


static int __pyx_import_star(PyObject* m) {

    int i;
    int ret = -1;
    char* s;
    PyObject *locals = 0;
    PyObject *list = 0;
#if PY_MAJOR_VERSION >= 3
    PyObject *utf8_name = 0;
#endif
    PyObject *name;
    PyObject *item;

    locals = PyDict_New();              if (!locals) goto bad;
    if (__Pyx_import_all_from(locals, m) < 0) goto bad;
    list = PyDict_Items(locals);        if (!list) goto bad;

    for(i=0; i<PyList_GET_SIZE(list); i++) {
        name = PyTuple_GET_ITEM(PyList_GET_ITEM(list, i), 0);
        item = PyTuple_GET_ITEM(PyList_GET_ITEM(list, i), 1);
#if PY_MAJOR_VERSION >= 3
        utf8_name = PyUnicode_AsUTF8String(name);
        if (!utf8_name) goto bad;
        s = PyBytes_AS_STRING(utf8_name);
        if (__pyx_import_star_set(item, name, s) < 0) goto bad;
        Py_DECREF(utf8_name); utf8_name = 0;
#else
        s = PyString_AsString(name);
        if (!s) goto bad;
        if (__pyx_import_star_set(item, name, s) < 0) goto bad;
#endif
    }
    ret = 0;

bad:
    Py_XDECREF(locals);
    Py_XDECREF(list);
#if PY_MAJOR_VERSION >= 3
    Py_XDECREF(utf8_name);
#endif
    return ret;
}



#if PY_MAJOR_VERSION >= 3
static struct PyModuleDef __pyx_moduledef = {
  #if PY_VERSION_HEX < 0x03020000
    { PyObject_HEAD_INIT(NULL) NULL, 0, NULL },
  #else
    PyModuleDef_HEAD_INIT,
  #endif
    "routercy",
    0, /* m_doc */
    -1, /* m_size */
    __pyx_methods /* m_methods */,
    NULL, /* m_reload */
    NULL, /* m_traverse */
    NULL, /* m_clear */
    NULL /* m_free */
};
#endif

static __Pyx_StringTabEntry __pyx_string_tab[] = {
  {&__pyx_kp_b_1_0, __pyx_k_1_0, sizeof(__pyx_k_1_0), 0, 0, 0, 0},
  {&__pyx_n_s_AttributeError, __pyx_k_AttributeError, sizeof(__pyx_k_AttributeError), 0, 0, 1, 1},
  {&__pyx_n_b_B, __pyx_k_B, sizeof(__pyx_k_B), 0, 0, 0, 1},
  {&__pyx_kp_s_BaseRouter_cinit, __pyx_k_BaseRouter_cinit, sizeof(__pyx_k_BaseRouter_cinit), 0, 0, 1, 0},
  {&__pyx_kp_s_BaseRouter_run, __pyx_k_BaseRouter_run, sizeof(__pyx_k_BaseRouter_run), 0, 0, 1, 0},
  {&__pyx_kp_s_BaseRouter_start, __pyx_k_BaseRouter_start, sizeof(__pyx_k_BaseRouter_start), 0, 0, 1, 0},
  {&__pyx_kp_s_BaseRouter_stop, __pyx_k_BaseRouter_stop, sizeof(__pyx_k_BaseRouter_stop), 0, 0, 1, 0},
  {&__pyx_n_s_Context, __pyx_k_Context, sizeof(__pyx_k_Context), 0, 0, 1, 1},
  {&__pyx_n_s_DEBUG, __pyx_k_DEBUG, sizeof(__pyx_k_DEBUG), 0, 0, 1, 1},
  {&__pyx_n_s_EHOSTUNREACH, __pyx_k_EHOSTUNREACH, sizeof(__pyx_k_EHOSTUNREACH), 0, 0, 1, 1},
  {&__pyx_n_s_EINVAL, __pyx_k_EINVAL, sizeof(__pyx_k_EINVAL), 0, 0, 1, 1},
  {&__pyx_n_s_ERROR, __pyx_k_ERROR, sizeof(__pyx_k_ERROR), 0, 0, 1, 1},
  {&__pyx_n_s_INCOMING, __pyx_k_INCOMING, sizeof(__pyx_k_INCOMING), 0, 0, 1, 1},
  {&__pyx_n_s_INVALID_SUBSYSTEM, __pyx_k_INVALID_SUBSYSTEM, sizeof(__pyx_k_INVALID_SUBSYSTEM), 0, 0, 1, 1},
  {&__pyx_n_s_IndexError, __pyx_k_IndexError, sizeof(__pyx_k_IndexError), 0, 0, 1, 1},
  {&__pyx_n_s_KeyError, __pyx_k_KeyError, sizeof(__pyx_k_KeyError), 0, 0, 1, 1},
  {&__pyx_n_s_NOBLOCK, __pyx_k_NOBLOCK, sizeof(__pyx_k_NOBLOCK), 0, 0, 1, 1},
  {&__pyx_n_s_NOTSET, __pyx_k_NOTSET, sizeof(__pyx_k_NOTSET), 0, 0, 1, 1},
  {&__pyx_n_s_NotImplementedError, __pyx_k_NotImplementedError, sizeof(__pyx_k_NotImplementedError), 0, 0, 1, 1},
  {&__pyx_n_s_OUTGOING, __pyx_k_OUTGOING, sizeof(__pyx_k_OUTGOING), 0, 0, 1, 1},
  {&__pyx_kp_s_Old_style_buffers_not_available, __pyx_k_Old_style_buffers_not_available, sizeof(__pyx_k_Old_style_buffers_not_available), 0, 0, 1, 0},
  {&__pyx_n_s_ROUTER, __pyx_k_ROUTER, sizeof(__pyx_k_ROUTER), 0, 0, 1, 1},
  {&__pyx_n_s_ROUTE_ERRORS, __pyx_k_ROUTE_ERRORS, sizeof(__pyx_k_ROUTE_ERRORS), 0, 0, 1, 1},
  {&__pyx_n_s_TypeError, __pyx_k_TypeError, sizeof(__pyx_k_TypeError), 0, 0, 1, 1},
  {&__pyx_n_s_UNROUTABLE, __pyx_k_UNROUTABLE, sizeof(__pyx_k_UNROUTABLE), 0, 0, 1, 1},
  {&__pyx_kp_s_User_Id, __pyx_k_User_Id, sizeof(__pyx_k_User_Id), 0, 0, 1, 0},
  {&__pyx_n_b_VIP, __pyx_k_VIP, sizeof(__pyx_k_VIP), 0, 0, 0, 1},
  {&__pyx_n_b_VIP1, __pyx_k_VIP1, sizeof(__pyx_k_VIP1), 0, 0, 0, 1},
  {&__pyx_n_s_ZMQError, __pyx_k_ZMQError, sizeof(__pyx_k_ZMQError), 0, 0, 1, 1},
  {&__pyx_kp_b__10, __pyx_k__10, sizeof(__pyx_k__10), 0, 0, 0, 0},
  {&__pyx_kp_s__10, __pyx_k__10, sizeof(__pyx_k__10), 0, 0, 1, 0},
  {&__pyx_n_s__22, __pyx_k__22, sizeof(__pyx_k__22), 0, 0, 1, 1},
  {&__pyx_n_b_add, __pyx_k_add, sizeof(__pyx_k_add), 0, 0, 0, 1},
  {&__pyx_n_s_add_peer, __pyx_k_add_peer, sizeof(__pyx_k_add_peer), 0, 0, 1, 1},
  {&__pyx_n_s_ascii, __pyx_k_ascii, sizeof(__pyx_k_ascii), 0, 0, 1, 1},
  {&__pyx_n_s_at, __pyx_k_at, sizeof(__pyx_k_at), 0, 0, 1, 1},
  {&__pyx_n_s_auth_token, __pyx_k_auth_token, sizeof(__pyx_k_auth_token), 0, 0, 1, 1},
  {&__pyx_kp_s_bad_VIP_signature, __pyx_k_bad_VIP_signature, sizeof(__pyx_k_bad_VIP_signature), 0, 0, 1, 0},
  {&__pyx_n_s_bytes, __pyx_k_bytes, sizeof(__pyx_k_bytes), 0, 0, 1, 1},
  {&__pyx_n_s_char, __pyx_k_char, sizeof(__pyx_k_char), 0, 0, 1, 1},
  {&__pyx_n_s_clear, __pyx_k_clear, sizeof(__pyx_k_clear), 0, 0, 1, 1},
  {&__pyx_n_s_close, __pyx_k_close, sizeof(__pyx_k_close), 0, 0, 1, 1},
  {&__pyx_n_s_context, __pyx_k_context, sizeof(__pyx_k_context), 0, 0, 1, 1},
  {&__pyx_n_s_copy, __pyx_k_copy, sizeof(__pyx_k_copy), 0, 0, 1, 1},
  {&__pyx_kp_s_cython_baserouter, __pyx_k_cython_baserouter, sizeof(__pyx_k_cython_baserouter), 0, 0, 1, 0},
  {&__pyx_n_s_decode, __pyx_k_decode, sizeof(__pyx_k_decode), 0, 0, 1, 1},
  {&__pyx_n_s_default_user_id, __pyx_k_default_user_id, sizeof(__pyx_k_default_user_id), 0, 0, 1, 1},
  {&__pyx_n_b_drop, __pyx_k_drop, sizeof(__pyx_k_drop), 0, 0, 0, 1},
  {&__pyx_n_s_drop_peer, __pyx_k_drop_peer, sizeof(__pyx_k_drop_peer), 0, 0, 1, 1},
  {&__pyx_n_s_dtype, __pyx_k_dtype, sizeof(__pyx_k_dtype), 0, 0, 1, 1},
  {&__pyx_n_s_empty, __pyx_k_empty, sizeof(__pyx_k_empty), 0, 0, 1, 1},
  {&__pyx_n_s_encode, __pyx_k_encode, sizeof(__pyx_k_encode), 0, 0, 1, 1},
  {&__pyx_n_s_end, __pyx_k_end, sizeof(__pyx_k_end), 0, 0, 1, 1},
  {&__pyx_n_s_errno, __pyx_k_errno, sizeof(__pyx_k_errno), 0, 0, 1, 1},
  {&__pyx_n_b_error, __pyx_k_error, sizeof(__pyx_k_error), 0, 0, 0, 1},
  {&__pyx_n_s_extend, __pyx_k_extend, sizeof(__pyx_k_extend), 0, 0, 1, 1},
  {&__pyx_n_s_extra, __pyx_k_extra, sizeof(__pyx_k_extra), 0, 0, 1, 1},
  {&__pyx_n_s_file, __pyx_k_file, sizeof(__pyx_k_file), 0, 0, 1, 1},
  {&__pyx_n_s_flags, __pyx_k_flags, sizeof(__pyx_k_flags), 0, 0, 1, 1},
  {&__pyx_n_s_frames, __pyx_k_frames, sizeof(__pyx_k_frames), 0, 0, 1, 1},
  {&__pyx_n_s_get, __pyx_k_get, sizeof(__pyx_k_get), 0, 0, 1, 1},
  {&__pyx_n_s_getLogger, __pyx_k_getLogger, sizeof(__pyx_k_getLogger), 0, 0, 1, 1},
  {&__pyx_n_s_handle_subsystem, __pyx_k_handle_subsystem, sizeof(__pyx_k_handle_subsystem), 0, 0, 1, 1},
  {&__pyx_n_s_handlers, __pyx_k_handlers, sizeof(__pyx_k_handlers), 0, 0, 1, 1},
  {&__pyx_n_b_hello, __pyx_k_hello, sizeof(__pyx_k_hello), 0, 0, 0, 1},
  {&__pyx_n_s_import, __pyx_k_import, sizeof(__pyx_k_import), 0, 0, 1, 1},
  {&__pyx_n_s_instance, __pyx_k_instance, sizeof(__pyx_k_instance), 0, 0, 1, 1},
  {&__pyx_n_s_issue, __pyx_k_issue, sizeof(__pyx_k_issue), 0, 0, 1, 1},
  {&__pyx_n_s_itemsize, __pyx_k_itemsize, sizeof(__pyx_k_itemsize), 0, 0, 1, 1},
  {&__pyx_n_s_level, __pyx_k_level, sizeof(__pyx_k_level), 0, 0, 1, 1},
  {&__pyx_n_s_linger, __pyx_k_linger, sizeof(__pyx_k_linger), 0, 0, 1, 1},
  {&__pyx_n_b_list, __pyx_k_list, sizeof(__pyx_k_list), 0, 0, 0, 1},
  {&__pyx_n_b_listing, __pyx_k_listing, sizeof(__pyx_k_listing), 0, 0, 0, 1},
  {&__pyx_n_s_logging, __pyx_k_logging, sizeof(__pyx_k_logging), 0, 0, 1, 1},
  {&__pyx_n_s_logging_config, __pyx_k_logging_config, sizeof(__pyx_k_logging_config), 0, 0, 1, 1},
  {&__pyx_n_s_main, __pyx_k_main, sizeof(__pyx_k_main), 0, 0, 1, 1},
  {&__pyx_n_b_missing, __pyx_k_missing, sizeof(__pyx_k_missing), 0, 0, 0, 1},
  {&__pyx_kp_b_operation, __pyx_k_operation, sizeof(__pyx_k_operation), 0, 0, 0, 0},
  {&__pyx_n_s_os, __pyx_k_os, sizeof(__pyx_k_os), 0, 0, 1, 1},
  {&__pyx_n_b_peerlist, __pyx_k_peerlist, sizeof(__pyx_k_peerlist), 0, 0, 0, 1},
  {&__pyx_n_b_ping, __pyx_k_ping, sizeof(__pyx_k_ping), 0, 0, 0, 1},
  {&__pyx_n_s_poll, __pyx_k_poll, sizeof(__pyx_k_poll), 0, 0, 1, 1},
  {&__pyx_n_b_pong, __pyx_k_pong, sizeof(__pyx_k_pong), 0, 0, 0, 1},
  {&__pyx_n_s_print, __pyx_k_print, sizeof(__pyx_k_print), 0, 0, 1, 1},
  {&__pyx_n_s_pyx_vtable, __pyx_k_pyx_vtable, sizeof(__pyx_k_pyx_vtable), 0, 0, 1, 1},
  {&__pyx_kp_s_r_does_not_provide_a_buffer_int, __pyx_k_r_does_not_provide_a_buffer_int, sizeof(__pyx_k_r_does_not_provide_a_buffer_int), 0, 0, 1, 0},
  {&__pyx_n_s_recipient, __pyx_k_recipient, sizeof(__pyx_k_recipient), 0, 0, 1, 1},
  {&__pyx_n_s_recv_multipart, __pyx_k_recv_multipart, sizeof(__pyx_k_recv_multipart), 0, 0, 1, 1},
  {&__pyx_n_s_route, __pyx_k_route, sizeof(__pyx_k_route), 0, 0, 1, 1},
  {&__pyx_n_s_router_mandatory, __pyx_k_router_mandatory, sizeof(__pyx_k_router_mandatory), 0, 0, 1, 1},
  {&__pyx_kp_s_router_probe, __pyx_k_router_probe, sizeof(__pyx_k_router_probe), 0, 0, 1, 0},
  {&__pyx_n_s_run, __pyx_k_run, sizeof(__pyx_k_run), 0, 0, 1, 1},
  {&__pyx_n_s_send, __pyx_k_send, sizeof(__pyx_k_send), 0, 0, 1, 1},
  {&__pyx_n_s_send_multipart, __pyx_k_send_multipart, sizeof(__pyx_k_send_multipart), 0, 0, 1, 1},
  {&__pyx_n_s_sender, __pyx_k_sender, sizeof(__pyx_k_sender), 0, 0, 1, 1},
  {&__pyx_n_s_setLevel, __pyx_k_setLevel, sizeof(__pyx_k_setLevel), 0, 0, 1, 1},
  {&__pyx_n_s_setup, __pyx_k_setup, sizeof(__pyx_k_setup), 0, 0, 1, 1},
  {&__pyx_n_s_size, __pyx_k_size, sizeof(__pyx_k_size), 0, 0, 1, 1},
  {&__pyx_n_s_sndtimeo, __pyx_k_sndtimeo, sizeof(__pyx_k_sndtimeo), 0, 0, 1, 1},
  {&__pyx_n_s_socket_class, __pyx_k_socket_class, sizeof(__pyx_k_socket_class), 0, 0, 1, 1},
  {&__pyx_n_s_start, __pyx_k_start, sizeof(__pyx_k_start), 0, 0, 1, 1},
  {&__pyx_n_s_stop, __pyx_k_stop, sizeof(__pyx_k_stop), 0, 0, 1, 1},
  {&__pyx_n_s_sys, __pyx_k_sys, sizeof(__pyx_k_sys), 0, 0, 1, 1},
  {&__pyx_n_s_tcp_keepalive, __pyx_k_tcp_keepalive, sizeof(__pyx_k_tcp_keepalive), 0, 0, 1, 1},
  {&__pyx_n_s_tcp_keepalive_cnt, __pyx_k_tcp_keepalive_cnt, sizeof(__pyx_k_tcp_keepalive_cnt), 0, 0, 1, 1},
  {&__pyx_n_s_tcp_keepalive_idle, __pyx_k_tcp_keepalive_idle, sizeof(__pyx_k_tcp_keepalive_idle), 0, 0, 1, 1},
  {&__pyx_n_s_tcp_keepalive_intvl, __pyx_k_tcp_keepalive_intvl, sizeof(__pyx_k_tcp_keepalive_intvl), 0, 0, 1, 1},
  {&__pyx_n_s_test, __pyx_k_test, sizeof(__pyx_k_test), 0, 0, 1, 1},
  {&__pyx_kp_s_too_few_frames, __pyx_k_too_few_frames, sizeof(__pyx_k_too_few_frames), 0, 0, 1, 0},
  {&__pyx_n_s_topic, __pyx_k_topic, sizeof(__pyx_k_topic), 0, 0, 1, 1},
  {&__pyx_n_s_typecode, __pyx_k_typecode, sizeof(__pyx_k_typecode), 0, 0, 1, 1},
  {&__pyx_n_b_unknown, __pyx_k_unknown, sizeof(__pyx_k_unknown), 0, 0, 0, 1},
  {&__pyx_n_s_user_id, __pyx_k_user_id, sizeof(__pyx_k_user_id), 0, 0, 1, 1},
  {&__pyx_kp_s_utf_8, __pyx_k_utf_8, sizeof(__pyx_k_utf_8), 0, 0, 1, 0},
  {&__pyx_n_s_uuid, __pyx_k_uuid, sizeof(__pyx_k_uuid), 0, 0, 1, 1},
  {&__pyx_n_b_welcome, __pyx_k_welcome, sizeof(__pyx_k_welcome), 0, 0, 0, 1},
  {&__pyx_n_s_zmq, __pyx_k_zmq, sizeof(__pyx_k_zmq), 0, 0, 1, 1},
  {&__pyx_n_s_zmq_utils, __pyx_k_zmq_utils, sizeof(__pyx_k_zmq_utils), 0, 0, 1, 1},
  {&__pyx_n_s_zmq_version_info, __pyx_k_zmq_version_info, sizeof(__pyx_k_zmq_version_info), 0, 0, 1, 1},
  {0, 0, 0, 0, 0, 0, 0}
};
static int __Pyx_InitCachedBuiltins(void) {
  __pyx_builtin_NotImplementedError = __Pyx_GetBuiltinName(__pyx_n_s_NotImplementedError); if (!__pyx_builtin_NotImplementedError) __PYX_ERR(0, 102, __pyx_L1_error)
  __pyx_builtin_IndexError = __Pyx_GetBuiltinName(__pyx_n_s_IndexError); if (!__pyx_builtin_IndexError) __PYX_ERR(0, 314, __pyx_L1_error)
  __pyx_builtin_KeyError = __Pyx_GetBuiltinName(__pyx_n_s_KeyError); if (!__pyx_builtin_KeyError) __PYX_ERR(0, 401, __pyx_L1_error)
  __pyx_builtin_TypeError = __Pyx_GetBuiltinName(__pyx_n_s_TypeError); if (!__pyx_builtin_TypeError) __PYX_ERR(1, 151, __pyx_L1_error)
  __pyx_builtin_AttributeError = __Pyx_GetBuiltinName(__pyx_n_s_AttributeError); if (!__pyx_builtin_AttributeError) __PYX_ERR(1, 177, __pyx_L1_error)
  return 0;
  __pyx_L1_error:;
  return -1;
}

static int __Pyx_InitCachedConstants(void) {
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__Pyx_InitCachedConstants", 0);

  /* "volttron/platform/vip/router/routercy.pyx":57
 *         else:
 *             self.default_user_id = None
 *         self.logger = logging.getLogger('cython.baserouter')             # <<<<<<<<<<<<<<
 *         if self.logger.level == logging.NOTSET:
 *             self.logger.setLevel(logging.DEBUG)
 */
  __pyx_tuple_ = PyTuple_Pack(1, __pyx_kp_s_cython_baserouter); if (unlikely(!__pyx_tuple_)) __PYX_ERR(0, 57, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple_);
  __Pyx_GIVEREF(__pyx_tuple_);

  /* "volttron/platform/vip/router/routercy.pyx":145
 *             # A user id might/should be set by the ZAP authenticator
 *             try:
 *                 return recipient.get('User-Id').encode('utf-8')             # <<<<<<<<<<<<<<
 *             except ZMQError as exc:
 *                 if exc.errno != EINVAL:
 */
  __pyx_tuple__2 = PyTuple_Pack(1, __pyx_kp_s_User_Id); if (unlikely(!__pyx_tuple__2)) __PYX_ERR(0, 145, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__2);
  __Pyx_GIVEREF(__pyx_tuple__2);
  __pyx_tuple__3 = PyTuple_Pack(1, __pyx_kp_s_utf_8); if (unlikely(!__pyx_tuple__3)) __PYX_ERR(0, 145, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__3);
  __Pyx_GIVEREF(__pyx_tuple__3);

  /* "volttron/platform/vip/router/routercy.pyx":176
 *             char* cmd_data = NULL
 *             char* peer_data = NULL
 *             cymessage.Frame vipframe = cymessage.Frame(b'VIP')             # <<<<<<<<<<<<<<
 *             cymessage.Frame sysdata, cmdata, prdata
 * 
 */
  __pyx_tuple__4 = PyTuple_Pack(1, __pyx_n_b_VIP); if (unlikely(!__pyx_tuple__4)) __PYX_ERR(0, 176, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__4);
  __Pyx_GIVEREF(__pyx_tuple__4);

  /* "volttron/platform/vip/router/routercy.pyx":290
 *                 frames.append(<void*>user_id)
 *                 frames.append(<void*>msg_id)
 *                 hello = cymessage.Frame(b'hello')             # <<<<<<<<<<<<<<
 *                 welcome =cymessage.Frame(b'welcome')
 *                 ver = cymessage.Frame(b'1.0')
 */
  __pyx_tuple__5 = PyTuple_Pack(1, __pyx_n_b_hello); if (unlikely(!__pyx_tuple__5)) __PYX_ERR(0, 290, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__5);
  __Pyx_GIVEREF(__pyx_tuple__5);

  /* "volttron/platform/vip/router/routercy.pyx":291
 *                 frames.append(<void*>msg_id)
 *                 hello = cymessage.Frame(b'hello')
 *                 welcome =cymessage.Frame(b'welcome')             # <<<<<<<<<<<<<<
 *                 ver = cymessage.Frame(b'1.0')
 *                 frames.append(<void*>hello)
 */
  __pyx_tuple__6 = PyTuple_Pack(1, __pyx_n_b_welcome); if (unlikely(!__pyx_tuple__6)) __PYX_ERR(0, 291, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__6);
  __Pyx_GIVEREF(__pyx_tuple__6);

  /* "volttron/platform/vip/router/routercy.pyx":292
 *                 hello = cymessage.Frame(b'hello')
 *                 welcome =cymessage.Frame(b'welcome')
 *                 ver = cymessage.Frame(b'1.0')             # <<<<<<<<<<<<<<
 *                 frames.append(<void*>hello)
 *                 frames.append(<void*>welcome)
 */
  __pyx_tuple__7 = PyTuple_Pack(1, __pyx_kp_b_1_0); if (unlikely(!__pyx_tuple__7)) __PYX_ERR(0, 292, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__7);
  __Pyx_GIVEREF(__pyx_tuple__7);

  /* "volttron/platform/vip/router/routercy.pyx":305
 *                 frames.append(<void*>user_id)
 *                 frames.append(<void*>msg_id)
 *                 ping = cymessage.Frame(b'ping')             # <<<<<<<<<<<<<<
 *                 pong = cymessage.Frame(b'pong')
 *                 frames.append(<void*>ping)
 */
  __pyx_tuple__8 = PyTuple_Pack(1, __pyx_n_b_ping); if (unlikely(!__pyx_tuple__8)) __PYX_ERR(0, 305, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__8);
  __Pyx_GIVEREF(__pyx_tuple__8);

  /* "volttron/platform/vip/router/routercy.pyx":306
 *                 frames.append(<void*>msg_id)
 *                 ping = cymessage.Frame(b'ping')
 *                 pong = cymessage.Frame(b'pong')             # <<<<<<<<<<<<<<
 *                 frames.append(<void*>ping)
 *                 frames.append(<void*>pong)
 */
  __pyx_tuple__9 = PyTuple_Pack(1, __pyx_n_b_pong); if (unlikely(!__pyx_tuple__9)) __PYX_ERR(0, 306, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__9);
  __Pyx_GIVEREF(__pyx_tuple__9);

  /* "volttron/platform/vip/router/routercy.pyx":320
 *                 frames.append(<void*>recipient)
 *                 frames.append(<void*>proto)
 *                 temp = cymessage.Frame(b'')             # <<<<<<<<<<<<<<
 *                 frames.append(<void*>temp)
 *                 frames.append(<void*>msg_id)
 */
  __pyx_tuple__11 = PyTuple_Pack(1, __pyx_kp_b__10); if (unlikely(!__pyx_tuple__11)) __PYX_ERR(0, 320, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__11);
  __Pyx_GIVEREF(__pyx_tuple__11);

  /* "volttron/platform/vip/router/routercy.pyx":325
 *                 frames.append(<void*>subsystem)
 *                 if op == b'list':
 *                     listing = cymessage.Frame(b'listing')             # <<<<<<<<<<<<<<
 *                     frames.append(<void*>listing)
 *                     frames.append(<void*>recipient)
 */
  __pyx_tuple__12 = PyTuple_Pack(1, __pyx_n_b_listing); if (unlikely(!__pyx_tuple__12)) __PYX_ERR(0, 325, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__12);
  __Pyx_GIVEREF(__pyx_tuple__12);

  /* "volttron/platform/vip/router/routercy.pyx":332
 *                 else:
 *                     error = (b'unknown' if op else b'missing') + b' operation'
 *                     err = cymessage.Frame(b'error')             # <<<<<<<<<<<<<<
 *                     frames.append(<void*>err)
 *                     frames.append(<void*>error)
 */
  __pyx_tuple__13 = PyTuple_Pack(1, __pyx_n_b_error); if (unlikely(!__pyx_tuple__13)) __PYX_ERR(0, 332, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__13);
  __Pyx_GIVEREF(__pyx_tuple__13);

  /* "volttron/platform/vip/router/routercy.pyx":347
 *                     frames.append(<void*>recipient)
 *                     frames.append(<void*>proto)
 *                     temp = cymessage.Frame(b'')             # <<<<<<<<<<<<<<
 *                     frames.append(<void*>temp)
 *                     frames.append(<void*>msg_id)
 */
  __pyx_tuple__14 = PyTuple_Pack(1, __pyx_kp_b__10); if (unlikely(!__pyx_tuple__14)) __PYX_ERR(0, 347, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__14);
  __Pyx_GIVEREF(__pyx_tuple__14);

  /* "volttron/platform/vip/router/routercy.pyx":350
 *                     frames.append(<void*>temp)
 *                     frames.append(<void*>msg_id)
 *                     err = cymessage.Frame(b'error')             # <<<<<<<<<<<<<<
 *                     frames.append(<void*>err)
 *                     frames.append(<void*>errnum)
 */
  __pyx_tuple__15 = PyTuple_Pack(1, __pyx_n_b_error); if (unlikely(!__pyx_tuple__15)) __PYX_ERR(0, 350, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__15);
  __Pyx_GIVEREF(__pyx_tuple__15);

  /* "volttron/platform/vip/router/routercy.pyx":390
 * 
 *         #recipient, sender = frames[:2]
 *         recipient = frames.at(0)             # <<<<<<<<<<<<<<
 *         sender = frames.at(1)
 *         # Expecting outgoing frames:
 */
  __pyx_tuple__16 = PyTuple_Pack(1, __pyx_int_0); if (unlikely(!__pyx_tuple__16)) __PYX_ERR(0, 390, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__16);
  __Pyx_GIVEREF(__pyx_tuple__16);

  /* "volttron/platform/vip/router/routercy.pyx":391
 *         #recipient, sender = frames[:2]
 *         recipient = frames.at(0)
 *         sender = frames.at(1)             # <<<<<<<<<<<<<<
 *         # Expecting outgoing frames:
 *         #   [RECIPIENT, SENDER, PROTO, USER_ID, MSG_ID, SUBSYS, ...]
 */
  __pyx_tuple__17 = PyTuple_Pack(1, __pyx_int_1); if (unlikely(!__pyx_tuple__17)) __PYX_ERR(0, 391, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__17);
  __Pyx_GIVEREF(__pyx_tuple__17);

  /* "volttron/platform/vip/router/routercy.pyx":412
 *             if exc.errno != EHOSTUNREACH or sender is not frames[0]:
 *                 # Only send errors if the sender and recipient differ
 *                 proto, user_id, msg_id, subsystem = frames[2:6]             # <<<<<<<<<<<<<<
 *                 #frames = [sender, b'', proto, user_id, msg_id,
 *                 #          b'error', errnum, errmsg, recipient, subsystem]
 */
  __pyx_slice__18 = PySlice_New(__pyx_int_2, __pyx_int_6, Py_None); if (unlikely(!__pyx_slice__18)) __PYX_ERR(0, 412, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_slice__18);
  __Pyx_GIVEREF(__pyx_slice__18);

  /* "volttron/platform/vip/router/routercy.pyx":420
 *                 frames.append(<void*>user_id)
 *                 frames.append(<void*>msg_id)
 *                 err = cymessage.Frame(b'error')             # <<<<<<<<<<<<<<
 *                 frames.append(<void*>err)
 *                 erno = cymessage.Frame(errnum)
 */
  __pyx_tuple__19 = PyTuple_Pack(1, __pyx_n_b_error); if (unlikely(!__pyx_tuple__19)) __PYX_ERR(0, 420, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__19);
  __Pyx_GIVEREF(__pyx_tuple__19);

  /* "zmq/utils/buffers.pxd":194
 * 
 *     if PY_MAJOR_VERSION >= 3 and bfmt is not None:
 *         return bfmt.decode('ascii')             # <<<<<<<<<<<<<<
 *     return bfmt
 * 
 */
  __pyx_tuple__20 = PyTuple_Pack(1, __pyx_n_s_ascii); if (unlikely(!__pyx_tuple__20)) __PYX_ERR(1, 194, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__20);
  __Pyx_GIVEREF(__pyx_tuple__20);

  /* "zmq/utils/buffers.pxd":242
 *             return PyBuffer_FromReadWriteMemory(ptr, s)
 *     else:
 *         raise NotImplementedError("Old style buffers not available.")             # <<<<<<<<<<<<<<
 * 
 * 
 */
  __pyx_tuple__21 = PyTuple_Pack(1, __pyx_kp_s_Old_style_buffers_not_available); if (unlikely(!__pyx_tuple__21)) __PYX_ERR(1, 242, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__21);
  __Pyx_GIVEREF(__pyx_tuple__21);

  /* "volttron/platform/vip/router/routercy.pyx":134
 *         pass
 * 
 *     if zmq.zmq_version_info() >= (4, 1, 0):             # <<<<<<<<<<<<<<
 *         def lookup_user_id(self, sender, recipient, auth_token):
 *             '''Find and return a user identifier.
 */
  __pyx_tuple__23 = PyTuple_Pack(3, __pyx_int_4, __pyx_int_1, __pyx_int_0); if (unlikely(!__pyx_tuple__23)) __PYX_ERR(0, 134, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__23);
  __Pyx_GIVEREF(__pyx_tuple__23);
  __Pyx_RefNannyFinishContext();
  return 0;
  __pyx_L1_error:;
  __Pyx_RefNannyFinishContext();
  return -1;
}

static int __Pyx_InitGlobals(void) {
  if (__Pyx_InitStrings(__pyx_string_tab) < 0) __PYX_ERR(0, 1, __pyx_L1_error);
  __pyx_int_0 = PyInt_FromLong(0); if (unlikely(!__pyx_int_0)) __PYX_ERR(0, 1, __pyx_L1_error)
  __pyx_int_1 = PyInt_FromLong(1); if (unlikely(!__pyx_int_1)) __PYX_ERR(0, 1, __pyx_L1_error)
  __pyx_int_2 = PyInt_FromLong(2); if (unlikely(!__pyx_int_2)) __PYX_ERR(0, 1, __pyx_L1_error)
  __pyx_int_3 = PyInt_FromLong(3); if (unlikely(!__pyx_int_3)) __PYX_ERR(0, 1, __pyx_L1_error)
  __pyx_int_4 = PyInt_FromLong(4); if (unlikely(!__pyx_int_4)) __PYX_ERR(0, 1, __pyx_L1_error)
  __pyx_int_6 = PyInt_FromLong(6); if (unlikely(!__pyx_int_6)) __PYX_ERR(0, 1, __pyx_L1_error)
  __pyx_int_20 = PyInt_FromLong(20); if (unlikely(!__pyx_int_20)) __PYX_ERR(0, 1, __pyx_L1_error)
  __pyx_int_180 = PyInt_FromLong(180); if (unlikely(!__pyx_int_180)) __PYX_ERR(0, 1, __pyx_L1_error)
  return 0;
  __pyx_L1_error:;
  return -1;
}

#if PY_MAJOR_VERSION < 3
PyMODINIT_FUNC initroutercy(void); /*proto*/
PyMODINIT_FUNC initroutercy(void)
#else
PyMODINIT_FUNC PyInit_routercy(void); /*proto*/
PyMODINIT_FUNC PyInit_routercy(void)
#endif
{
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  int __pyx_t_4;
  __Pyx_RefNannyDeclarations
  #if CYTHON_REFNANNY
  __Pyx_RefNanny = __Pyx_RefNannyImportAPI("refnanny");
  if (!__Pyx_RefNanny) {
      PyErr_Clear();
      __Pyx_RefNanny = __Pyx_RefNannyImportAPI("Cython.Runtime.refnanny");
      if (!__Pyx_RefNanny)
          Py_FatalError("failed to import 'refnanny' module");
  }
  #endif
  __Pyx_RefNannySetupContext("PyMODINIT_FUNC PyInit_routercy(void)", 0);
  if (__Pyx_check_binary_version() < 0) __PYX_ERR(0, 1, __pyx_L1_error)
  __pyx_empty_tuple = PyTuple_New(0); if (unlikely(!__pyx_empty_tuple)) __PYX_ERR(0, 1, __pyx_L1_error)
  __pyx_empty_bytes = PyBytes_FromStringAndSize("", 0); if (unlikely(!__pyx_empty_bytes)) __PYX_ERR(0, 1, __pyx_L1_error)
  __pyx_empty_unicode = PyUnicode_FromStringAndSize("", 0); if (unlikely(!__pyx_empty_unicode)) __PYX_ERR(0, 1, __pyx_L1_error)
  #ifdef __Pyx_CyFunction_USED
  if (__pyx_CyFunction_init() < 0) __PYX_ERR(0, 1, __pyx_L1_error)
  #endif
  #ifdef __Pyx_FusedFunction_USED
  if (__pyx_FusedFunction_init() < 0) __PYX_ERR(0, 1, __pyx_L1_error)
  #endif
  #ifdef __Pyx_Coroutine_USED
  if (__pyx_Coroutine_init() < 0) __PYX_ERR(0, 1, __pyx_L1_error)
  #endif
  #ifdef __Pyx_Generator_USED
  if (__pyx_Generator_init() < 0) __PYX_ERR(0, 1, __pyx_L1_error)
  #endif
  #ifdef __Pyx_StopAsyncIteration_USED
  if (__pyx_StopAsyncIteration_init() < 0) __PYX_ERR(0, 1, __pyx_L1_error)
  #endif
  /*--- Library function declarations ---*/
  /*--- Threads initialization code ---*/
  #if defined(__PYX_FORCE_INIT_THREADS) && __PYX_FORCE_INIT_THREADS
  #ifdef WITH_THREAD /* Python build with threading support? */
  PyEval_InitThreads();
  #endif
  #endif
  /*--- Module creation code ---*/
  #if PY_MAJOR_VERSION < 3
  __pyx_m = Py_InitModule4("routercy", __pyx_methods, 0, 0, PYTHON_API_VERSION); Py_XINCREF(__pyx_m);
  #else
  __pyx_m = PyModule_Create(&__pyx_moduledef);
  #endif
  if (unlikely(!__pyx_m)) __PYX_ERR(0, 1, __pyx_L1_error)
  __pyx_d = PyModule_GetDict(__pyx_m); if (unlikely(!__pyx_d)) __PYX_ERR(0, 1, __pyx_L1_error)
  Py_INCREF(__pyx_d);
  __pyx_b = PyImport_AddModule(__Pyx_BUILTIN_MODULE_NAME); if (unlikely(!__pyx_b)) __PYX_ERR(0, 1, __pyx_L1_error)
  #if CYTHON_COMPILING_IN_PYPY
  Py_INCREF(__pyx_b);
  #endif
  if (PyObject_SetAttrString(__pyx_m, "__builtins__", __pyx_b) < 0) __PYX_ERR(0, 1, __pyx_L1_error);
  /*--- Initialize various global constants etc. ---*/
  if (__Pyx_InitGlobals() < 0) __PYX_ERR(0, 1, __pyx_L1_error)
  #if PY_MAJOR_VERSION < 3 && (__PYX_DEFAULT_STRING_ENCODING_IS_ASCII || __PYX_DEFAULT_STRING_ENCODING_IS_DEFAULT)
  if (__Pyx_init_sys_getdefaultencoding_params() < 0) __PYX_ERR(0, 1, __pyx_L1_error)
  #endif
  if (__pyx_module_is_main_volttron__platform__vip__router__routercy) {
    if (PyObject_SetAttrString(__pyx_m, "__name__", __pyx_n_s_main) < 0) __PYX_ERR(0, 1, __pyx_L1_error)
  }
  #if PY_MAJOR_VERSION >= 3
  {
    PyObject *modules = PyImport_GetModuleDict(); if (unlikely(!modules)) __PYX_ERR(0, 1, __pyx_L1_error)
    if (!PyDict_GetItemString(modules, "volttron.platform.vip.router.routercy")) {
      if (unlikely(PyDict_SetItemString(modules, "volttron.platform.vip.router.routercy", __pyx_m) < 0)) __PYX_ERR(0, 1, __pyx_L1_error)
    }
  }
  #endif
  /*--- Builtin init code ---*/
  if (__Pyx_InitCachedBuiltins() < 0) __PYX_ERR(0, 1, __pyx_L1_error)
  /*--- Constants init code ---*/
  if (__Pyx_InitCachedConstants() < 0) __PYX_ERR(0, 1, __pyx_L1_error)
  /*--- Global init code ---*/
  /*--- Variable export code ---*/
  /*--- Function export code ---*/
  /*--- Type init code ---*/
  __pyx_vtabptr_8volttron_8platform_3vip_6router_8routercy_BaseRouter = &__pyx_vtable_8volttron_8platform_3vip_6router_8routercy_BaseRouter;
  __pyx_vtable_8volttron_8platform_3vip_6router_8routercy_BaseRouter.run = (PyObject *(*)(struct __pyx_obj_8volttron_8platform_3vip_6router_8routercy_BaseRouter *, int __pyx_skip_dispatch))__pyx_f_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_run;
  __pyx_vtable_8volttron_8platform_3vip_6router_8routercy_BaseRouter.start = (PyObject *(*)(struct __pyx_obj_8volttron_8platform_3vip_6router_8routercy_BaseRouter *, int __pyx_skip_dispatch))__pyx_f_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_start;
  __pyx_vtable_8volttron_8platform_3vip_6router_8routercy_BaseRouter.stop = (PyObject *(*)(struct __pyx_obj_8volttron_8platform_3vip_6router_8routercy_BaseRouter *, int __pyx_skip_dispatch, struct __pyx_opt_args_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_stop *__pyx_optional_args))__pyx_f_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_stop;
  __pyx_vtable_8volttron_8platform_3vip_6router_8routercy_BaseRouter.setup = (PyObject *(*)(struct __pyx_obj_8volttron_8platform_3vip_6router_8routercy_BaseRouter *, int __pyx_skip_dispatch))__pyx_f_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_setup;
  __pyx_vtable_8volttron_8platform_3vip_6router_8routercy_BaseRouter.poll = (PyObject *(*)(struct __pyx_obj_8volttron_8platform_3vip_6router_8routercy_BaseRouter *, int __pyx_skip_dispatch))__pyx_f_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_poll;
  __pyx_vtable_8volttron_8platform_3vip_6router_8routercy_BaseRouter.handle_subsystem = (PyObject *(*)(struct __pyx_obj_8volttron_8platform_3vip_6router_8routercy_BaseRouter *, PyObject *, PyObject *, int __pyx_skip_dispatch))__pyx_f_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_handle_subsystem;
  __pyx_vtable_8volttron_8platform_3vip_6router_8routercy_BaseRouter.issue = (PyObject *(*)(struct __pyx_obj_8volttron_8platform_3vip_6router_8routercy_BaseRouter *, int, PyObject *, int __pyx_skip_dispatch, struct __pyx_opt_args_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_issue *__pyx_optional_args))__pyx_f_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_issue;
  __pyx_vtable_8volttron_8platform_3vip_6router_8routercy_BaseRouter._distribute = (PyObject *(*)(struct __pyx_obj_8volttron_8platform_3vip_6router_8routercy_BaseRouter *, PyObject *, PyObject *, std::string))__pyx_f_8volttron_8platform_3vip_6router_8routercy_10BaseRouter__distribute;
  __pyx_vtable_8volttron_8platform_3vip_6router_8routercy_BaseRouter._add_peer = (PyObject *(*)(struct __pyx_obj_8volttron_8platform_3vip_6router_8routercy_BaseRouter *, std::string, int __pyx_skip_dispatch))__pyx_f_8volttron_8platform_3vip_6router_8routercy_10BaseRouter__add_peer;
  __pyx_vtable_8volttron_8platform_3vip_6router_8routercy_BaseRouter._drop_peer = (PyObject *(*)(struct __pyx_obj_8volttron_8platform_3vip_6router_8routercy_BaseRouter *, std::string, int __pyx_skip_dispatch))__pyx_f_8volttron_8platform_3vip_6router_8routercy_10BaseRouter__drop_peer;
  __pyx_vtable_8volttron_8platform_3vip_6router_8routercy_BaseRouter.route = (PyObject *(*)(struct __pyx_obj_8volttron_8platform_3vip_6router_8routercy_BaseRouter *, int __pyx_skip_dispatch))__pyx_f_8volttron_8platform_3vip_6router_8routercy_10BaseRouter_route;
  __pyx_vtable_8volttron_8platform_3vip_6router_8routercy_BaseRouter._send = (struct __pyx_obj_8volttron_8platform_3vip_6router_5queue_Queue *(*)(struct __pyx_obj_8volttron_8platform_3vip_6router_8routercy_BaseRouter *, struct __pyx_obj_8volttron_8platform_3vip_6router_5queue_Queue *, int __pyx_skip_dispatch))__pyx_f_8volttron_8platform_3vip_6router_8routercy_10BaseRouter__send;
  if (PyType_Ready(&__pyx_type_8volttron_8platform_3vip_6router_8routercy_BaseRouter) < 0) __PYX_ERR(0, 28, __pyx_L1_error)
  __pyx_type_8volttron_8platform_3vip_6router_8routercy_BaseRouter.tp_print = 0;
  if (__Pyx_SetVtable(__pyx_type_8volttron_8platform_3vip_6router_8routercy_BaseRouter.tp_dict, __pyx_vtabptr_8volttron_8platform_3vip_6router_8routercy_BaseRouter) < 0) __PYX_ERR(0, 28, __pyx_L1_error)
  if (PyObject_SetAttrString(__pyx_m, "BaseRouter", (PyObject *)&__pyx_type_8volttron_8platform_3vip_6router_8routercy_BaseRouter) < 0) __PYX_ERR(0, 28, __pyx_L1_error)
  __pyx_ptype_8volttron_8platform_3vip_6router_8routercy_BaseRouter = &__pyx_type_8volttron_8platform_3vip_6router_8routercy_BaseRouter;
  /*--- Type import code ---*/
  __pyx_ptype_8volttron_8platform_3vip_6router_5queue_Queue = __Pyx_ImportType("volttron.platform.vip.router.queue", "Queue", sizeof(struct __pyx_obj_8volttron_8platform_3vip_6router_5queue_Queue), 1); if (unlikely(!__pyx_ptype_8volttron_8platform_3vip_6router_5queue_Queue)) __PYX_ERR(4, 5, __pyx_L1_error)
  __pyx_vtabptr_8volttron_8platform_3vip_6router_5queue_Queue = (struct __pyx_vtabstruct_8volttron_8platform_3vip_6router_5queue_Queue*)__Pyx_GetVtable(__pyx_ptype_8volttron_8platform_3vip_6router_5queue_Queue->tp_dict); if (unlikely(!__pyx_vtabptr_8volttron_8platform_3vip_6router_5queue_Queue)) __PYX_ERR(4, 5, __pyx_L1_error)
  __pyx_ptype_3zmq_7backend_6cython_7context_Context = __Pyx_ImportType("zmq.backend.cython.context", "Context", sizeof(struct __pyx_obj_3zmq_7backend_6cython_7context_Context), 1); if (unlikely(!__pyx_ptype_3zmq_7backend_6cython_7context_Context)) __PYX_ERR(5, 26, __pyx_L1_error)
  __pyx_vtabptr_3zmq_7backend_6cython_7context_Context = (struct __pyx_vtabstruct_3zmq_7backend_6cython_7context_Context*)__Pyx_GetVtable(__pyx_ptype_3zmq_7backend_6cython_7context_Context->tp_dict); if (unlikely(!__pyx_vtabptr_3zmq_7backend_6cython_7context_Context)) __PYX_ERR(5, 26, __pyx_L1_error)
  __pyx_ptype_3zmq_7backend_6cython_6socket_Socket = __Pyx_ImportType("zmq.backend.cython.socket", "Socket", sizeof(struct __pyx_obj_3zmq_7backend_6cython_6socket_Socket), 1); if (unlikely(!__pyx_ptype_3zmq_7backend_6cython_6socket_Socket)) __PYX_ERR(6, 33, __pyx_L1_error)
  __pyx_vtabptr_3zmq_7backend_6cython_6socket_Socket = (struct __pyx_vtabstruct_3zmq_7backend_6cython_6socket_Socket*)__Pyx_GetVtable(__pyx_ptype_3zmq_7backend_6cython_6socket_Socket->tp_dict); if (unlikely(!__pyx_vtabptr_3zmq_7backend_6cython_6socket_Socket)) __PYX_ERR(6, 33, __pyx_L1_error)
  __pyx_ptype_8volttron_8platform_3vip_6router_8cysocket_Socket = __Pyx_ImportType("volttron.platform.vip.router.cysocket", "Socket", sizeof(struct __pyx_obj_8volttron_8platform_3vip_6router_8cysocket_Socket), 1); if (unlikely(!__pyx_ptype_8volttron_8platform_3vip_6router_8cysocket_Socket)) __PYX_ERR(7, 32, __pyx_L1_error)
  __pyx_vtabptr_8volttron_8platform_3vip_6router_8cysocket_Socket = (struct __pyx_vtabstruct_8volttron_8platform_3vip_6router_8cysocket_Socket*)__Pyx_GetVtable(__pyx_ptype_8volttron_8platform_3vip_6router_8cysocket_Socket->tp_dict); if (unlikely(!__pyx_vtabptr_8volttron_8platform_3vip_6router_8cysocket_Socket)) __PYX_ERR(7, 32, __pyx_L1_error)
  __pyx_ptype_7cpython_4type_type = __Pyx_ImportType(__Pyx_BUILTIN_MODULE_NAME, "type", 
  #if CYTHON_COMPILING_IN_PYPY
  sizeof(PyTypeObject),
  #else
  sizeof(PyHeapTypeObject),
  #endif
  0); if (unlikely(!__pyx_ptype_7cpython_4type_type)) __PYX_ERR(8, 9, __pyx_L1_error)
  __pyx_ptype_7cpython_4bool_bool = __Pyx_ImportType(__Pyx_BUILTIN_MODULE_NAME, "bool", sizeof(PyBoolObject), 0); if (unlikely(!__pyx_ptype_7cpython_4bool_bool)) __PYX_ERR(9, 8, __pyx_L1_error)
  __pyx_ptype_7cpython_7complex_complex = __Pyx_ImportType(__Pyx_BUILTIN_MODULE_NAME, "complex", sizeof(PyComplexObject), 0); if (unlikely(!__pyx_ptype_7cpython_7complex_complex)) __PYX_ERR(10, 15, __pyx_L1_error)
  __pyx_ptype_8volttron_8platform_3vip_6router_9cymessage_Frame = __Pyx_ImportType("volttron.platform.vip.router.cymessage", "Frame", sizeof(struct __pyx_obj_8volttron_8platform_3vip_6router_9cymessage_Frame), 1); if (unlikely(!__pyx_ptype_8volttron_8platform_3vip_6router_9cymessage_Frame)) __PYX_ERR(2, 34, __pyx_L1_error)
  __pyx_vtabptr_8volttron_8platform_3vip_6router_9cymessage_Frame = (struct __pyx_vtabstruct_8volttron_8platform_3vip_6router_9cymessage_Frame*)__Pyx_GetVtable(__pyx_ptype_8volttron_8platform_3vip_6router_9cymessage_Frame->tp_dict); if (unlikely(!__pyx_vtabptr_8volttron_8platform_3vip_6router_9cymessage_Frame)) __PYX_ERR(2, 34, __pyx_L1_error)
  /*--- Variable import code ---*/
  /*--- Function import code ---*/
  /*--- Execution code ---*/
  #if defined(__Pyx_Generator_USED) || defined(__Pyx_Coroutine_USED)
  if (__Pyx_patch_abc() < 0) __PYX_ERR(0, 1, __pyx_L1_error)
  #endif

  /* "volttron/platform/vip/router/routercy.pyx":5
 * from libcpp.vector cimport vector
 * from cython.operator cimport dereference, preincrement
 * import os             # <<<<<<<<<<<<<<
 * import uuid
 * import logging
 */
  __pyx_t_1 = __Pyx_Import(__pyx_n_s_os, 0, -1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 5, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_os, __pyx_t_1) < 0) __PYX_ERR(0, 5, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "volttron/platform/vip/router/routercy.pyx":6
 * from cython.operator cimport dereference, preincrement
 * import os
 * import uuid             # <<<<<<<<<<<<<<
 * import logging
 * from logging import handlers
 */
  __pyx_t_1 = __Pyx_Import(__pyx_n_s_uuid, 0, -1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 6, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_uuid, __pyx_t_1) < 0) __PYX_ERR(0, 6, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "volttron/platform/vip/router/routercy.pyx":7
 * import os
 * import uuid
 * import logging             # <<<<<<<<<<<<<<
 * from logging import handlers
 * import logging.config
 */
  __pyx_t_1 = __Pyx_Import(__pyx_n_s_logging, 0, -1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 7, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_logging, __pyx_t_1) < 0) __PYX_ERR(0, 7, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "volttron/platform/vip/router/routercy.pyx":8
 * import uuid
 * import logging
 * from logging import handlers             # <<<<<<<<<<<<<<
 * import logging.config
 * from zmq.utils.buffers cimport asbuffer_r
 */
  __pyx_t_1 = PyList_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 8, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_INCREF(__pyx_n_s_handlers);
  __Pyx_GIVEREF(__pyx_n_s_handlers);
  PyList_SET_ITEM(__pyx_t_1, 0, __pyx_n_s_handlers);
  __pyx_t_2 = __Pyx_Import(__pyx_n_s_logging, __pyx_t_1, -1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 8, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_ImportFrom(__pyx_t_2, __pyx_n_s_handlers); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 8, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_handlers, __pyx_t_1) < 0) __PYX_ERR(0, 8, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "volttron/platform/vip/router/routercy.pyx":9
 * import logging
 * from logging import handlers
 * import logging.config             # <<<<<<<<<<<<<<
 * from zmq.utils.buffers cimport asbuffer_r
 * import sys
 */
  __pyx_t_2 = __Pyx_Import(__pyx_n_s_logging_config, 0, -1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 9, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_logging, __pyx_t_2) < 0) __PYX_ERR(0, 9, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "volttron/platform/vip/router/routercy.pyx":11
 * import logging.config
 * from zmq.utils.buffers cimport asbuffer_r
 * import sys             # <<<<<<<<<<<<<<
 * 
 * from zmq.utils import*
 */
  __pyx_t_2 = __Pyx_Import(__pyx_n_s_sys, 0, -1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 11, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_sys, __pyx_t_2) < 0) __PYX_ERR(0, 11, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "volttron/platform/vip/router/routercy.pyx":13
 * import sys
 * 
 * from zmq.utils import*             # <<<<<<<<<<<<<<
 * import zmq
 * from zmq import NOBLOCK, ZMQError, EINVAL, EHOSTUNREACH
 */
  __pyx_t_2 = PyList_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 13, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_INCREF(__pyx_n_s__22);
  __Pyx_GIVEREF(__pyx_n_s__22);
  PyList_SET_ITEM(__pyx_t_2, 0, __pyx_n_s__22);
  __pyx_t_1 = __Pyx_Import(__pyx_n_s_zmq_utils, __pyx_t_2, -1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 13, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  if (__pyx_import_star(__pyx_t_1) < 0) __PYX_ERR(0, 13, __pyx_L1_error);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "volttron/platform/vip/router/routercy.pyx":14
 * 
 * from zmq.utils import*
 * import zmq             # <<<<<<<<<<<<<<
 * from zmq import NOBLOCK, ZMQError, EINVAL, EHOSTUNREACH
 * 
 */
  __pyx_t_1 = __Pyx_Import(__pyx_n_s_zmq, 0, -1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 14, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_zmq, __pyx_t_1) < 0) __PYX_ERR(0, 14, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "volttron/platform/vip/router/routercy.pyx":15
 * from zmq.utils import*
 * import zmq
 * from zmq import NOBLOCK, ZMQError, EINVAL, EHOSTUNREACH             # <<<<<<<<<<<<<<
 * 
 * from cysocket cimport Socket as CySocket
 */
  __pyx_t_1 = PyList_New(4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 15, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_INCREF(__pyx_n_s_NOBLOCK);
  __Pyx_GIVEREF(__pyx_n_s_NOBLOCK);
  PyList_SET_ITEM(__pyx_t_1, 0, __pyx_n_s_NOBLOCK);
  __Pyx_INCREF(__pyx_n_s_ZMQError);
  __Pyx_GIVEREF(__pyx_n_s_ZMQError);
  PyList_SET_ITEM(__pyx_t_1, 1, __pyx_n_s_ZMQError);
  __Pyx_INCREF(__pyx_n_s_EINVAL);
  __Pyx_GIVEREF(__pyx_n_s_EINVAL);
  PyList_SET_ITEM(__pyx_t_1, 2, __pyx_n_s_EINVAL);
  __Pyx_INCREF(__pyx_n_s_EHOSTUNREACH);
  __Pyx_GIVEREF(__pyx_n_s_EHOSTUNREACH);
  PyList_SET_ITEM(__pyx_t_1, 3, __pyx_n_s_EHOSTUNREACH);
  __pyx_t_2 = __Pyx_Import(__pyx_n_s_zmq, __pyx_t_1, -1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 15, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_ImportFrom(__pyx_t_2, __pyx_n_s_NOBLOCK); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 15, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_NOBLOCK, __pyx_t_1) < 0) __PYX_ERR(0, 15, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_ImportFrom(__pyx_t_2, __pyx_n_s_ZMQError); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 15, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_ZMQError, __pyx_t_1) < 0) __PYX_ERR(0, 15, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_ImportFrom(__pyx_t_2, __pyx_n_s_EINVAL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 15, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_EINVAL, __pyx_t_1) < 0) __PYX_ERR(0, 15, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_ImportFrom(__pyx_t_2, __pyx_n_s_EHOSTUNREACH); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 15, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_EHOSTUNREACH, __pyx_t_1) < 0) __PYX_ERR(0, 15, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "volttron/platform/vip/router/routercy.pyx":23
 * 
 * 
 * OUTGOING = 0             # <<<<<<<<<<<<<<
 * INCOMING = 1
 * UNROUTABLE = 2
 */
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_OUTGOING, __pyx_int_0) < 0) __PYX_ERR(0, 23, __pyx_L1_error)

  /* "volttron/platform/vip/router/routercy.pyx":24
 * 
 * OUTGOING = 0
 * INCOMING = 1             # <<<<<<<<<<<<<<
 * UNROUTABLE = 2
 * ERROR = 3
 */
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_INCOMING, __pyx_int_1) < 0) __PYX_ERR(0, 24, __pyx_L1_error)

  /* "volttron/platform/vip/router/routercy.pyx":25
 * OUTGOING = 0
 * INCOMING = 1
 * UNROUTABLE = 2             # <<<<<<<<<<<<<<
 * ERROR = 3
 * 
 */
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_UNROUTABLE, __pyx_int_2) < 0) __PYX_ERR(0, 25, __pyx_L1_error)

  /* "volttron/platform/vip/router/routercy.pyx":26
 * INCOMING = 1
 * UNROUTABLE = 2
 * ERROR = 3             # <<<<<<<<<<<<<<
 * 
 * cdef class BaseRouter:
 */
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_ERROR, __pyx_int_3) < 0) __PYX_ERR(0, 26, __pyx_L1_error)

  /* "volttron/platform/vip/router/routercy.pyx":43
 *     '''
 *     #_socket_class = zmq.Socket
 *     _socket_class = CySocket             # <<<<<<<<<<<<<<
 * 
 *     def __cinit__(self, context=None, default_user_id=None, **kwargs):
 */
  if (PyDict_SetItem((PyObject *)__pyx_ptype_8volttron_8platform_3vip_6router_8routercy_BaseRouter->tp_dict, __pyx_n_s_socket_class, ((PyObject *)__pyx_ptype_8volttron_8platform_3vip_6router_8cysocket_Socket)) < 0) __PYX_ERR(0, 43, __pyx_L1_error)
  PyType_Modified(__pyx_ptype_8volttron_8platform_3vip_6router_8routercy_BaseRouter);

  /* "volttron/platform/vip/router/routercy.pyx":134
 *         pass
 * 
 *     if zmq.zmq_version_info() >= (4, 1, 0):             # <<<<<<<<<<<<<<
 *         def lookup_user_id(self, sender, recipient, auth_token):
 *             '''Find and return a user identifier.
 */
  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_zmq); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 134, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zmq_version_info); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 134, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_3))) {
    __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_3);
    if (likely(__pyx_t_1)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
      __Pyx_INCREF(__pyx_t_1);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_3, function);
    }
  }
  if (__pyx_t_1) {
    __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 134, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  } else {
    __pyx_t_2 = __Pyx_PyObject_CallNoArg(__pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 134, __pyx_L1_error)
  }
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = PyObject_RichCompare(__pyx_t_2, __pyx_tuple__23, Py_GE); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 134, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 134, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  if (__pyx_t_4) {

    /* "volttron/platform/vip/router/routercy.pyx":135
 * 
 *     if zmq.zmq_version_info() >= (4, 1, 0):
 *         def lookup_user_id(self, sender, recipient, auth_token):             # <<<<<<<<<<<<<<
 *             '''Find and return a user identifier.
 * 
 */
    goto __pyx_L2;
  }

  /* "volttron/platform/vip/router/routercy.pyx":151
 *             return self.default_user_id
 *     else:
 *         def lookup_user_id(self, sender, recipient, auth_token):             # <<<<<<<<<<<<<<
 *             '''Find and return a user identifier.
 * 
 */
  /*else*/ {
  }
  __pyx_L2:;

  /* "volttron/platform/vip/router/routercy.pyx":1
 * from libcpp.string cimport string             # <<<<<<<<<<<<<<
 * from libcpp.set cimport set
 * from libcpp.vector cimport vector
 */
  __pyx_t_3 = PyDict_New(); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_test, __pyx_t_3) < 0) __PYX_ERR(0, 1, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

  /* "set.to_py":144
 * 
 * @cname("__pyx_convert_set_to_py_std_3a__3a_string")
 * cdef object __pyx_convert_set_to_py_std_3a__3a_string(const cpp_set[X]& s):             # <<<<<<<<<<<<<<
 *     o = set()
 *     cdef cpp_set[X].const_iterator iter = s.begin()
 */

  /*--- Wrapped vars code ---*/

  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  if (__pyx_m) {
    if (__pyx_d) {
      __Pyx_AddTraceback("init volttron.platform.vip.router.routercy", __pyx_clineno, __pyx_lineno, __pyx_filename);
    }
    Py_DECREF(__pyx_m); __pyx_m = 0;
  } else if (!PyErr_Occurred()) {
    PyErr_SetString(PyExc_ImportError, "init volttron.platform.vip.router.routercy");
  }
  __pyx_L0:;
  __Pyx_RefNannyFinishContext();
  #if PY_MAJOR_VERSION < 3
  return;
  #else
  return __pyx_m;
  #endif
}

/* --- Runtime support code --- */
/* Refnanny */
#if CYTHON_REFNANNY
static __Pyx_RefNannyAPIStruct *__Pyx_RefNannyImportAPI(const char *modname) {
    PyObject *m = NULL, *p = NULL;
    void *r = NULL;
    m = PyImport_ImportModule((char *)modname);
    if (!m) goto end;
    p = PyObject_GetAttrString(m, (char *)"RefNannyAPI");
    if (!p) goto end;
    r = PyLong_AsVoidPtr(p);
end:
    Py_XDECREF(p);
    Py_XDECREF(m);
    return (__Pyx_RefNannyAPIStruct *)r;
}
#endif

/* GetBuiltinName */
static PyObject *__Pyx_GetBuiltinName(PyObject *name) {
    PyObject* result = __Pyx_PyObject_GetAttrStr(__pyx_b, name);
    if (unlikely(!result)) {
        PyErr_Format(PyExc_NameError,
#if PY_MAJOR_VERSION >= 3
            "name '%U' is not defined", name);
#else
            "name '%.200s' is not defined", PyString_AS_STRING(name));
#endif
    }
    return result;
}

/* RaiseDoubleKeywords */
static void __Pyx_RaiseDoubleKeywordsError(
    const char* func_name,
    PyObject* kw_name)
{
    PyErr_Format(PyExc_TypeError,
        #if PY_MAJOR_VERSION >= 3
        "%s() got multiple values for keyword argument '%U'", func_name, kw_name);
        #else
        "%s() got multiple values for keyword argument '%s'", func_name,
        PyString_AsString(kw_name));
        #endif
}

/* ParseKeywords */
static int __Pyx_ParseOptionalKeywords(
    PyObject *kwds,
    PyObject **argnames[],
    PyObject *kwds2,
    PyObject *values[],
    Py_ssize_t num_pos_args,
    const char* function_name)
{
    PyObject *key = 0, *value = 0;
    Py_ssize_t pos = 0;
    PyObject*** name;
    PyObject*** first_kw_arg = argnames + num_pos_args;
    while (PyDict_Next(kwds, &pos, &key, &value)) {
        name = first_kw_arg;
        while (*name && (**name != key)) name++;
        if (*name) {
            values[name-argnames] = value;
            continue;
        }
        name = first_kw_arg;
        #if PY_MAJOR_VERSION < 3
        if (likely(PyString_CheckExact(key)) || likely(PyString_Check(key))) {
            while (*name) {
                if ((CYTHON_COMPILING_IN_PYPY || PyString_GET_SIZE(**name) == PyString_GET_SIZE(key))
                        && _PyString_Eq(**name, key)) {
                    values[name-argnames] = value;
                    break;
                }
                name++;
            }
            if (*name) continue;
            else {
                PyObject*** argname = argnames;
                while (argname != first_kw_arg) {
                    if ((**argname == key) || (
                            (CYTHON_COMPILING_IN_PYPY || PyString_GET_SIZE(**argname) == PyString_GET_SIZE(key))
                             && _PyString_Eq(**argname, key))) {
                        goto arg_passed_twice;
                    }
                    argname++;
                }
            }
        } else
        #endif
        if (likely(PyUnicode_Check(key))) {
            while (*name) {
                int cmp = (**name == key) ? 0 :
                #if !CYTHON_COMPILING_IN_PYPY && PY_MAJOR_VERSION >= 3
                    (PyUnicode_GET_SIZE(**name) != PyUnicode_GET_SIZE(key)) ? 1 :
                #endif
                    PyUnicode_Compare(**name, key);
                if (cmp < 0 && unlikely(PyErr_Occurred())) goto bad;
                if (cmp == 0) {
                    values[name-argnames] = value;
                    break;
                }
                name++;
            }
            if (*name) continue;
            else {
                PyObject*** argname = argnames;
                while (argname != first_kw_arg) {
                    int cmp = (**argname == key) ? 0 :
                    #if !CYTHON_COMPILING_IN_PYPY && PY_MAJOR_VERSION >= 3
                        (PyUnicode_GET_SIZE(**argname) != PyUnicode_GET_SIZE(key)) ? 1 :
                    #endif
                        PyUnicode_Compare(**argname, key);
                    if (cmp < 0 && unlikely(PyErr_Occurred())) goto bad;
                    if (cmp == 0) goto arg_passed_twice;
                    argname++;
                }
            }
        } else
            goto invalid_keyword_type;
        if (kwds2) {
            if (unlikely(PyDict_SetItem(kwds2, key, value))) goto bad;
        } else {
            goto invalid_keyword;
        }
    }
    return 0;
arg_passed_twice:
    __Pyx_RaiseDoubleKeywordsError(function_name, key);
    goto bad;
invalid_keyword_type:
    PyErr_Format(PyExc_TypeError,
        "%.200s() keywords must be strings", function_name);
    goto bad;
invalid_keyword:
    PyErr_Format(PyExc_TypeError,
    #if PY_MAJOR_VERSION < 3
        "%.200s() got an unexpected keyword argument '%.200s'",
        function_name, PyString_AsString(key));
    #else
        "%s() got an unexpected keyword argument '%U'",
        function_name, key);
    #endif
bad:
    return -1;
}

/* RaiseArgTupleInvalid */
static void __Pyx_RaiseArgtupleInvalid(
    const char* func_name,
    int exact,
    Py_ssize_t num_min,
    Py_ssize_t num_max,
    Py_ssize_t num_found)
{
    Py_ssize_t num_expected;
    const char *more_or_less;
    if (num_found < num_min) {
        num_expected = num_min;
        more_or_less = "at least";
    } else {
        num_expected = num_max;
        more_or_less = "at most";
    }
    if (exact) {
        more_or_less = "exactly";
    }
    PyErr_Format(PyExc_TypeError,
                 "%.200s() takes %.8s %" CYTHON_FORMAT_SSIZE_T "d positional argument%.1s (%" CYTHON_FORMAT_SSIZE_T "d given)",
                 func_name, more_or_less, num_expected,
                 (num_expected == 1) ? "" : "s", num_found);
}

/* GetModuleGlobalName */
static CYTHON_INLINE PyObject *__Pyx_GetModuleGlobalName(PyObject *name) {
    PyObject *result;
#if CYTHON_COMPILING_IN_CPYTHON
    result = PyDict_GetItem(__pyx_d, name);
    if (likely(result)) {
        Py_INCREF(result);
    } else {
#else
    result = PyObject_GetItem(__pyx_d, name);
    if (!result) {
        PyErr_Clear();
#endif
        result = __Pyx_GetBuiltinName(name);
    }
    return result;
}

/* PyObjectCall */
  #if CYTHON_COMPILING_IN_CPYTHON
static CYTHON_INLINE PyObject* __Pyx_PyObject_Call(PyObject *func, PyObject *arg, PyObject *kw) {
    PyObject *result;
    ternaryfunc call = func->ob_type->tp_call;
    if (unlikely(!call))
        return PyObject_Call(func, arg, kw);
    if (unlikely(Py_EnterRecursiveCall((char*)" while calling a Python object")))
        return NULL;
    result = (*call)(func, arg, kw);
    Py_LeaveRecursiveCall();
    if (unlikely(!result) && unlikely(!PyErr_Occurred())) {
        PyErr_SetString(
            PyExc_SystemError,
            "NULL result without error in PyObject_Call");
    }
    return result;
}
#endif

/* PyObjectCallMethO */
  #if CYTHON_COMPILING_IN_CPYTHON
static CYTHON_INLINE PyObject* __Pyx_PyObject_CallMethO(PyObject *func, PyObject *arg) {
    PyObject *self, *result;
    PyCFunction cfunc;
    cfunc = PyCFunction_GET_FUNCTION(func);
    self = PyCFunction_GET_SELF(func);
    if (unlikely(Py_EnterRecursiveCall((char*)" while calling a Python object")))
        return NULL;
    result = cfunc(self, arg);
    Py_LeaveRecursiveCall();
    if (unlikely(!result) && unlikely(!PyErr_Occurred())) {
        PyErr_SetString(
            PyExc_SystemError,
            "NULL result without error in PyObject_Call");
    }
    return result;
}
#endif

/* PyObjectCallOneArg */
  #if CYTHON_COMPILING_IN_CPYTHON
static PyObject* __Pyx__PyObject_CallOneArg(PyObject *func, PyObject *arg) {
    PyObject *result;
    PyObject *args = PyTuple_New(1);
    if (unlikely(!args)) return NULL;
    Py_INCREF(arg);
    PyTuple_SET_ITEM(args, 0, arg);
    result = __Pyx_PyObject_Call(func, args, NULL);
    Py_DECREF(args);
    return result;
}
static CYTHON_INLINE PyObject* __Pyx_PyObject_CallOneArg(PyObject *func, PyObject *arg) {
#ifdef __Pyx_CyFunction_USED
    if (likely(PyCFunction_Check(func) || PyObject_TypeCheck(func, __pyx_CyFunctionType))) {
#else
    if (likely(PyCFunction_Check(func))) {
#endif
        if (likely(PyCFunction_GET_FLAGS(func) & METH_O)) {
            return __Pyx_PyObject_CallMethO(func, arg);
        }
    }
    return __Pyx__PyObject_CallOneArg(func, arg);
}
#else
static CYTHON_INLINE PyObject* __Pyx_PyObject_CallOneArg(PyObject *func, PyObject *arg) {
    PyObject *result;
    PyObject *args = PyTuple_Pack(1, arg);
    if (unlikely(!args)) return NULL;
    result = __Pyx_PyObject_Call(func, args, NULL);
    Py_DECREF(args);
    return result;
}
#endif

/* PyObjectCallNoArg */
    #if CYTHON_COMPILING_IN_CPYTHON
static CYTHON_INLINE PyObject* __Pyx_PyObject_CallNoArg(PyObject *func) {
#ifdef __Pyx_CyFunction_USED
    if (likely(PyCFunction_Check(func) || PyObject_TypeCheck(func, __pyx_CyFunctionType))) {
#else
    if (likely(PyCFunction_Check(func))) {
#endif
        if (likely(PyCFunction_GET_FLAGS(func) & METH_NOARGS)) {
            return __Pyx_PyObject_CallMethO(func, NULL);
        }
    }
    return __Pyx_PyObject_Call(func, __pyx_empty_tuple, NULL);
}
#endif

/* PyErrFetchRestore */
      #if CYTHON_COMPILING_IN_CPYTHON
static CYTHON_INLINE void __Pyx_ErrRestoreInState(PyThreadState *tstate, PyObject *type, PyObject *value, PyObject *tb) {
    PyObject *tmp_type, *tmp_value, *tmp_tb;
    tmp_type = tstate->curexc_type;
    tmp_value = tstate->curexc_value;
    tmp_tb = tstate->curexc_traceback;
    tstate->curexc_type = type;
    tstate->curexc_value = value;
    tstate->curexc_traceback = tb;
    Py_XDECREF(tmp_type);
    Py_XDECREF(tmp_value);
    Py_XDECREF(tmp_tb);
}
static CYTHON_INLINE void __Pyx_ErrFetchInState(PyThreadState *tstate, PyObject **type, PyObject **value, PyObject **tb) {
    *type = tstate->curexc_type;
    *value = tstate->curexc_value;
    *tb = tstate->curexc_traceback;
    tstate->curexc_type = 0;
    tstate->curexc_value = 0;
    tstate->curexc_traceback = 0;
}
#endif

/* GetException */
      #if CYTHON_COMPILING_IN_CPYTHON
static int __Pyx__GetException(PyThreadState *tstate, PyObject **type, PyObject **value, PyObject **tb) {
#else
static int __Pyx_GetException(PyObject **type, PyObject **value, PyObject **tb) {
#endif
    PyObject *local_type, *local_value, *local_tb;
#if CYTHON_COMPILING_IN_CPYTHON
    PyObject *tmp_type, *tmp_value, *tmp_tb;
    local_type = tstate->curexc_type;
    local_value = tstate->curexc_value;
    local_tb = tstate->curexc_traceback;
    tstate->curexc_type = 0;
    tstate->curexc_value = 0;
    tstate->curexc_traceback = 0;
#else
    PyErr_Fetch(&local_type, &local_value, &local_tb);
#endif
    PyErr_NormalizeException(&local_type, &local_value, &local_tb);
#if CYTHON_COMPILING_IN_CPYTHON
    if (unlikely(tstate->curexc_type))
#else
    if (unlikely(PyErr_Occurred()))
#endif
        goto bad;
    #if PY_MAJOR_VERSION >= 3
    if (local_tb) {
        if (unlikely(PyException_SetTraceback(local_value, local_tb) < 0))
            goto bad;
    }
    #endif
    Py_XINCREF(local_tb);
    Py_XINCREF(local_type);
    Py_XINCREF(local_value);
    *type = local_type;
    *value = local_value;
    *tb = local_tb;
#if CYTHON_COMPILING_IN_CPYTHON
    tmp_type = tstate->exc_type;
    tmp_value = tstate->exc_value;
    tmp_tb = tstate->exc_traceback;
    tstate->exc_type = local_type;
    tstate->exc_value = local_value;
    tstate->exc_traceback = local_tb;
    Py_XDECREF(tmp_type);
    Py_XDECREF(tmp_value);
    Py_XDECREF(tmp_tb);
#else
    PyErr_SetExcInfo(local_type, local_value, local_tb);
#endif
    return 0;
bad:
    *type = 0;
    *value = 0;
    *tb = 0;
    Py_XDECREF(local_type);
    Py_XDECREF(local_value);
    Py_XDECREF(local_tb);
    return -1;
}

/* SwapException */
        #if CYTHON_COMPILING_IN_CPYTHON
static CYTHON_INLINE void __Pyx__ExceptionSwap(PyThreadState *tstate, PyObject **type, PyObject **value, PyObject **tb) {
    PyObject *tmp_type, *tmp_value, *tmp_tb;
    tmp_type = tstate->exc_type;
    tmp_value = tstate->exc_value;
    tmp_tb = tstate->exc_traceback;
    tstate->exc_type = *type;
    tstate->exc_value = *value;
    tstate->exc_traceback = *tb;
    *type = tmp_type;
    *value = tmp_value;
    *tb = tmp_tb;
}
#else
static CYTHON_INLINE void __Pyx_ExceptionSwap(PyObject **type, PyObject **value, PyObject **tb) {
    PyObject *tmp_type, *tmp_value, *tmp_tb;
    PyErr_GetExcInfo(&tmp_type, &tmp_value, &tmp_tb);
    PyErr_SetExcInfo(*type, *value, *tb);
    *type = tmp_type;
    *value = tmp_value;
    *tb = tmp_tb;
}
#endif

/* SaveResetException */
        #if CYTHON_COMPILING_IN_CPYTHON
static CYTHON_INLINE void __Pyx__ExceptionSave(PyThreadState *tstate, PyObject **type, PyObject **value, PyObject **tb) {
    *type = tstate->exc_type;
    *value = tstate->exc_value;
    *tb = tstate->exc_traceback;
    Py_XINCREF(*type);
    Py_XINCREF(*value);
    Py_XINCREF(*tb);
}
static CYTHON_INLINE void __Pyx__ExceptionReset(PyThreadState *tstate, PyObject *type, PyObject *value, PyObject *tb) {
    PyObject *tmp_type, *tmp_value, *tmp_tb;
    tmp_type = tstate->exc_type;
    tmp_value = tstate->exc_value;
    tmp_tb = tstate->exc_traceback;
    tstate->exc_type = type;
    tstate->exc_value = value;
    tstate->exc_traceback = tb;
    Py_XDECREF(tmp_type);
    Py_XDECREF(tmp_value);
    Py_XDECREF(tmp_tb);
}
#endif

/* ExtTypeTest */
        static CYTHON_INLINE int __Pyx_TypeTest(PyObject *obj, PyTypeObject *type) {
    if (unlikely(!type)) {
        PyErr_SetString(PyExc_SystemError, "Missing type object");
        return 0;
    }
    if (likely(PyObject_TypeCheck(obj, type)))
        return 1;
    PyErr_Format(PyExc_TypeError, "Cannot convert %.200s to %.200s",
                 Py_TYPE(obj)->tp_name, type->tp_name);
    return 0;
}

/* RaiseException */
        #if PY_MAJOR_VERSION < 3
static void __Pyx_Raise(PyObject *type, PyObject *value, PyObject *tb,
                        CYTHON_UNUSED PyObject *cause) {
    __Pyx_PyThreadState_declare
    Py_XINCREF(type);
    if (!value || value == Py_None)
        value = NULL;
    else
        Py_INCREF(value);
    if (!tb || tb == Py_None)
        tb = NULL;
    else {
        Py_INCREF(tb);
        if (!PyTraceBack_Check(tb)) {
            PyErr_SetString(PyExc_TypeError,
                "raise: arg 3 must be a traceback or None");
            goto raise_error;
        }
    }
    if (PyType_Check(type)) {
#if CYTHON_COMPILING_IN_PYPY
        if (!value) {
            Py_INCREF(Py_None);
            value = Py_None;
        }
#endif
        PyErr_NormalizeException(&type, &value, &tb);
    } else {
        if (value) {
            PyErr_SetString(PyExc_TypeError,
                "instance exception may not have a separate value");
            goto raise_error;
        }
        value = type;
        type = (PyObject*) Py_TYPE(type);
        Py_INCREF(type);
        if (!PyType_IsSubtype((PyTypeObject *)type, (PyTypeObject *)PyExc_BaseException)) {
            PyErr_SetString(PyExc_TypeError,
                "raise: exception class must be a subclass of BaseException");
            goto raise_error;
        }
    }
    __Pyx_PyThreadState_assign
    __Pyx_ErrRestore(type, value, tb);
    return;
raise_error:
    Py_XDECREF(value);
    Py_XDECREF(type);
    Py_XDECREF(tb);
    return;
}
#else
static void __Pyx_Raise(PyObject *type, PyObject *value, PyObject *tb, PyObject *cause) {
    PyObject* owned_instance = NULL;
    if (tb == Py_None) {
        tb = 0;
    } else if (tb && !PyTraceBack_Check(tb)) {
        PyErr_SetString(PyExc_TypeError,
            "raise: arg 3 must be a traceback or None");
        goto bad;
    }
    if (value == Py_None)
        value = 0;
    if (PyExceptionInstance_Check(type)) {
        if (value) {
            PyErr_SetString(PyExc_TypeError,
                "instance exception may not have a separate value");
            goto bad;
        }
        value = type;
        type = (PyObject*) Py_TYPE(value);
    } else if (PyExceptionClass_Check(type)) {
        PyObject *instance_class = NULL;
        if (value && PyExceptionInstance_Check(value)) {
            instance_class = (PyObject*) Py_TYPE(value);
            if (instance_class != type) {
                int is_subclass = PyObject_IsSubclass(instance_class, type);
                if (!is_subclass) {
                    instance_class = NULL;
                } else if (unlikely(is_subclass == -1)) {
                    goto bad;
                } else {
                    type = instance_class;
                }
            }
        }
        if (!instance_class) {
            PyObject *args;
            if (!value)
                args = PyTuple_New(0);
            else if (PyTuple_Check(value)) {
                Py_INCREF(value);
                args = value;
            } else
                args = PyTuple_Pack(1, value);
            if (!args)
                goto bad;
            owned_instance = PyObject_Call(type, args, NULL);
            Py_DECREF(args);
            if (!owned_instance)
                goto bad;
            value = owned_instance;
            if (!PyExceptionInstance_Check(value)) {
                PyErr_Format(PyExc_TypeError,
                             "calling %R should have returned an instance of "
                             "BaseException, not %R",
                             type, Py_TYPE(value));
                goto bad;
            }
        }
    } else {
        PyErr_SetString(PyExc_TypeError,
            "raise: exception class must be a subclass of BaseException");
        goto bad;
    }
#if PY_VERSION_HEX >= 0x03030000
    if (cause) {
#else
    if (cause && cause != Py_None) {
#endif
        PyObject *fixed_cause;
        if (cause == Py_None) {
            fixed_cause = NULL;
        } else if (PyExceptionClass_Check(cause)) {
            fixed_cause = PyObject_CallObject(cause, NULL);
            if (fixed_cause == NULL)
                goto bad;
        } else if (PyExceptionInstance_Check(cause)) {
            fixed_cause = cause;
            Py_INCREF(fixed_cause);
        } else {
            PyErr_SetString(PyExc_TypeError,
                            "exception causes must derive from "
                            "BaseException");
            goto bad;
        }
        PyException_SetCause(value, fixed_cause);
    }
    PyErr_SetObject(type, value);
    if (tb) {
#if CYTHON_COMPILING_IN_PYPY
        PyObject *tmp_type, *tmp_value, *tmp_tb;
        PyErr_Fetch(&tmp_type, &tmp_value, &tmp_tb);
        Py_INCREF(tb);
        PyErr_Restore(tmp_type, tmp_value, tb);
        Py_XDECREF(tmp_tb);
#else
        PyThreadState *tstate = PyThreadState_GET();
        PyObject* tmp_tb = tstate->curexc_traceback;
        if (tb != tmp_tb) {
            Py_INCREF(tb);
            tstate->curexc_traceback = tb;
            Py_XDECREF(tmp_tb);
        }
#endif
    }
bad:
    Py_XDECREF(owned_instance);
    return;
}
#endif

/* PyErrExceptionMatches */
          #if CYTHON_COMPILING_IN_CPYTHON
static CYTHON_INLINE int __Pyx_PyErr_ExceptionMatchesInState(PyThreadState* tstate, PyObject* err) {
    PyObject *exc_type = tstate->curexc_type;
    if (exc_type == err) return 1;
    if (unlikely(!exc_type)) return 0;
    return PyErr_GivenExceptionMatches(exc_type, err);
}
#endif

/* SetItemInt */
          static CYTHON_INLINE int __Pyx_SetItemInt_Generic(PyObject *o, PyObject *j, PyObject *v) {
    int r;
    if (!j) return -1;
    r = PyObject_SetItem(o, j, v);
    Py_DECREF(j);
    return r;
}
static CYTHON_INLINE int __Pyx_SetItemInt_Fast(PyObject *o, Py_ssize_t i, PyObject *v, int is_list,
                                               CYTHON_NCP_UNUSED int wraparound, CYTHON_NCP_UNUSED int boundscheck) {
#if CYTHON_COMPILING_IN_CPYTHON
    if (is_list || PyList_CheckExact(o)) {
        Py_ssize_t n = (!wraparound) ? i : ((likely(i >= 0)) ? i : i + PyList_GET_SIZE(o));
        if ((!boundscheck) || likely((n >= 0) & (n < PyList_GET_SIZE(o)))) {
            PyObject* old = PyList_GET_ITEM(o, n);
            Py_INCREF(v);
            PyList_SET_ITEM(o, n, v);
            Py_DECREF(old);
            return 1;
        }
    } else {
        PySequenceMethods *m = Py_TYPE(o)->tp_as_sequence;
        if (likely(m && m->sq_ass_item)) {
            if (wraparound && unlikely(i < 0) && likely(m->sq_length)) {
                Py_ssize_t l = m->sq_length(o);
                if (likely(l >= 0)) {
                    i += l;
                } else {
                    if (!PyErr_ExceptionMatches(PyExc_OverflowError))
                        return -1;
                    PyErr_Clear();
                }
            }
            return m->sq_ass_item(o, i, v);
        }
    }
#else
#if CYTHON_COMPILING_IN_PYPY
    if (is_list || (PySequence_Check(o) && !PyDict_Check(o))) {
#else
    if (is_list || PySequence_Check(o)) {
#endif
        return PySequence_SetItem(o, i, v);
    }
#endif
    return __Pyx_SetItemInt_Generic(o, PyInt_FromSsize_t(i), v);
}

/* PyIntBinop */
            #if CYTHON_COMPILING_IN_CPYTHON
static PyObject* __Pyx_PyInt_EqObjC(PyObject *op1, PyObject *op2, CYTHON_UNUSED long intval, CYTHON_UNUSED int inplace) {
    if (op1 == op2) {
        Py_RETURN_TRUE;
    }
    #if PY_MAJOR_VERSION < 3
    if (likely(PyInt_CheckExact(op1))) {
        const long b = intval;
        long a = PyInt_AS_LONG(op1);
        if (a == b) {
            Py_RETURN_TRUE;
        } else {
            Py_RETURN_FALSE;
        }
    }
    #endif
    #if CYTHON_USE_PYLONG_INTERNALS && PY_MAJOR_VERSION >= 3
    if (likely(PyLong_CheckExact(op1))) {
        const long b = intval;
        long a;
        const digit* digits = ((PyLongObject*)op1)->ob_digit;
        const Py_ssize_t size = Py_SIZE(op1);
        if (likely(__Pyx_sst_abs(size) <= 1)) {
            a = likely(size) ? digits[0] : 0;
            if (size == -1) a = -a;
        } else {
            switch (size) {
                case -2:
                    if (8 * sizeof(long) - 1 > 2 * PyLong_SHIFT) {
                        a = -(long) (((((unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0]));
                        break;
                    }
                case 2:
                    if (8 * sizeof(long) - 1 > 2 * PyLong_SHIFT) {
                        a = (long) (((((unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0]));
                        break;
                    }
                case -3:
                    if (8 * sizeof(long) - 1 > 3 * PyLong_SHIFT) {
                        a = -(long) (((((((unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0]));
                        break;
                    }
                case 3:
                    if (8 * sizeof(long) - 1 > 3 * PyLong_SHIFT) {
                        a = (long) (((((((unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0]));
                        break;
                    }
                case -4:
                    if (8 * sizeof(long) - 1 > 4 * PyLong_SHIFT) {
                        a = -(long) (((((((((unsigned long)digits[3]) << PyLong_SHIFT) | (unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0]));
                        break;
                    }
                case 4:
                    if (8 * sizeof(long) - 1 > 4 * PyLong_SHIFT) {
                        a = (long) (((((((((unsigned long)digits[3]) << PyLong_SHIFT) | (unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0]));
                        break;
                    }
                #if PyLong_SHIFT < 30 && PyLong_SHIFT != 15
                default: return PyLong_Type.tp_richcompare(op1, op2, Py_EQ);
                #else
                default: Py_RETURN_FALSE;
                #endif
            }
        }
            if (a == b) {
                Py_RETURN_TRUE;
            } else {
                Py_RETURN_FALSE;
            }
    }
    #endif
    if (PyFloat_CheckExact(op1)) {
        const long b = intval;
        double a = PyFloat_AS_DOUBLE(op1);
            if ((double)a == (double)b) {
                Py_RETURN_TRUE;
            } else {
                Py_RETURN_FALSE;
            }
    }
    return PyObject_RichCompare(op1, op2, Py_EQ);
}
#endif

/* GetItemInt */
            static CYTHON_INLINE PyObject *__Pyx_GetItemInt_Generic(PyObject *o, PyObject* j) {
    PyObject *r;
    if (!j) return NULL;
    r = PyObject_GetItem(o, j);
    Py_DECREF(j);
    return r;
}
static CYTHON_INLINE PyObject *__Pyx_GetItemInt_List_Fast(PyObject *o, Py_ssize_t i,
                                                              CYTHON_NCP_UNUSED int wraparound,
                                                              CYTHON_NCP_UNUSED int boundscheck) {
#if CYTHON_COMPILING_IN_CPYTHON
    if (wraparound & unlikely(i < 0)) i += PyList_GET_SIZE(o);
    if ((!boundscheck) || likely((0 <= i) & (i < PyList_GET_SIZE(o)))) {
        PyObject *r = PyList_GET_ITEM(o, i);
        Py_INCREF(r);
        return r;
    }
    return __Pyx_GetItemInt_Generic(o, PyInt_FromSsize_t(i));
#else
    return PySequence_GetItem(o, i);
#endif
}
static CYTHON_INLINE PyObject *__Pyx_GetItemInt_Tuple_Fast(PyObject *o, Py_ssize_t i,
                                                              CYTHON_NCP_UNUSED int wraparound,
                                                              CYTHON_NCP_UNUSED int boundscheck) {
#if CYTHON_COMPILING_IN_CPYTHON
    if (wraparound & unlikely(i < 0)) i += PyTuple_GET_SIZE(o);
    if ((!boundscheck) || likely((0 <= i) & (i < PyTuple_GET_SIZE(o)))) {
        PyObject *r = PyTuple_GET_ITEM(o, i);
        Py_INCREF(r);
        return r;
    }
    return __Pyx_GetItemInt_Generic(o, PyInt_FromSsize_t(i));
#else
    return PySequence_GetItem(o, i);
#endif
}
static CYTHON_INLINE PyObject *__Pyx_GetItemInt_Fast(PyObject *o, Py_ssize_t i, int is_list,
                                                     CYTHON_NCP_UNUSED int wraparound,
                                                     CYTHON_NCP_UNUSED int boundscheck) {
#if CYTHON_COMPILING_IN_CPYTHON
    if (is_list || PyList_CheckExact(o)) {
        Py_ssize_t n = ((!wraparound) | likely(i >= 0)) ? i : i + PyList_GET_SIZE(o);
        if ((!boundscheck) || (likely((n >= 0) & (n < PyList_GET_SIZE(o))))) {
            PyObject *r = PyList_GET_ITEM(o, n);
            Py_INCREF(r);
            return r;
        }
    }
    else if (PyTuple_CheckExact(o)) {
        Py_ssize_t n = ((!wraparound) | likely(i >= 0)) ? i : i + PyTuple_GET_SIZE(o);
        if ((!boundscheck) || likely((n >= 0) & (n < PyTuple_GET_SIZE(o)))) {
            PyObject *r = PyTuple_GET_ITEM(o, n);
            Py_INCREF(r);
            return r;
        }
    } else {
        PySequenceMethods *m = Py_TYPE(o)->tp_as_sequence;
        if (likely(m && m->sq_item)) {
            if (wraparound && unlikely(i < 0) && likely(m->sq_length)) {
                Py_ssize_t l = m->sq_length(o);
                if (likely(l >= 0)) {
                    i += l;
                } else {
                    if (!PyErr_ExceptionMatches(PyExc_OverflowError))
                        return NULL;
                    PyErr_Clear();
                }
            }
            return m->sq_item(o, i);
        }
    }
#else
    if (is_list || PySequence_Check(o)) {
        return PySequence_GetItem(o, i);
    }
#endif
    return __Pyx_GetItemInt_Generic(o, PyInt_FromSsize_t(i));
}

/* BytesEquals */
            static CYTHON_INLINE int __Pyx_PyBytes_Equals(PyObject* s1, PyObject* s2, int equals) {
#if CYTHON_COMPILING_IN_PYPY
    return PyObject_RichCompareBool(s1, s2, equals);
#else
    if (s1 == s2) {
        return (equals == Py_EQ);
    } else if (PyBytes_CheckExact(s1) & PyBytes_CheckExact(s2)) {
        const char *ps1, *ps2;
        Py_ssize_t length = PyBytes_GET_SIZE(s1);
        if (length != PyBytes_GET_SIZE(s2))
            return (equals == Py_NE);
        ps1 = PyBytes_AS_STRING(s1);
        ps2 = PyBytes_AS_STRING(s2);
        if (ps1[0] != ps2[0]) {
            return (equals == Py_NE);
        } else if (length == 1) {
            return (equals == Py_EQ);
        } else {
            int result = memcmp(ps1, ps2, (size_t)length);
            return (equals == Py_EQ) ? (result == 0) : (result != 0);
        }
    } else if ((s1 == Py_None) & PyBytes_CheckExact(s2)) {
        return (equals == Py_NE);
    } else if ((s2 == Py_None) & PyBytes_CheckExact(s1)) {
        return (equals == Py_NE);
    } else {
        int result;
        PyObject* py_result = PyObject_RichCompare(s1, s2, equals);
        if (!py_result)
            return -1;
        result = __Pyx_PyObject_IsTrue(py_result);
        Py_DECREF(py_result);
        return result;
    }
#endif
}

/* RaiseTooManyValuesToUnpack */
            static CYTHON_INLINE void __Pyx_RaiseTooManyValuesError(Py_ssize_t expected) {
    PyErr_Format(PyExc_ValueError,
                 "too many values to unpack (expected %" CYTHON_FORMAT_SSIZE_T "d)", expected);
}

/* RaiseNeedMoreValuesToUnpack */
            static CYTHON_INLINE void __Pyx_RaiseNeedMoreValuesError(Py_ssize_t index) {
    PyErr_Format(PyExc_ValueError,
                 "need more than %" CYTHON_FORMAT_SSIZE_T "d value%.1s to unpack",
                 index, (index == 1) ? "" : "s");
}

/* IterFinish */
            static CYTHON_INLINE int __Pyx_IterFinish(void) {
#if CYTHON_COMPILING_IN_CPYTHON
    PyThreadState *tstate = PyThreadState_GET();
    PyObject* exc_type = tstate->curexc_type;
    if (unlikely(exc_type)) {
        if (likely(exc_type == PyExc_StopIteration) || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration)) {
            PyObject *exc_value, *exc_tb;
            exc_value = tstate->curexc_value;
            exc_tb = tstate->curexc_traceback;
            tstate->curexc_type = 0;
            tstate->curexc_value = 0;
            tstate->curexc_traceback = 0;
            Py_DECREF(exc_type);
            Py_XDECREF(exc_value);
            Py_XDECREF(exc_tb);
            return 0;
        } else {
            return -1;
        }
    }
    return 0;
#else
    if (unlikely(PyErr_Occurred())) {
        if (likely(PyErr_ExceptionMatches(PyExc_StopIteration))) {
            PyErr_Clear();
            return 0;
        } else {
            return -1;
        }
    }
    return 0;
#endif
}

/* UnpackItemEndCheck */
            static int __Pyx_IternextUnpackEndCheck(PyObject *retval, Py_ssize_t expected) {
    if (unlikely(retval)) {
        Py_DECREF(retval);
        __Pyx_RaiseTooManyValuesError(expected);
        return -1;
    } else {
        return __Pyx_IterFinish();
    }
    return 0;
}

/* SliceObject */
            static CYTHON_INLINE PyObject* __Pyx_PyObject_GetSlice(PyObject* obj,
        Py_ssize_t cstart, Py_ssize_t cstop,
        PyObject** _py_start, PyObject** _py_stop, PyObject** _py_slice,
        int has_cstart, int has_cstop, CYTHON_UNUSED int wraparound) {
#if CYTHON_COMPILING_IN_CPYTHON
    PyMappingMethods* mp;
#if PY_MAJOR_VERSION < 3
    PySequenceMethods* ms = Py_TYPE(obj)->tp_as_sequence;
    if (likely(ms && ms->sq_slice)) {
        if (!has_cstart) {
            if (_py_start && (*_py_start != Py_None)) {
                cstart = __Pyx_PyIndex_AsSsize_t(*_py_start);
                if ((cstart == (Py_ssize_t)-1) && PyErr_Occurred()) goto bad;
            } else
                cstart = 0;
        }
        if (!has_cstop) {
            if (_py_stop && (*_py_stop != Py_None)) {
                cstop = __Pyx_PyIndex_AsSsize_t(*_py_stop);
                if ((cstop == (Py_ssize_t)-1) && PyErr_Occurred()) goto bad;
            } else
                cstop = PY_SSIZE_T_MAX;
        }
        if (wraparound && unlikely((cstart < 0) | (cstop < 0)) && likely(ms->sq_length)) {
            Py_ssize_t l = ms->sq_length(obj);
            if (likely(l >= 0)) {
                if (cstop < 0) {
                    cstop += l;
                    if (cstop < 0) cstop = 0;
                }
                if (cstart < 0) {
                    cstart += l;
                    if (cstart < 0) cstart = 0;
                }
            } else {
                if (!PyErr_ExceptionMatches(PyExc_OverflowError))
                    goto bad;
                PyErr_Clear();
            }
        }
        return ms->sq_slice(obj, cstart, cstop);
    }
#endif
    mp = Py_TYPE(obj)->tp_as_mapping;
    if (likely(mp && mp->mp_subscript))
#endif
    {
        PyObject* result;
        PyObject *py_slice, *py_start, *py_stop;
        if (_py_slice) {
            py_slice = *_py_slice;
        } else {
            PyObject* owned_start = NULL;
            PyObject* owned_stop = NULL;
            if (_py_start) {
                py_start = *_py_start;
            } else {
                if (has_cstart) {
                    owned_start = py_start = PyInt_FromSsize_t(cstart);
                    if (unlikely(!py_start)) goto bad;
                } else
                    py_start = Py_None;
            }
            if (_py_stop) {
                py_stop = *_py_stop;
            } else {
                if (has_cstop) {
                    owned_stop = py_stop = PyInt_FromSsize_t(cstop);
                    if (unlikely(!py_stop)) {
                        Py_XDECREF(owned_start);
                        goto bad;
                    }
                } else
                    py_stop = Py_None;
            }
            py_slice = PySlice_New(py_start, py_stop, Py_None);
            Py_XDECREF(owned_start);
            Py_XDECREF(owned_stop);
            if (unlikely(!py_slice)) goto bad;
        }
#if CYTHON_COMPILING_IN_CPYTHON
        result = mp->mp_subscript(obj, py_slice);
#else
        result = PyObject_GetItem(obj, py_slice);
#endif
        if (!_py_slice) {
            Py_DECREF(py_slice);
        }
        return result;
    }
    PyErr_Format(PyExc_TypeError,
        "'%.200s' object is unsliceable", Py_TYPE(obj)->tp_name);
bad:
    return NULL;
}

/* ArgTypeTest */
            static void __Pyx_RaiseArgumentTypeInvalid(const char* name, PyObject *obj, PyTypeObject *type) {
    PyErr_Format(PyExc_TypeError,
        "Argument '%.200s' has incorrect type (expected %.200s, got %.200s)",
        name, type->tp_name, Py_TYPE(obj)->tp_name);
}
static CYTHON_INLINE int __Pyx_ArgTypeTest(PyObject *obj, PyTypeObject *type, int none_allowed,
    const char *name, int exact)
{
    if (unlikely(!type)) {
        PyErr_SetString(PyExc_SystemError, "Missing type object");
        return 0;
    }
    if (none_allowed && obj == Py_None) return 1;
    else if (exact) {
        if (likely(Py_TYPE(obj) == type)) return 1;
        #if PY_MAJOR_VERSION == 2
        else if ((type == &PyBaseString_Type) && likely(__Pyx_PyBaseString_CheckExact(obj))) return 1;
        #endif
    }
    else {
        if (likely(PyObject_TypeCheck(obj, type))) return 1;
    }
    __Pyx_RaiseArgumentTypeInvalid(name, obj, type);
    return 0;
}

/* SetVTable */
            static int __Pyx_SetVtable(PyObject *dict, void *vtable) {
#if PY_VERSION_HEX >= 0x02070000
    PyObject *ob = PyCapsule_New(vtable, 0, 0);
#else
    PyObject *ob = PyCObject_FromVoidPtr(vtable, 0);
#endif
    if (!ob)
        goto bad;
    if (PyDict_SetItem(dict, __pyx_n_s_pyx_vtable, ob) < 0)
        goto bad;
    Py_DECREF(ob);
    return 0;
bad:
    Py_XDECREF(ob);
    return -1;
}

/* GetVTable */
            static void* __Pyx_GetVtable(PyObject *dict) {
    void* ptr;
    PyObject *ob = PyObject_GetItem(dict, __pyx_n_s_pyx_vtable);
    if (!ob)
        goto bad;
#if PY_VERSION_HEX >= 0x02070000
    ptr = PyCapsule_GetPointer(ob, 0);
#else
    ptr = PyCObject_AsVoidPtr(ob);
#endif
    if (!ptr && !PyErr_Occurred())
        PyErr_SetString(PyExc_RuntimeError, "invalid vtable found for imported type");
    Py_DECREF(ob);
    return ptr;
bad:
    Py_XDECREF(ob);
    return NULL;
}

/* Import */
            static PyObject *__Pyx_Import(PyObject *name, PyObject *from_list, int level) {
    PyObject *empty_list = 0;
    PyObject *module = 0;
    PyObject *global_dict = 0;
    PyObject *empty_dict = 0;
    PyObject *list;
    #if PY_VERSION_HEX < 0x03030000
    PyObject *py_import;
    py_import = __Pyx_PyObject_GetAttrStr(__pyx_b, __pyx_n_s_import);
    if (!py_import)
        goto bad;
    #endif
    if (from_list)
        list = from_list;
    else {
        empty_list = PyList_New(0);
        if (!empty_list)
            goto bad;
        list = empty_list;
    }
    global_dict = PyModule_GetDict(__pyx_m);
    if (!global_dict)
        goto bad;
    empty_dict = PyDict_New();
    if (!empty_dict)
        goto bad;
    {
        #if PY_MAJOR_VERSION >= 3
        if (level == -1) {
            if (strchr(__Pyx_MODULE_NAME, '.')) {
                #if PY_VERSION_HEX < 0x03030000
                PyObject *py_level = PyInt_FromLong(1);
                if (!py_level)
                    goto bad;
                module = PyObject_CallFunctionObjArgs(py_import,
                    name, global_dict, empty_dict, list, py_level, NULL);
                Py_DECREF(py_level);
                #else
                module = PyImport_ImportModuleLevelObject(
                    name, global_dict, empty_dict, list, 1);
                #endif
                if (!module) {
                    if (!PyErr_ExceptionMatches(PyExc_ImportError))
                        goto bad;
                    PyErr_Clear();
                }
            }
            level = 0;
        }
        #endif
        if (!module) {
            #if PY_VERSION_HEX < 0x03030000
            PyObject *py_level = PyInt_FromLong(level);
            if (!py_level)
                goto bad;
            module = PyObject_CallFunctionObjArgs(py_import,
                name, global_dict, empty_dict, list, py_level, NULL);
            Py_DECREF(py_level);
            #else
            module = PyImport_ImportModuleLevelObject(
                name, global_dict, empty_dict, list, level);
            #endif
        }
    }
bad:
    #if PY_VERSION_HEX < 0x03030000
    Py_XDECREF(py_import);
    #endif
    Py_XDECREF(empty_list);
    Py_XDECREF(empty_dict);
    return module;
}

/* ImportFrom */
            static PyObject* __Pyx_ImportFrom(PyObject* module, PyObject* name) {
    PyObject* value = __Pyx_PyObject_GetAttrStr(module, name);
    if (unlikely(!value) && PyErr_ExceptionMatches(PyExc_AttributeError)) {
        PyErr_Format(PyExc_ImportError,
        #if PY_MAJOR_VERSION < 3
            "cannot import name %.230s", PyString_AS_STRING(name));
        #else
            "cannot import name %S", name);
        #endif
    }
    return value;
}

/* CodeObjectCache */
            static int __pyx_bisect_code_objects(__Pyx_CodeObjectCacheEntry* entries, int count, int code_line) {
    int start = 0, mid = 0, end = count - 1;
    if (end >= 0 && code_line > entries[end].code_line) {
        return count;
    }
    while (start < end) {
        mid = start + (end - start) / 2;
        if (code_line < entries[mid].code_line) {
            end = mid;
        } else if (code_line > entries[mid].code_line) {
             start = mid + 1;
        } else {
            return mid;
        }
    }
    if (code_line <= entries[mid].code_line) {
        return mid;
    } else {
        return mid + 1;
    }
}
static PyCodeObject *__pyx_find_code_object(int code_line) {
    PyCodeObject* code_object;
    int pos;
    if (unlikely(!code_line) || unlikely(!__pyx_code_cache.entries)) {
        return NULL;
    }
    pos = __pyx_bisect_code_objects(__pyx_code_cache.entries, __pyx_code_cache.count, code_line);
    if (unlikely(pos >= __pyx_code_cache.count) || unlikely(__pyx_code_cache.entries[pos].code_line != code_line)) {
        return NULL;
    }
    code_object = __pyx_code_cache.entries[pos].code_object;
    Py_INCREF(code_object);
    return code_object;
}
static void __pyx_insert_code_object(int code_line, PyCodeObject* code_object) {
    int pos, i;
    __Pyx_CodeObjectCacheEntry* entries = __pyx_code_cache.entries;
    if (unlikely(!code_line)) {
        return;
    }
    if (unlikely(!entries)) {
        entries = (__Pyx_CodeObjectCacheEntry*)PyMem_Malloc(64*sizeof(__Pyx_CodeObjectCacheEntry));
        if (likely(entries)) {
            __pyx_code_cache.entries = entries;
            __pyx_code_cache.max_count = 64;
            __pyx_code_cache.count = 1;
            entries[0].code_line = code_line;
            entries[0].code_object = code_object;
            Py_INCREF(code_object);
        }
        return;
    }
    pos = __pyx_bisect_code_objects(__pyx_code_cache.entries, __pyx_code_cache.count, code_line);
    if ((pos < __pyx_code_cache.count) && unlikely(__pyx_code_cache.entries[pos].code_line == code_line)) {
        PyCodeObject* tmp = entries[pos].code_object;
        entries[pos].code_object = code_object;
        Py_DECREF(tmp);
        return;
    }
    if (__pyx_code_cache.count == __pyx_code_cache.max_count) {
        int new_max = __pyx_code_cache.max_count + 64;
        entries = (__Pyx_CodeObjectCacheEntry*)PyMem_Realloc(
            __pyx_code_cache.entries, (size_t)new_max*sizeof(__Pyx_CodeObjectCacheEntry));
        if (unlikely(!entries)) {
            return;
        }
        __pyx_code_cache.entries = entries;
        __pyx_code_cache.max_count = new_max;
    }
    for (i=__pyx_code_cache.count; i>pos; i--) {
        entries[i] = entries[i-1];
    }
    entries[pos].code_line = code_line;
    entries[pos].code_object = code_object;
    __pyx_code_cache.count++;
    Py_INCREF(code_object);
}

/* AddTraceback */
            #include "compile.h"
#include "frameobject.h"
#include "traceback.h"
static PyCodeObject* __Pyx_CreateCodeObjectForTraceback(
            const char *funcname, int c_line,
            int py_line, const char *filename) {
    PyCodeObject *py_code = 0;
    PyObject *py_srcfile = 0;
    PyObject *py_funcname = 0;
    #if PY_MAJOR_VERSION < 3
    py_srcfile = PyString_FromString(filename);
    #else
    py_srcfile = PyUnicode_FromString(filename);
    #endif
    if (!py_srcfile) goto bad;
    if (c_line) {
        #if PY_MAJOR_VERSION < 3
        py_funcname = PyString_FromFormat( "%s (%s:%d)", funcname, __pyx_cfilenm, c_line);
        #else
        py_funcname = PyUnicode_FromFormat( "%s (%s:%d)", funcname, __pyx_cfilenm, c_line);
        #endif
    }
    else {
        #if PY_MAJOR_VERSION < 3
        py_funcname = PyString_FromString(funcname);
        #else
        py_funcname = PyUnicode_FromString(funcname);
        #endif
    }
    if (!py_funcname) goto bad;
    py_code = __Pyx_PyCode_New(
        0,
        0,
        0,
        0,
        0,
        __pyx_empty_bytes, /*PyObject *code,*/
        __pyx_empty_tuple, /*PyObject *consts,*/
        __pyx_empty_tuple, /*PyObject *names,*/
        __pyx_empty_tuple, /*PyObject *varnames,*/
        __pyx_empty_tuple, /*PyObject *freevars,*/
        __pyx_empty_tuple, /*PyObject *cellvars,*/
        py_srcfile,   /*PyObject *filename,*/
        py_funcname,  /*PyObject *name,*/
        py_line,
        __pyx_empty_bytes  /*PyObject *lnotab*/
    );
    Py_DECREF(py_srcfile);
    Py_DECREF(py_funcname);
    return py_code;
bad:
    Py_XDECREF(py_srcfile);
    Py_XDECREF(py_funcname);
    return NULL;
}
static void __Pyx_AddTraceback(const char *funcname, int c_line,
                               int py_line, const char *filename) {
    PyCodeObject *py_code = 0;
    PyFrameObject *py_frame = 0;
    py_code = __pyx_find_code_object(c_line ? c_line : py_line);
    if (!py_code) {
        py_code = __Pyx_CreateCodeObjectForTraceback(
            funcname, c_line, py_line, filename);
        if (!py_code) goto bad;
        __pyx_insert_code_object(c_line ? c_line : py_line, py_code);
    }
    py_frame = PyFrame_New(
        PyThreadState_GET(), /*PyThreadState *tstate,*/
        py_code,             /*PyCodeObject *code,*/
        __pyx_d,      /*PyObject *globals,*/
        0                    /*PyObject *locals*/
    );
    if (!py_frame) goto bad;
    py_frame->f_lineno = py_line;
    PyTraceBack_Here(py_frame);
bad:
    Py_XDECREF(py_code);
    Py_XDECREF(py_frame);
}

/* CIntFromPyVerify */
            #define __PYX_VERIFY_RETURN_INT(target_type, func_type, func_value)\
    __PYX__VERIFY_RETURN_INT(target_type, func_type, func_value, 0)
#define __PYX_VERIFY_RETURN_INT_EXC(target_type, func_type, func_value)\
    __PYX__VERIFY_RETURN_INT(target_type, func_type, func_value, 1)
#define __PYX__VERIFY_RETURN_INT(target_type, func_type, func_value, exc)\
    {\
        func_type value = func_value;\
        if (sizeof(target_type) < sizeof(func_type)) {\
            if (unlikely(value != (func_type) (target_type) value)) {\
                func_type zero = 0;\
                if (exc && unlikely(value == (func_type)-1 && PyErr_Occurred()))\
                    return (target_type) -1;\
                if (is_unsigned && unlikely(value < zero))\
                    goto raise_neg_overflow;\
                else\
                    goto raise_overflow;\
            }\
        }\
        return (target_type) value;\
    }

/* Print */
            #if !CYTHON_COMPILING_IN_PYPY && PY_MAJOR_VERSION < 3
static PyObject *__Pyx_GetStdout(void) {
    PyObject *f = PySys_GetObject((char *)"stdout");
    if (!f) {
        PyErr_SetString(PyExc_RuntimeError, "lost sys.stdout");
    }
    return f;
}
static int __Pyx_Print(PyObject* f, PyObject *arg_tuple, int newline) {
    int i;
    if (!f) {
        if (!(f = __Pyx_GetStdout()))
            return -1;
    }
    Py_INCREF(f);
    for (i=0; i < PyTuple_GET_SIZE(arg_tuple); i++) {
        PyObject* v;
        if (PyFile_SoftSpace(f, 1)) {
            if (PyFile_WriteString(" ", f) < 0)
                goto error;
        }
        v = PyTuple_GET_ITEM(arg_tuple, i);
        if (PyFile_WriteObject(v, f, Py_PRINT_RAW) < 0)
            goto error;
        if (PyString_Check(v)) {
            char *s = PyString_AsString(v);
            Py_ssize_t len = PyString_Size(v);
            if (len > 0) {
                switch (s[len-1]) {
                    case ' ': break;
                    case '\f': case '\r': case '\n': case '\t': case '\v':
                        PyFile_SoftSpace(f, 0);
                        break;
                    default:  break;
                }
            }
        }
    }
    if (newline) {
        if (PyFile_WriteString("\n", f) < 0)
            goto error;
        PyFile_SoftSpace(f, 0);
    }
    Py_DECREF(f);
    return 0;
error:
    Py_DECREF(f);
    return -1;
}
#else
static int __Pyx_Print(PyObject* stream, PyObject *arg_tuple, int newline) {
    PyObject* kwargs = 0;
    PyObject* result = 0;
    PyObject* end_string;
    if (unlikely(!__pyx_print)) {
        __pyx_print = PyObject_GetAttr(__pyx_b, __pyx_n_s_print);
        if (!__pyx_print)
            return -1;
    }
    if (stream) {
        kwargs = PyDict_New();
        if (unlikely(!kwargs))
            return -1;
        if (unlikely(PyDict_SetItem(kwargs, __pyx_n_s_file, stream) < 0))
            goto bad;
        if (!newline) {
            end_string = PyUnicode_FromStringAndSize(" ", 1);
            if (unlikely(!end_string))
                goto bad;
            if (PyDict_SetItem(kwargs, __pyx_n_s_end, end_string) < 0) {
                Py_DECREF(end_string);
                goto bad;
            }
            Py_DECREF(end_string);
        }
    } else if (!newline) {
        if (unlikely(!__pyx_print_kwargs)) {
            __pyx_print_kwargs = PyDict_New();
            if (unlikely(!__pyx_print_kwargs))
                return -1;
            end_string = PyUnicode_FromStringAndSize(" ", 1);
            if (unlikely(!end_string))
                return -1;
            if (PyDict_SetItem(__pyx_print_kwargs, __pyx_n_s_end, end_string) < 0) {
                Py_DECREF(end_string);
                return -1;
            }
            Py_DECREF(end_string);
        }
        kwargs = __pyx_print_kwargs;
    }
    result = PyObject_Call(__pyx_print, arg_tuple, kwargs);
    if (unlikely(kwargs) && (kwargs != __pyx_print_kwargs))
        Py_DECREF(kwargs);
    if (!result)
        return -1;
    Py_DECREF(result);
    return 0;
bad:
    if (kwargs != __pyx_print_kwargs)
        Py_XDECREF(kwargs);
    return -1;
}
#endif

/* CIntToPy */
            static CYTHON_INLINE PyObject* __Pyx_PyInt_From_int(int value) {
    const int neg_one = (int) -1, const_zero = (int) 0;
    const int is_unsigned = neg_one > const_zero;
    if (is_unsigned) {
        if (sizeof(int) < sizeof(long)) {
            return PyInt_FromLong((long) value);
        } else if (sizeof(int) <= sizeof(unsigned long)) {
            return PyLong_FromUnsignedLong((unsigned long) value);
        } else if (sizeof(int) <= sizeof(unsigned PY_LONG_LONG)) {
            return PyLong_FromUnsignedLongLong((unsigned PY_LONG_LONG) value);
        }
    } else {
        if (sizeof(int) <= sizeof(long)) {
            return PyInt_FromLong((long) value);
        } else if (sizeof(int) <= sizeof(PY_LONG_LONG)) {
            return PyLong_FromLongLong((PY_LONG_LONG) value);
        }
    }
    {
        int one = 1; int little = (int)*(unsigned char *)&one;
        unsigned char *bytes = (unsigned char *)&value;
        return _PyLong_FromByteArray(bytes, sizeof(int),
                                     little, !is_unsigned);
    }
}

/* CIntToPy */
            static CYTHON_INLINE PyObject* __Pyx_PyInt_From_long(long value) {
    const long neg_one = (long) -1, const_zero = (long) 0;
    const int is_unsigned = neg_one > const_zero;
    if (is_unsigned) {
        if (sizeof(long) < sizeof(long)) {
            return PyInt_FromLong((long) value);
        } else if (sizeof(long) <= sizeof(unsigned long)) {
            return PyLong_FromUnsignedLong((unsigned long) value);
        } else if (sizeof(long) <= sizeof(unsigned PY_LONG_LONG)) {
            return PyLong_FromUnsignedLongLong((unsigned PY_LONG_LONG) value);
        }
    } else {
        if (sizeof(long) <= sizeof(long)) {
            return PyInt_FromLong((long) value);
        } else if (sizeof(long) <= sizeof(PY_LONG_LONG)) {
            return PyLong_FromLongLong((PY_LONG_LONG) value);
        }
    }
    {
        int one = 1; int little = (int)*(unsigned char *)&one;
        unsigned char *bytes = (unsigned char *)&value;
        return _PyLong_FromByteArray(bytes, sizeof(long),
                                     little, !is_unsigned);
    }
}

/* CIntFromPy */
            static CYTHON_INLINE int __Pyx_PyInt_As_int(PyObject *x) {
    const int neg_one = (int) -1, const_zero = (int) 0;
    const int is_unsigned = neg_one > const_zero;
#if PY_MAJOR_VERSION < 3
    if (likely(PyInt_Check(x))) {
        if (sizeof(int) < sizeof(long)) {
            __PYX_VERIFY_RETURN_INT(int, long, PyInt_AS_LONG(x))
        } else {
            long val = PyInt_AS_LONG(x);
            if (is_unsigned && unlikely(val < 0)) {
                goto raise_neg_overflow;
            }
            return (int) val;
        }
    } else
#endif
    if (likely(PyLong_Check(x))) {
        if (is_unsigned) {
#if CYTHON_USE_PYLONG_INTERNALS
            const digit* digits = ((PyLongObject*)x)->ob_digit;
            switch (Py_SIZE(x)) {
                case  0: return (int) 0;
                case  1: __PYX_VERIFY_RETURN_INT(int, digit, digits[0])
                case 2:
                    if (8 * sizeof(int) > 1 * PyLong_SHIFT) {
                        if (8 * sizeof(unsigned long) > 2 * PyLong_SHIFT) {
                            __PYX_VERIFY_RETURN_INT(int, unsigned long, (((((unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
                        } else if (8 * sizeof(int) >= 2 * PyLong_SHIFT) {
                            return (int) (((((int)digits[1]) << PyLong_SHIFT) | (int)digits[0]));
                        }
                    }
                    break;
                case 3:
                    if (8 * sizeof(int) > 2 * PyLong_SHIFT) {
                        if (8 * sizeof(unsigned long) > 3 * PyLong_SHIFT) {
                            __PYX_VERIFY_RETURN_INT(int, unsigned long, (((((((unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
                        } else if (8 * sizeof(int) >= 3 * PyLong_SHIFT) {
                            return (int) (((((((int)digits[2]) << PyLong_SHIFT) | (int)digits[1]) << PyLong_SHIFT) | (int)digits[0]));
                        }
                    }
                    break;
                case 4:
                    if (8 * sizeof(int) > 3 * PyLong_SHIFT) {
                        if (8 * sizeof(unsigned long) > 4 * PyLong_SHIFT) {
                            __PYX_VERIFY_RETURN_INT(int, unsigned long, (((((((((unsigned long)digits[3]) << PyLong_SHIFT) | (unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
                        } else if (8 * sizeof(int) >= 4 * PyLong_SHIFT) {
                            return (int) (((((((((int)digits[3]) << PyLong_SHIFT) | (int)digits[2]) << PyLong_SHIFT) | (int)digits[1]) << PyLong_SHIFT) | (int)digits[0]));
                        }
                    }
                    break;
            }
#endif
#if CYTHON_COMPILING_IN_CPYTHON
            if (unlikely(Py_SIZE(x) < 0)) {
                goto raise_neg_overflow;
            }
#else
            {
                int result = PyObject_RichCompareBool(x, Py_False, Py_LT);
                if (unlikely(result < 0))
                    return (int) -1;
                if (unlikely(result == 1))
                    goto raise_neg_overflow;
            }
#endif
            if (sizeof(int) <= sizeof(unsigned long)) {
                __PYX_VERIFY_RETURN_INT_EXC(int, unsigned long, PyLong_AsUnsignedLong(x))
            } else if (sizeof(int) <= sizeof(unsigned PY_LONG_LONG)) {
                __PYX_VERIFY_RETURN_INT_EXC(int, unsigned PY_LONG_LONG, PyLong_AsUnsignedLongLong(x))
            }
        } else {
#if CYTHON_USE_PYLONG_INTERNALS
            const digit* digits = ((PyLongObject*)x)->ob_digit;
            switch (Py_SIZE(x)) {
                case  0: return (int) 0;
                case -1: __PYX_VERIFY_RETURN_INT(int, sdigit, (sdigit) (-(sdigit)digits[0]))
                case  1: __PYX_VERIFY_RETURN_INT(int,  digit, +digits[0])
                case -2:
                    if (8 * sizeof(int) - 1 > 1 * PyLong_SHIFT) {
                        if (8 * sizeof(unsigned long) > 2 * PyLong_SHIFT) {
                            __PYX_VERIFY_RETURN_INT(int, long, -(long) (((((unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
                        } else if (8 * sizeof(int) - 1 > 2 * PyLong_SHIFT) {
                            return (int) (((int)-1)*(((((int)digits[1]) << PyLong_SHIFT) | (int)digits[0])));
                        }
                    }
                    break;
                case 2:
                    if (8 * sizeof(int) > 1 * PyLong_SHIFT) {
                        if (8 * sizeof(unsigned long) > 2 * PyLong_SHIFT) {
                            __PYX_VERIFY_RETURN_INT(int, unsigned long, (((((unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
                        } else if (8 * sizeof(int) - 1 > 2 * PyLong_SHIFT) {
                            return (int) ((((((int)digits[1]) << PyLong_SHIFT) | (int)digits[0])));
                        }
                    }
                    break;
                case -3:
                    if (8 * sizeof(int) - 1 > 2 * PyLong_SHIFT) {
                        if (8 * sizeof(unsigned long) > 3 * PyLong_SHIFT) {
                            __PYX_VERIFY_RETURN_INT(int, long, -(long) (((((((unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
                        } else if (8 * sizeof(int) - 1 > 3 * PyLong_SHIFT) {
                            return (int) (((int)-1)*(((((((int)digits[2]) << PyLong_SHIFT) | (int)digits[1]) << PyLong_SHIFT) | (int)digits[0])));
                        }
                    }
                    break;
                case 3:
                    if (8 * sizeof(int) > 2 * PyLong_SHIFT) {
                        if (8 * sizeof(unsigned long) > 3 * PyLong_SHIFT) {
                            __PYX_VERIFY_RETURN_INT(int, unsigned long, (((((((unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
                        } else if (8 * sizeof(int) - 1 > 3 * PyLong_SHIFT) {
                            return (int) ((((((((int)digits[2]) << PyLong_SHIFT) | (int)digits[1]) << PyLong_SHIFT) | (int)digits[0])));
                        }
                    }
                    break;
                case -4:
                    if (8 * sizeof(int) - 1 > 3 * PyLong_SHIFT) {
                        if (8 * sizeof(unsigned long) > 4 * PyLong_SHIFT) {
                            __PYX_VERIFY_RETURN_INT(int, long, -(long) (((((((((unsigned long)digits[3]) << PyLong_SHIFT) | (unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
                        } else if (8 * sizeof(int) - 1 > 4 * PyLong_SHIFT) {
                            return (int) (((int)-1)*(((((((((int)digits[3]) << PyLong_SHIFT) | (int)digits[2]) << PyLong_SHIFT) | (int)digits[1]) << PyLong_SHIFT) | (int)digits[0])));
                        }
                    }
                    break;
                case 4:
                    if (8 * sizeof(int) > 3 * PyLong_SHIFT) {
                        if (8 * sizeof(unsigned long) > 4 * PyLong_SHIFT) {
                            __PYX_VERIFY_RETURN_INT(int, unsigned long, (((((((((unsigned long)digits[3]) << PyLong_SHIFT) | (unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
                        } else if (8 * sizeof(int) - 1 > 4 * PyLong_SHIFT) {
                            return (int) ((((((((((int)digits[3]) << PyLong_SHIFT) | (int)digits[2]) << PyLong_SHIFT) | (int)digits[1]) << PyLong_SHIFT) | (int)digits[0])));
                        }
                    }
                    break;
            }
#endif
            if (sizeof(int) <= sizeof(long)) {
                __PYX_VERIFY_RETURN_INT_EXC(int, long, PyLong_AsLong(x))
            } else if (sizeof(int) <= sizeof(PY_LONG_LONG)) {
                __PYX_VERIFY_RETURN_INT_EXC(int, PY_LONG_LONG, PyLong_AsLongLong(x))
            }
        }
        {
#if CYTHON_COMPILING_IN_PYPY && !defined(_PyLong_AsByteArray)
            PyErr_SetString(PyExc_RuntimeError,
                            "_PyLong_AsByteArray() not available in PyPy, cannot convert large numbers");
#else
            int val;
            PyObject *v = __Pyx_PyNumber_IntOrLong(x);
 #if PY_MAJOR_VERSION < 3
            if (likely(v) && !PyLong_Check(v)) {
                PyObject *tmp = v;
                v = PyNumber_Long(tmp);
                Py_DECREF(tmp);
            }
 #endif
            if (likely(v)) {
                int one = 1; int is_little = (int)*(unsigned char *)&one;
                unsigned char *bytes = (unsigned char *)&val;
                int ret = _PyLong_AsByteArray((PyLongObject *)v,
                                              bytes, sizeof(val),
                                              is_little, !is_unsigned);
                Py_DECREF(v);
                if (likely(!ret))
                    return val;
            }
#endif
            return (int) -1;
        }
    } else {
        int val;
        PyObject *tmp = __Pyx_PyNumber_IntOrLong(x);
        if (!tmp) return (int) -1;
        val = __Pyx_PyInt_As_int(tmp);
        Py_DECREF(tmp);
        return val;
    }
raise_overflow:
    PyErr_SetString(PyExc_OverflowError,
        "value too large to convert to int");
    return (int) -1;
raise_neg_overflow:
    PyErr_SetString(PyExc_OverflowError,
        "can't convert negative value to int");
    return (int) -1;
}

/* PrintOne */
            #if !CYTHON_COMPILING_IN_PYPY && PY_MAJOR_VERSION < 3
static int __Pyx_PrintOne(PyObject* f, PyObject *o) {
    if (!f) {
        if (!(f = __Pyx_GetStdout()))
            return -1;
    }
    Py_INCREF(f);
    if (PyFile_SoftSpace(f, 0)) {
        if (PyFile_WriteString(" ", f) < 0)
            goto error;
    }
    if (PyFile_WriteObject(o, f, Py_PRINT_RAW) < 0)
        goto error;
    if (PyFile_WriteString("\n", f) < 0)
        goto error;
    Py_DECREF(f);
    return 0;
error:
    Py_DECREF(f);
    return -1;
    /* the line below is just to avoid C compiler
     * warnings about unused functions */
    return __Pyx_Print(f, NULL, 0);
}
#else
static int __Pyx_PrintOne(PyObject* stream, PyObject *o) {
    int res;
    PyObject* arg_tuple = PyTuple_Pack(1, o);
    if (unlikely(!arg_tuple))
        return -1;
    res = __Pyx_Print(stream, arg_tuple, 1);
    Py_DECREF(arg_tuple);
    return res;
}
#endif

/* CIntFromPy */
            static CYTHON_INLINE long __Pyx_PyInt_As_long(PyObject *x) {
    const long neg_one = (long) -1, const_zero = (long) 0;
    const int is_unsigned = neg_one > const_zero;
#if PY_MAJOR_VERSION < 3
    if (likely(PyInt_Check(x))) {
        if (sizeof(long) < sizeof(long)) {
            __PYX_VERIFY_RETURN_INT(long, long, PyInt_AS_LONG(x))
        } else {
            long val = PyInt_AS_LONG(x);
            if (is_unsigned && unlikely(val < 0)) {
                goto raise_neg_overflow;
            }
            return (long) val;
        }
    } else
#endif
    if (likely(PyLong_Check(x))) {
        if (is_unsigned) {
#if CYTHON_USE_PYLONG_INTERNALS
            const digit* digits = ((PyLongObject*)x)->ob_digit;
            switch (Py_SIZE(x)) {
                case  0: return (long) 0;
                case  1: __PYX_VERIFY_RETURN_INT(long, digit, digits[0])
                case 2:
                    if (8 * sizeof(long) > 1 * PyLong_SHIFT) {
                        if (8 * sizeof(unsigned long) > 2 * PyLong_SHIFT) {
                            __PYX_VERIFY_RETURN_INT(long, unsigned long, (((((unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
                        } else if (8 * sizeof(long) >= 2 * PyLong_SHIFT) {
                            return (long) (((((long)digits[1]) << PyLong_SHIFT) | (long)digits[0]));
                        }
                    }
                    break;
                case 3:
                    if (8 * sizeof(long) > 2 * PyLong_SHIFT) {
                        if (8 * sizeof(unsigned long) > 3 * PyLong_SHIFT) {
                            __PYX_VERIFY_RETURN_INT(long, unsigned long, (((((((unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
                        } else if (8 * sizeof(long) >= 3 * PyLong_SHIFT) {
                            return (long) (((((((long)digits[2]) << PyLong_SHIFT) | (long)digits[1]) << PyLong_SHIFT) | (long)digits[0]));
                        }
                    }
                    break;
                case 4:
                    if (8 * sizeof(long) > 3 * PyLong_SHIFT) {
                        if (8 * sizeof(unsigned long) > 4 * PyLong_SHIFT) {
                            __PYX_VERIFY_RETURN_INT(long, unsigned long, (((((((((unsigned long)digits[3]) << PyLong_SHIFT) | (unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
                        } else if (8 * sizeof(long) >= 4 * PyLong_SHIFT) {
                            return (long) (((((((((long)digits[3]) << PyLong_SHIFT) | (long)digits[2]) << PyLong_SHIFT) | (long)digits[1]) << PyLong_SHIFT) | (long)digits[0]));
                        }
                    }
                    break;
            }
#endif
#if CYTHON_COMPILING_IN_CPYTHON
            if (unlikely(Py_SIZE(x) < 0)) {
                goto raise_neg_overflow;
            }
#else
            {
                int result = PyObject_RichCompareBool(x, Py_False, Py_LT);
                if (unlikely(result < 0))
                    return (long) -1;
                if (unlikely(result == 1))
                    goto raise_neg_overflow;
            }
#endif
            if (sizeof(long) <= sizeof(unsigned long)) {
                __PYX_VERIFY_RETURN_INT_EXC(long, unsigned long, PyLong_AsUnsignedLong(x))
            } else if (sizeof(long) <= sizeof(unsigned PY_LONG_LONG)) {
                __PYX_VERIFY_RETURN_INT_EXC(long, unsigned PY_LONG_LONG, PyLong_AsUnsignedLongLong(x))
            }
        } else {
#if CYTHON_USE_PYLONG_INTERNALS
            const digit* digits = ((PyLongObject*)x)->ob_digit;
            switch (Py_SIZE(x)) {
                case  0: return (long) 0;
                case -1: __PYX_VERIFY_RETURN_INT(long, sdigit, (sdigit) (-(sdigit)digits[0]))
                case  1: __PYX_VERIFY_RETURN_INT(long,  digit, +digits[0])
                case -2:
                    if (8 * sizeof(long) - 1 > 1 * PyLong_SHIFT) {
                        if (8 * sizeof(unsigned long) > 2 * PyLong_SHIFT) {
                            __PYX_VERIFY_RETURN_INT(long, long, -(long) (((((unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
                        } else if (8 * sizeof(long) - 1 > 2 * PyLong_SHIFT) {
                            return (long) (((long)-1)*(((((long)digits[1]) << PyLong_SHIFT) | (long)digits[0])));
                        }
                    }
                    break;
                case 2:
                    if (8 * sizeof(long) > 1 * PyLong_SHIFT) {
                        if (8 * sizeof(unsigned long) > 2 * PyLong_SHIFT) {
                            __PYX_VERIFY_RETURN_INT(long, unsigned long, (((((unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
                        } else if (8 * sizeof(long) - 1 > 2 * PyLong_SHIFT) {
                            return (long) ((((((long)digits[1]) << PyLong_SHIFT) | (long)digits[0])));
                        }
                    }
                    break;
                case -3:
                    if (8 * sizeof(long) - 1 > 2 * PyLong_SHIFT) {
                        if (8 * sizeof(unsigned long) > 3 * PyLong_SHIFT) {
                            __PYX_VERIFY_RETURN_INT(long, long, -(long) (((((((unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
                        } else if (8 * sizeof(long) - 1 > 3 * PyLong_SHIFT) {
                            return (long) (((long)-1)*(((((((long)digits[2]) << PyLong_SHIFT) | (long)digits[1]) << PyLong_SHIFT) | (long)digits[0])));
                        }
                    }
                    break;
                case 3:
                    if (8 * sizeof(long) > 2 * PyLong_SHIFT) {
                        if (8 * sizeof(unsigned long) > 3 * PyLong_SHIFT) {
                            __PYX_VERIFY_RETURN_INT(long, unsigned long, (((((((unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
                        } else if (8 * sizeof(long) - 1 > 3 * PyLong_SHIFT) {
                            return (long) ((((((((long)digits[2]) << PyLong_SHIFT) | (long)digits[1]) << PyLong_SHIFT) | (long)digits[0])));
                        }
                    }
                    break;
                case -4:
                    if (8 * sizeof(long) - 1 > 3 * PyLong_SHIFT) {
                        if (8 * sizeof(unsigned long) > 4 * PyLong_SHIFT) {
                            __PYX_VERIFY_RETURN_INT(long, long, -(long) (((((((((unsigned long)digits[3]) << PyLong_SHIFT) | (unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
                        } else if (8 * sizeof(long) - 1 > 4 * PyLong_SHIFT) {
                            return (long) (((long)-1)*(((((((((long)digits[3]) << PyLong_SHIFT) | (long)digits[2]) << PyLong_SHIFT) | (long)digits[1]) << PyLong_SHIFT) | (long)digits[0])));
                        }
                    }
                    break;
                case 4:
                    if (8 * sizeof(long) > 3 * PyLong_SHIFT) {
                        if (8 * sizeof(unsigned long) > 4 * PyLong_SHIFT) {
                            __PYX_VERIFY_RETURN_INT(long, unsigned long, (((((((((unsigned long)digits[3]) << PyLong_SHIFT) | (unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
                        } else if (8 * sizeof(long) - 1 > 4 * PyLong_SHIFT) {
                            return (long) ((((((((((long)digits[3]) << PyLong_SHIFT) | (long)digits[2]) << PyLong_SHIFT) | (long)digits[1]) << PyLong_SHIFT) | (long)digits[0])));
                        }
                    }
                    break;
            }
#endif
            if (sizeof(long) <= sizeof(long)) {
                __PYX_VERIFY_RETURN_INT_EXC(long, long, PyLong_AsLong(x))
            } else if (sizeof(long) <= sizeof(PY_LONG_LONG)) {
                __PYX_VERIFY_RETURN_INT_EXC(long, PY_LONG_LONG, PyLong_AsLongLong(x))
            }
        }
        {
#if CYTHON_COMPILING_IN_PYPY && !defined(_PyLong_AsByteArray)
            PyErr_SetString(PyExc_RuntimeError,
                            "_PyLong_AsByteArray() not available in PyPy, cannot convert large numbers");
#else
            long val;
            PyObject *v = __Pyx_PyNumber_IntOrLong(x);
 #if PY_MAJOR_VERSION < 3
            if (likely(v) && !PyLong_Check(v)) {
                PyObject *tmp = v;
                v = PyNumber_Long(tmp);
                Py_DECREF(tmp);
            }
 #endif
            if (likely(v)) {
                int one = 1; int is_little = (int)*(unsigned char *)&one;
                unsigned char *bytes = (unsigned char *)&val;
                int ret = _PyLong_AsByteArray((PyLongObject *)v,
                                              bytes, sizeof(val),
                                              is_little, !is_unsigned);
                Py_DECREF(v);
                if (likely(!ret))
                    return val;
            }
#endif
            return (long) -1;
        }
    } else {
        long val;
        PyObject *tmp = __Pyx_PyNumber_IntOrLong(x);
        if (!tmp) return (long) -1;
        val = __Pyx_PyInt_As_long(tmp);
        Py_DECREF(tmp);
        return val;
    }
raise_overflow:
    PyErr_SetString(PyExc_OverflowError,
        "value too large to convert to long");
    return (long) -1;
raise_neg_overflow:
    PyErr_SetString(PyExc_OverflowError,
        "can't convert negative value to long");
    return (long) -1;
}

/* CStringEquals */
            static CYTHON_INLINE int __Pyx_StrEq(const char *s1, const char *s2) {
    while (*s1 != '\0' && *s1 == *s2) { s1++; s2++; }
    return *s1 == *s2;
}

/* CheckBinaryVersion */
            static int __Pyx_check_binary_version(void) {
    char ctversion[4], rtversion[4];
    PyOS_snprintf(ctversion, 4, "%d.%d", PY_MAJOR_VERSION, PY_MINOR_VERSION);
    PyOS_snprintf(rtversion, 4, "%s", Py_GetVersion());
    if (ctversion[0] != rtversion[0] || ctversion[2] != rtversion[2]) {
        char message[200];
        PyOS_snprintf(message, sizeof(message),
                      "compiletime version %s of module '%.100s' "
                      "does not match runtime version %s",
                      ctversion, __Pyx_MODULE_NAME, rtversion);
        return PyErr_WarnEx(NULL, message, 1);
    }
    return 0;
}

/* ModuleImport */
            #ifndef __PYX_HAVE_RT_ImportModule
#define __PYX_HAVE_RT_ImportModule
static PyObject *__Pyx_ImportModule(const char *name) {
    PyObject *py_name = 0;
    PyObject *py_module = 0;
    py_name = __Pyx_PyIdentifier_FromString(name);
    if (!py_name)
        goto bad;
    py_module = PyImport_Import(py_name);
    Py_DECREF(py_name);
    return py_module;
bad:
    Py_XDECREF(py_name);
    return 0;
}
#endif

/* TypeImport */
            #ifndef __PYX_HAVE_RT_ImportType
#define __PYX_HAVE_RT_ImportType
static PyTypeObject *__Pyx_ImportType(const char *module_name, const char *class_name,
    size_t size, int strict)
{
    PyObject *py_module = 0;
    PyObject *result = 0;
    PyObject *py_name = 0;
    char warning[200];
    Py_ssize_t basicsize;
#ifdef Py_LIMITED_API
    PyObject *py_basicsize;
#endif
    py_module = __Pyx_ImportModule(module_name);
    if (!py_module)
        goto bad;
    py_name = __Pyx_PyIdentifier_FromString(class_name);
    if (!py_name)
        goto bad;
    result = PyObject_GetAttr(py_module, py_name);
    Py_DECREF(py_name);
    py_name = 0;
    Py_DECREF(py_module);
    py_module = 0;
    if (!result)
        goto bad;
    if (!PyType_Check(result)) {
        PyErr_Format(PyExc_TypeError,
            "%.200s.%.200s is not a type object",
            module_name, class_name);
        goto bad;
    }
#ifndef Py_LIMITED_API
    basicsize = ((PyTypeObject *)result)->tp_basicsize;
#else
    py_basicsize = PyObject_GetAttrString(result, "__basicsize__");
    if (!py_basicsize)
        goto bad;
    basicsize = PyLong_AsSsize_t(py_basicsize);
    Py_DECREF(py_basicsize);
    py_basicsize = 0;
    if (basicsize == (Py_ssize_t)-1 && PyErr_Occurred())
        goto bad;
#endif
    if (!strict && (size_t)basicsize > size) {
        PyOS_snprintf(warning, sizeof(warning),
            "%s.%s size changed, may indicate binary incompatibility. Expected %zd, got %zd",
            module_name, class_name, basicsize, size);
        if (PyErr_WarnEx(NULL, warning, 0) < 0) goto bad;
    }
    else if ((size_t)basicsize != size) {
        PyErr_Format(PyExc_ValueError,
            "%.200s.%.200s has the wrong size, try recompiling. Expected %zd, got %zd",
            module_name, class_name, basicsize, size);
        goto bad;
    }
    return (PyTypeObject *)result;
bad:
    Py_XDECREF(py_module);
    Py_XDECREF(result);
    return NULL;
}
#endif

/* InitStrings */
            static int __Pyx_InitStrings(__Pyx_StringTabEntry *t) {
    while (t->p) {
        #if PY_MAJOR_VERSION < 3
        if (t->is_unicode) {
            *t->p = PyUnicode_DecodeUTF8(t->s, t->n - 1, NULL);
        } else if (t->intern) {
            *t->p = PyString_InternFromString(t->s);
        } else {
            *t->p = PyString_FromStringAndSize(t->s, t->n - 1);
        }
        #else
        if (t->is_unicode | t->is_str) {
            if (t->intern) {
                *t->p = PyUnicode_InternFromString(t->s);
            } else if (t->encoding) {
                *t->p = PyUnicode_Decode(t->s, t->n - 1, t->encoding, NULL);
            } else {
                *t->p = PyUnicode_FromStringAndSize(t->s, t->n - 1);
            }
        } else {
            *t->p = PyBytes_FromStringAndSize(t->s, t->n - 1);
        }
        #endif
        if (!*t->p)
            return -1;
        ++t;
    }
    return 0;
}

static CYTHON_INLINE PyObject* __Pyx_PyUnicode_FromString(const char* c_str) {
    return __Pyx_PyUnicode_FromStringAndSize(c_str, (Py_ssize_t)strlen(c_str));
}
static CYTHON_INLINE char* __Pyx_PyObject_AsString(PyObject* o) {
    Py_ssize_t ignore;
    return __Pyx_PyObject_AsStringAndSize(o, &ignore);
}
static CYTHON_INLINE char* __Pyx_PyObject_AsStringAndSize(PyObject* o, Py_ssize_t *length) {
#if CYTHON_COMPILING_IN_CPYTHON && (__PYX_DEFAULT_STRING_ENCODING_IS_ASCII || __PYX_DEFAULT_STRING_ENCODING_IS_DEFAULT)
    if (
#if PY_MAJOR_VERSION < 3 && __PYX_DEFAULT_STRING_ENCODING_IS_ASCII
            __Pyx_sys_getdefaultencoding_not_ascii &&
#endif
            PyUnicode_Check(o)) {
#if PY_VERSION_HEX < 0x03030000
        char* defenc_c;
        PyObject* defenc = _PyUnicode_AsDefaultEncodedString(o, NULL);
        if (!defenc) return NULL;
        defenc_c = PyBytes_AS_STRING(defenc);
#if __PYX_DEFAULT_STRING_ENCODING_IS_ASCII
        {
            char* end = defenc_c + PyBytes_GET_SIZE(defenc);
            char* c;
            for (c = defenc_c; c < end; c++) {
                if ((unsigned char) (*c) >= 128) {
                    PyUnicode_AsASCIIString(o);
                    return NULL;
                }
            }
        }
#endif
        *length = PyBytes_GET_SIZE(defenc);
        return defenc_c;
#else
        if (__Pyx_PyUnicode_READY(o) == -1) return NULL;
#if __PYX_DEFAULT_STRING_ENCODING_IS_ASCII
        if (PyUnicode_IS_ASCII(o)) {
            *length = PyUnicode_GET_LENGTH(o);
            return PyUnicode_AsUTF8(o);
        } else {
            PyUnicode_AsASCIIString(o);
            return NULL;
        }
#else
        return PyUnicode_AsUTF8AndSize(o, length);
#endif
#endif
    } else
#endif
#if (!CYTHON_COMPILING_IN_PYPY) || (defined(PyByteArray_AS_STRING) && defined(PyByteArray_GET_SIZE))
    if (PyByteArray_Check(o)) {
        *length = PyByteArray_GET_SIZE(o);
        return PyByteArray_AS_STRING(o);
    } else
#endif
    {
        char* result;
        int r = PyBytes_AsStringAndSize(o, &result, length);
        if (unlikely(r < 0)) {
            return NULL;
        } else {
            return result;
        }
    }
}
static CYTHON_INLINE int __Pyx_PyObject_IsTrue(PyObject* x) {
   int is_true = x == Py_True;
   if (is_true | (x == Py_False) | (x == Py_None)) return is_true;
   else return PyObject_IsTrue(x);
}
static CYTHON_INLINE PyObject* __Pyx_PyNumber_IntOrLong(PyObject* x) {
  PyNumberMethods *m;
  const char *name = NULL;
  PyObject *res = NULL;
#if PY_MAJOR_VERSION < 3
  if (PyInt_Check(x) || PyLong_Check(x))
#else
  if (PyLong_Check(x))
#endif
    return __Pyx_NewRef(x);
  m = Py_TYPE(x)->tp_as_number;
#if PY_MAJOR_VERSION < 3
  if (m && m->nb_int) {
    name = "int";
    res = PyNumber_Int(x);
  }
  else if (m && m->nb_long) {
    name = "long";
    res = PyNumber_Long(x);
  }
#else
  if (m && m->nb_int) {
    name = "int";
    res = PyNumber_Long(x);
  }
#endif
  if (res) {
#if PY_MAJOR_VERSION < 3
    if (!PyInt_Check(res) && !PyLong_Check(res)) {
#else
    if (!PyLong_Check(res)) {
#endif
      PyErr_Format(PyExc_TypeError,
                   "__%.4s__ returned non-%.4s (type %.200s)",
                   name, name, Py_TYPE(res)->tp_name);
      Py_DECREF(res);
      return NULL;
    }
  }
  else if (!PyErr_Occurred()) {
    PyErr_SetString(PyExc_TypeError,
                    "an integer is required");
  }
  return res;
}
static CYTHON_INLINE Py_ssize_t __Pyx_PyIndex_AsSsize_t(PyObject* b) {
  Py_ssize_t ival;
  PyObject *x;
#if PY_MAJOR_VERSION < 3
  if (likely(PyInt_CheckExact(b))) {
    if (sizeof(Py_ssize_t) >= sizeof(long))
        return PyInt_AS_LONG(b);
    else
        return PyInt_AsSsize_t(x);
  }
#endif
  if (likely(PyLong_CheckExact(b))) {
    #if CYTHON_USE_PYLONG_INTERNALS
    const digit* digits = ((PyLongObject*)b)->ob_digit;
    const Py_ssize_t size = Py_SIZE(b);
    if (likely(__Pyx_sst_abs(size) <= 1)) {
        ival = likely(size) ? digits[0] : 0;
        if (size == -1) ival = -ival;
        return ival;
    } else {
      switch (size) {
         case 2:
           if (8 * sizeof(Py_ssize_t) > 2 * PyLong_SHIFT) {
             return (Py_ssize_t) (((((size_t)digits[1]) << PyLong_SHIFT) | (size_t)digits[0]));
           }
           break;
         case -2:
           if (8 * sizeof(Py_ssize_t) > 2 * PyLong_SHIFT) {
             return -(Py_ssize_t) (((((size_t)digits[1]) << PyLong_SHIFT) | (size_t)digits[0]));
           }
           break;
         case 3:
           if (8 * sizeof(Py_ssize_t) > 3 * PyLong_SHIFT) {
             return (Py_ssize_t) (((((((size_t)digits[2]) << PyLong_SHIFT) | (size_t)digits[1]) << PyLong_SHIFT) | (size_t)digits[0]));
           }
           break;
         case -3:
           if (8 * sizeof(Py_ssize_t) > 3 * PyLong_SHIFT) {
             return -(Py_ssize_t) (((((((size_t)digits[2]) << PyLong_SHIFT) | (size_t)digits[1]) << PyLong_SHIFT) | (size_t)digits[0]));
           }
           break;
         case 4:
           if (8 * sizeof(Py_ssize_t) > 4 * PyLong_SHIFT) {
             return (Py_ssize_t) (((((((((size_t)digits[3]) << PyLong_SHIFT) | (size_t)digits[2]) << PyLong_SHIFT) | (size_t)digits[1]) << PyLong_SHIFT) | (size_t)digits[0]));
           }
           break;
         case -4:
           if (8 * sizeof(Py_ssize_t) > 4 * PyLong_SHIFT) {
             return -(Py_ssize_t) (((((((((size_t)digits[3]) << PyLong_SHIFT) | (size_t)digits[2]) << PyLong_SHIFT) | (size_t)digits[1]) << PyLong_SHIFT) | (size_t)digits[0]));
           }
           break;
      }
    }
    #endif
    return PyLong_AsSsize_t(b);
  }
  x = PyNumber_Index(b);
  if (!x) return -1;
  ival = PyInt_AsSsize_t(x);
  Py_DECREF(x);
  return ival;
}
static CYTHON_INLINE PyObject * __Pyx_PyInt_FromSize_t(size_t ival) {
    return PyInt_FromSize_t(ival);
}


#endif /* Py_PYTHON_H */
